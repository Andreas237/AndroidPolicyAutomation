var Panama=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=281)}([function(e,t,n){var r=n(5),a=n(32),i=n(25),o=n(26),u=n(33),s=function(e,t,n){var l,c,f,d,h=e&s.F,_=e&s.G,p=e&s.S,v=e&s.P,E=e&s.B,g=_?r:p?r[t]||(r[t]={}):(r[t]||{}).prototype,m=_?a:a[t]||(a[t]={}),S=m.prototype||(m.prototype={});for(l in _&&(n=t),n)f=((c=!h&&g&&void 0!==g[l])?g:n)[l],d=E&&c?u(f,r):v&&"function"==typeof f?u(Function.call,f):f,g&&o(g,l,f,e&s.U),m[l]!=f&&i(m,l,d),v&&S[l]!=f&&(S[l]=f)};r.core=a,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(125),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i.default)(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={ChunkManager:{CHUNK_DOWNLOADED:"chunkDownloaded"},Config:{CONFIG_UPDATED:"configUpdated",BACKEND_URLS_UPDATED:"backendUrlsUpdated"},Metrics:{TRACK_SWITCH:"metricsTrackSwitch"},Media:{ENDED:"mediaEnded",TRACK_EDGE_CHANGED:"trackEdgeChanged"},Scheduler:{REACHED_LIVE_EDGE_STATE_CHANGED:"schedulerReachedLiveEdgeStateChanged",UPDATE_VIDEO_SEGMENT_LIST_MISSING_FROM_ME:"schedulerUpdateVideoSegmentListMissingFromME"},SRModule:{MEDIA_ELEMENT_ATTACHED:"mediaElementAttached",MEDIA_ELEMENT_DETACHED:"mediaElementDetached"},SRModuleInterface:{ABR_FEEDBACK:"srModuleInterfaceAbrFeedback",UNCOMPLETE_SEGMENT_REQUESTED:"srmoduleinterfaceUncompleteSegmentRequested",SEGMENT_TRANSFERED_TO_MEDIA_ENGINE:"segmentTransferedToMediaEngine"},PeerPool:{PEER_OPEN:"peerpoolPeerOpen",PEER_DESTROYED:"peerpoolPeerDestroyed",PEER_STATS_UPDATE:"peerPoolStat",PEER_LIMIT_UPDATE:"peerPoolLimit",START_ASKING_PEERS:"startAskingPeers",STOP_ASKING_PEERS:"stopAskingPeers"},BufferManager:{LOW_BUFFER:"buffermanagerLowBuffer",HIGH_BUFFER:"buffermanagerHighBuffer",STATE_CHANGED:"buffermanagerStateChanged"},PeerConnection:{DISCONNECTED:"peerConnectionDisconnected",MESSAGE_RECEIVED:"peerConnectionMessageReceived",BINARY_DATA_RECEIVED:"peerConnectionBinaryDataReceived"},Peer:{PEER_DISCONNECTED:"PeerDisconnected",HAS_SEGMENT:"hasSegment"},UploadQueue:{CHUNK_REQUESTED:"chunkRequested"},P2PCache:{CACHE_GC_NEEDED:"cacheGcNeeded"},GarbageCollector:{CACHE_FULL:"cacheFull",CACHE_FREE:"cacheFree"},BufferedAmountObserver:{BUFFER_CHECK:"bufferCheck"},Tracker:{TRACKER_CONNECTION_REQUEST:"trackerConnectionRequest",TRACKER_DISCONNECTION_REQUEST:"trackerDisconnectionRequest",READY:"trackerReady",DISCONNECTED:"trackerDisconnected",FAILED:"trackerFailed",BLOCKED:"trackerBlocked"},Signaling:{SIGNALING_DISCONNECTION_REQUEST:"signalingDisconnectionRequest",READY:"signalingReady",DISCONNECTED:"signalingDisconnected"},SegmentFiller:{SUCCESS:"segmentFillerSuccess",FALLBACK:"segmentFillerFallback"},DnaTransferStatus:{P2P_DOWNLOAD_TOGGLED:"p2pDownloadToggled",P2P_UPLOAD_TOGGLED:"p2pUploadToggled"}}},function(e,t,n){var r=n(7);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(105)("wks"),a=n(58),i=n(5).Symbol,o="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=o&&i[e]||(o?i:a)("Symbol."+e))}).store=r},function(e,t,n){var r=n(21),a=n(8),i=n(47),o=n(53),u=n(67),s=function(e,t,n){var l,c,f,d=e&s.F,h=e&s.G,_=e&s.S,p=e&s.P,v=e&s.B,E=e&s.W,g=h?a:a[t]||(a[t]={}),m=g.prototype,S=h?r:_?r[t]:(r[t]||{}).prototype;for(l in h&&(n=t),n)(c=!d&&S&&void 0!==S[l])&&u(g,l)||(f=c?S[l]:n[l],g[l]=h&&"function"!=typeof S[l]?n[l]:v&&c?i(f,r):E&&S[l]==f?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(f):p&&"function"==typeof f?i(Function.call,f):f,p&&((g.virtual||(g.virtual={}))[l]=f,e&s.R&&m&&!m[l]&&o(m,l,f)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,e.exports=s},function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(54),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,i.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){"use strict";t.__esModule=!0;var r=o(n(508)),a=o(n(512)),i=o(n(54));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,i.default)(t)));e.prototype=(0,a.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}},function(e,t,n){e.exports={default:n(554),__esModule:!0}},function(e,t,n){e.exports=!n(6)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(4),a=n(197),i=n(39),o=Object.defineProperty;t.f=n(14)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),a)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(41),a=Math.min;e.exports=function(e){return e>0?a(r(e),9007199254740991):0}},function(e,t,n){e.exports={default:n(532),__esModule:!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createInterval=function(e,t){return new a(e,t,r.TIMER_TYPE.INTERVAL)},t.createTimeout=function(e,t){return new a(e,t,r.TIMER_TYPE.TIMEOUT)};var r=n(253),a=void 0;a=n(553).default},function(e,t,n){var r=n(40);e.exports=function(e){return Object(r(e))}},function(e,t,n){e.exports={default:n(515),__esModule:!0}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(168)("wks"),a=n(122),i=n(21).Symbol,o="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=o&&i[e]||(o?i:a)("Symbol."+e))}).store=r},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(15),a=n(57);e.exports=n(14)?function(e,t,n){return r.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(5),a=n(25),i=n(28),o=n(58)("src"),u=Function.toString,s=(""+u).split("toString");n(32).inspectSource=function(e){return u.call(e)},(e.exports=function(e,t,n,u){var l="function"==typeof n;l&&(i(n,"name")||a(n,"name",t)),e[t]!==n&&(l&&(i(n,o)||a(n,o,e[t]?""+e[t]:s.join(String(t)))),e===r?e[t]=n:u?e[t]?e[t]=n:a(e,t,n):(delete e[t],a(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[o]||u.call(this)})},function(e,t,n){var r=n(0),a=n(6),i=n(40),o=/"/g,u=function(e,t,n,r){var a=String(i(e)),u="<"+t;return""!==n&&(u+=" "+n+'="'+String(r).replace(o,"&quot;")+'"'),u+">"+a+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(u),r(r.P+r.F*a(function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}),"String",n)}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(87),a=n(40);e.exports=function(e){return r(a(e))}},function(e,t,n){var r=n(88),a=n(57),i=n(29),o=n(39),u=n(28),s=n(197),l=Object.getOwnPropertyDescriptor;t.f=n(14)?l:function(e,t){if(e=i(e),t=o(t,!0),s)try{return l(e,t)}catch(e){}if(u(e,t))return a(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(28),a=n(19),i=n(137)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=a(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)},function(e,t,n){var r=n(22);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)}}return function(){return e.apply(t,arguments)}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){"use strict";var r=n(6);e.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},function(e,t,n){var r=n(44),a=n(231),i=n(163),o=Object.defineProperty;t.f=n(37)?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),a)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){e.exports=!n(52)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNumeric=t.Delta=void 0;var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;(0,r.default)(this,e),this._lastValue=t}return(0,a.default)(e,[{key:"calcDelta",value:function(e){var t=e-this._lastValue;return this._lastValue=e,t}},{key:"override",value:function(e){this._lastValue=e}},{key:"lastValue",get:function(){return this._lastValue}}]),e}();t.Delta=o,t.isNumeric=function(e){return"number"==typeof e&&!isNaN(e)}},function(e,t,n){var r=n(7);e.exports=function(e,t){if(!r(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!r(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(0),a=n(32),i=n(6);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*i(function(){n(1)}),"Object",o)}},function(e,t,n){var r=n(33),a=n(87),i=n(19),o=n(16),u=n(154);e.exports=function(e,t){var n=1==e,s=2==e,l=3==e,c=4==e,f=6==e,d=5==e||f,h=t||u;return function(t,u,_){for(var p,v,E=i(t),g=a(E),m=r(u,_,3),S=o(g.length),y=0,T=n?h(t,S):s?h(t,0):void 0;S>y;y++)if((d||y in g)&&(v=m(p=g[y],y,E),e))if(n)T[y]=v;else if(v)switch(e){case 3:return!0;case 5:return p;case 6:return y;case 2:T.push(p)}else if(c)return!1;return f?-1:l||c?c:T}}},function(e,t,n){var r=n(24);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";if(n(14)){var r=n(50),a=n(5),i=n(6),o=n(0),u=n(116),s=n(160),l=n(33),c=n(64),f=n(57),d=n(25),h=n(66),_=n(41),p=n(16),v=n(223),E=n(60),g=n(39),m=n(28),S=n(89),y=n(7),T=n(19),A=n(151),C=n(61),D=n(31),P=n(62).f,R=n(153),w=n(58),O=n(9),I=n(43),k=n(106),N=n(113),M=n(156),b=n(75),L=n(110),U=n(63),x=n(155),F=n(213),B=n(15),H=n(30),G=B.f,j=H.f,V=a.RangeError,q=a.TypeError,W=a.Uint8Array,K=Array.prototype,Y=s.ArrayBuffer,X=s.DataView,z=I(0),Q=I(2),Z=I(3),$=I(4),J=I(5),ee=I(6),te=k(!0),ne=k(!1),re=M.values,ae=M.keys,ie=M.entries,oe=K.lastIndexOf,ue=K.reduce,se=K.reduceRight,le=K.join,ce=K.sort,fe=K.slice,de=K.toString,he=K.toLocaleString,_e=O("iterator"),pe=O("toStringTag"),ve=w("typed_constructor"),Ee=w("def_constructor"),ge=u.CONSTR,me=u.TYPED,Se=u.VIEW,ye=I(1,function(e,t){return Pe(N(e,e[Ee]),t)}),Te=i(function(){return 1===new W(new Uint16Array([1]).buffer)[0]}),Ae=!!W&&!!W.prototype.set&&i(function(){new W(1).set({})}),Ce=function(e,t){var n=_(e);if(n<0||n%t)throw V("Wrong offset!");return n},De=function(e){if(y(e)&&me in e)return e;throw q(e+" is not a typed array!")},Pe=function(e,t){if(!(y(e)&&ve in e))throw q("It is not a typed array constructor!");return new e(t)},Re=function(e,t){return we(N(e,e[Ee]),t)},we=function(e,t){for(var n=0,r=t.length,a=Pe(e,r);r>n;)a[n]=t[n++];return a},Oe=function(e,t,n){G(e,t,{get:function(){return this._d[n]}})},Ie=function(e){var t,n,r,a,i,o,u=T(e),s=arguments.length,c=s>1?arguments[1]:void 0,f=void 0!==c,d=R(u);if(void 0!=d&&!A(d)){for(o=d.call(u),r=[],t=0;!(i=o.next()).done;t++)r.push(i.value);u=r}for(f&&s>2&&(c=l(c,arguments[2],2)),t=0,n=p(u.length),a=Pe(this,n);n>t;t++)a[t]=f?c(u[t],t):u[t];return a},ke=function(){for(var e=0,t=arguments.length,n=Pe(this,t);t>e;)n[e]=arguments[e++];return n},Ne=!!W&&i(function(){he.call(new W(1))}),Me=function(){return he.apply(Ne?fe.call(De(this)):De(this),arguments)},be={copyWithin:function(e,t){return F.call(De(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return $(De(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return x.apply(De(this),arguments)},filter:function(e){return Re(this,Q(De(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return J(De(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(De(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){z(De(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(De(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(De(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return le.apply(De(this),arguments)},lastIndexOf:function(e){return oe.apply(De(this),arguments)},map:function(e){return ye(De(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return ue.apply(De(this),arguments)},reduceRight:function(e){return se.apply(De(this),arguments)},reverse:function(){for(var e,t=De(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return Z(De(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ce.call(De(this),e)},subarray:function(e,t){var n=De(this),r=n.length,a=E(e,r);return new(N(n,n[Ee]))(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,p((void 0===t?r:E(t,r))-a))}},Le=function(e,t){return Re(this,fe.call(De(this),e,t))},Ue=function(e){De(this);var t=Ce(arguments[1],1),n=this.length,r=T(e),a=p(r.length),i=0;if(a+t>n)throw V("Wrong length!");for(;i<a;)this[t+i]=r[i++]},xe={entries:function(){return ie.call(De(this))},keys:function(){return ae.call(De(this))},values:function(){return re.call(De(this))}},Fe=function(e,t){return y(e)&&e[me]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Be=function(e,t){return Fe(e,t=g(t,!0))?f(2,e[t]):j(e,t)},He=function(e,t,n){return!(Fe(e,t=g(t,!0))&&y(n)&&m(n,"value"))||m(n,"get")||m(n,"set")||n.configurable||m(n,"writable")&&!n.writable||m(n,"enumerable")&&!n.enumerable?G(e,t,n):(e[t]=n.value,e)};ge||(H.f=Be,B.f=He),o(o.S+o.F*!ge,"Object",{getOwnPropertyDescriptor:Be,defineProperty:He}),i(function(){de.call({})})&&(de=he=function(){return le.call(this)});var Ge=h({},be);h(Ge,xe),d(Ge,_e,xe.values),h(Ge,{slice:Le,set:Ue,constructor:function(){},toString:de,toLocaleString:Me}),Oe(Ge,"buffer","b"),Oe(Ge,"byteOffset","o"),Oe(Ge,"byteLength","l"),Oe(Ge,"length","e"),G(Ge,pe,{get:function(){return this[me]}}),e.exports=function(e,t,n,s){var l=e+((s=!!s)?"Clamped":"")+"Array",f="get"+e,h="set"+e,_=a[l],E=_||{},g=_&&D(_),m=!_||!u.ABV,T={},A=_&&_.prototype,R=function(e,n){G(e,n,{get:function(){return function(e,n){var r=e._d;return r.v[f](n*t+r.o,Te)}(this,n)},set:function(e){return function(e,n,r){var a=e._d;s&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),a.v[h](n*t+a.o,r,Te)}(this,n,e)},enumerable:!0})};m?(_=n(function(e,n,r,a){c(e,_,l,"_d");var i,o,u,s,f=0,h=0;if(y(n)){if(!(n instanceof Y||"ArrayBuffer"==(s=S(n))||"SharedArrayBuffer"==s))return me in n?we(_,n):Ie.call(_,n);i=n,h=Ce(r,t);var E=n.byteLength;if(void 0===a){if(E%t)throw V("Wrong length!");if((o=E-h)<0)throw V("Wrong length!")}else if((o=p(a)*t)+h>E)throw V("Wrong length!");u=o/t}else u=v(n),i=new Y(o=u*t);for(d(e,"_d",{b:i,o:h,l:o,e:u,v:new X(i)});f<u;)R(e,f++)}),A=_.prototype=C(Ge),d(A,"constructor",_)):i(function(){_(1)})&&i(function(){new _(-1)})&&L(function(e){new _,new _(null),new _(1.5),new _(e)},!0)||(_=n(function(e,n,r,a){var i;return c(e,_,l),y(n)?n instanceof Y||"ArrayBuffer"==(i=S(n))||"SharedArrayBuffer"==i?void 0!==a?new E(n,Ce(r,t),a):void 0!==r?new E(n,Ce(r,t)):new E(n):me in n?we(_,n):Ie.call(_,n):new E(v(n))}),z(g!==Function.prototype?P(E).concat(P(g)):P(E),function(e){e in _||d(_,e,E[e])}),_.prototype=A,r||(A.constructor=_));var w=A[_e],O=!!w&&("values"==w.name||void 0==w.name),I=xe.values;d(_,ve,!0),d(A,me,l),d(A,Se,!0),d(A,Ee,_),(s?new _(1)[pe]==l:pe in A)||G(A,pe,{get:function(){return l}}),T[l]=_,o(o.G+o.W+o.F*(_!=E),T),o(o.S,l,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*i(function(){E.of.call(_,1)}),l,{from:Ie,of:ke}),"BYTES_PER_ELEMENT"in A||d(A,"BYTES_PER_ELEMENT",t),o(o.P,l,be),U(l),o(o.P+o.F*Ae,l,{set:Ue}),o(o.P+o.F*!O,l,xe),r||A.toString==de||(A.toString=de),o(o.P+o.F*i(function(){new _(1).slice()}),l,{slice:Le}),o(o.P+o.F*(i(function(){return[1,2].toLocaleString()!=new _([1,2]).toLocaleString()})||!i(function(){A.toLocaleString.call([1,2])})),l,{toLocaleString:Me}),b[l]=O?w:I,r||O||d(A,_e,I)}}else e.exports=function(){}},function(e,t,n){var r=n(218),a=n(0),i=n(105)("metadata"),o=i.store||(i.store=new(n(221))),u=function(e,t,n){var a=o.get(e);if(!a){if(!n)return;o.set(e,a=new r)}var i=a.get(t);if(!i){if(!n)return;a.set(t,i=new r)}return i};e.exports={store:o,map:u,has:function(e,t,n){var r=u(t,n,!1);return void 0!==r&&r.has(e)},get:function(e,t,n){var r=u(t,n,!1);return void 0===r?void 0:r.get(e)},set:function(e,t,n,r){u(n,r,!0).set(e,t)},keys:function(e,t){var n=u(e,t,!1),r=[];return n&&n.forEach(function(e,t){r.push(t)}),r},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){a(a.S,"Reflect",e)}}},function(e,t,n){var r=n(90);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){e.exports={default:n(569),__esModule:!0}},function(e,t,n){var r=n(58)("meta"),a=n(7),i=n(28),o=n(15).f,u=0,s=Object.isExtensible||function(){return!0},l=!n(6)(function(){return s(Object.preventExtensions({}))}),c=function(e){o(e,r,{value:{i:"O"+ ++u,w:{}}})},f=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,r)){if(!s(e))return"F";if(!t)return"E";c(e)}return e[r].i},getWeak:function(e,t){if(!i(e,r)){if(!s(e))return!0;if(!t)return!1;c(e)}return e[r].w},onFreeze:function(e){return l&&f.NEED&&s(e)&&!i(e,r)&&c(e),e}}},function(e,t){e.exports=!1},function(e,t,n){var r=n(9)("unscopables"),a=Array.prototype;void 0==a[r]&&n(25)(a,r,{}),e.exports=function(e){a[r][e]=!0}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(36),a=n(91);e.exports=n(37)?function(e,t,n){return r.f(e,t,a(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";t.__esModule=!0;var r=o(n(496)),a=o(n(502)),i="function"==typeof a.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":typeof e};function o(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof a.default&&"symbol"===i(r.default)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof a.default&&e.constructor===a.default&&e!==a.default.prototype?"symbol":void 0===e?"undefined":i(e)}},function(e,t,n){e.exports={default:n(546),__esModule:!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toDecimal=function(e,t){return parseFloat(e.toFixed(t))},t.range=function(e,t){for(var n=[],r=t>=e?1:-1,a=Math.min(e*r,t*r),i=Math.max(e*r,t*r),o=a;o<=i;o++)n.push(o*r);return n},t.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},t.randomInRange=function(e,t){return Math.random()*(t-e)+e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(199),a=n(138);e.exports=Object.keys||function(e){return r(e,a)}},function(e,t,n){var r=n(41),a=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?a(e+t,0):i(e,t)}},function(e,t,n){var r=n(4),a=n(200),i=n(138),o=n(137)("IE_PROTO"),u=function(){},s=function(){var e,t=n(135)("iframe"),r=i.length;for(t.style.display="none",n(139).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),s=e.F;r--;)delete s.prototype[i[r]];return s()};e.exports=Object.create||function(e,t){var n;return null!==e?(u.prototype=r(e),n=new u,u.prototype=null,n[o]=e):n=s(),void 0===t?n:a(n,t)}},function(e,t,n){var r=n(199),a=n(138).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,a)}},function(e,t,n){"use strict";var r=n(5),a=n(15),i=n(14),o=n(9)("species");e.exports=function(e){var t=r[e];i&&t&&!t[o]&&a.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(33),a=n(211),i=n(151),o=n(4),u=n(16),s=n(153),l={},c={};(t=e.exports=function(e,t,n,f,d){var h,_,p,v,E=d?function(){return e}:s(e),g=r(n,f,t?2:1),m=0;if("function"!=typeof E)throw TypeError(e+" is not iterable!");if(i(E)){for(h=u(e.length);h>m;m++)if((v=t?g(o(_=e[m])[0],_[1]):g(e[m]))===l||v===c)return v}else for(p=E.call(e);!(_=p.next()).done;)if((v=a(p,g,_.value,t))===l||v===c)return v}).BREAK=l,t.RETURN=c},function(e,t,n){var r=n(26);e.exports=function(e,t,n){for(var a in t)r(e,a,t[a],n);return e}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TRACKER:{READY:"trackerReady",FAILED:"trackerFailed"},ANALYTICS:{STOP_REPORTING_TRAFFIC:"stopReportingTraffic",RESTART_REPORTING_TRAFFIC:"restartReportingTraffic"},RESOURCE_USAGE:{PEER_POOL_HIGH:"peerPoolHigh"}}},function(e,t,n){var r=n(165),a=n(123);e.exports=function(e){return r(a(e))}},function(e,t,n){"use strict";var r=n(498)(!0);n(170)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StreamTypes={HLS:"hls",DASH:"dash",SMOOTH:"smooth"}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,a="~";function i(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(a=!1)),u.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},u.prototype.listeners=function(e,t){var n=a?a+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,u=new Array(o);i<o;i++)u[i]=r[i].fn;return u},u.prototype.emit=function(e,t,n,r,i,o){var u=a?a+e:e;if(!this._events[u])return!1;var s,l,c=this._events[u],f=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,i),!0;case 6:return c.fn.call(c.context,t,n,r,i,o),!0}for(l=1,s=new Array(f-1);l<f;l++)s[l-1]=arguments[l];c.fn.apply(c.context,s)}else{var d,h=c.length;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),f){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,r);break;default:if(!s)for(d=1,s=new Array(f-1);d<f;d++)s[d-1]=arguments[d];c[l].fn.apply(c[l].context,s)}}return!0},u.prototype.on=function(e,t,n){var r=new o(t,n||this),i=a?a+e:e;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):(this._events[i]=r,this._eventsCount++),this},u.prototype.once=function(e,t,n){var r=new o(t,n||this,!0),i=a?a+e:e;return this._events[i]?this._events[i].fn?this._events[i]=[this._events[i],r]:this._events[i].push(r):(this._events[i]=r,this._eventsCount++),this},u.prototype.removeListener=function(e,t,n,r){var o=a?a+e:e;if(!this._events[o])return this;if(!t)return 0==--this._eventsCount?this._events=new i:delete this._events[o],this;var u=this._events[o];if(u.fn)u.fn!==t||r&&!u.once||n&&u.context!==n||(0==--this._eventsCount?this._events=new i:delete this._events[o]);else{for(var s=0,l=[],c=u.length;s<c;s++)(u[s].fn!==t||r&&!u[s].once||n&&u[s].context!==n)&&l.push(u[s]);l.length?this._events[o]=1===l.length?l[0]:l:0==--this._eventsCount?this._events=new i:delete this._events[o]}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new i:delete this._events[t])):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prototype.setMaxListeners=function(){return this},u.prefixed=a,u.EventEmitter=u,e.exports=u},function(e,t,n){var r=n(15).f,a=n(28),i=n(9)("toStringTag");e.exports=function(e,t,n){e&&!a(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(0),a=n(40),i=n(6),o=n(141),u="["+o+"]",s=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),c=function(e,t,n){var a={},u=i(function(){return!!o[e]()||"​"!="​"[e]()}),s=a[e]=u?t(f):o[e];n&&(a[n]=s),r(r.P+r.F*u,"String",a)},f=c.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(l,"")),e};e.exports=c},function(e,t){e.exports={}},function(e,t,n){var r=n(7);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(161),a=n(68),i=n(232),o=n(488),u=n(542),s=n(252),l=n(544),c=n(715),f=n(716),d=function(){function e(t){var n=this;this.peerAgent=null,this.mDnaDownloadAllowed=!0,this.mDnaUploadAllow=!0,e.instance=this,this.mediaElement=new u.default,this.eventEmitter=new i,this.playerInterface=new c.default,this.adapter=o.create(t.getStreamType(),t.getPropertyParameters().ssaiEnabled),this.mNetworkType=this.convertNetworkType(t.getNetworkType()),this.adapter.onMediaMapCreated=function(e){n.trackerFactory=new f.default,n.peerAgent=l.default.newBuilder(t.getPlatform(),t.getPlatformVersion()).setAdapter(n.adapter).setTrackerFactory(n.trackerFactory).setMediaMap(e).setEventEmitter(n.eventEmitter).setPlayerInterface(n.playerInterface).build({backendUrls:t.getBackendUrls(),contentId:t.getContentId(),manifestUrl:t.getManifestUrl(),paConfig:t.getPaConfig(),peerAgentCounter:t.getPeerAgentCounter(),propertyParameters:t.getPropertyParameters(),siteId:t.getSiteId(),streamrootKey:t.getStreamrootKey(),streamType:t.getStreamType(),networkType:n.mNetworkType}),n.peerAgent.dnaDownloadAllowed=n.mDnaDownloadAllowed,n.peerAgent.dnaUploadAllowed=n.mDnaUploadAllow,n.peerAgent.dnaDownloadOnWifiEthernetAllowed=n.mDnaDownloadOnWifiEthernetAllowed,n.peerAgent.dnaUploadOnWifiEthernetAllowed=n.mDnaUploadOnWifiEthernetAllowed,n.peerAgent.dnaDownloadOnCellularAllowed=n.mDnaDownloadOnCellularAllowed,n.peerAgent.dnaUploadOnCellularAllowed=n.mDnaUploadOnCellularAllowed,n.peerAgent.setMediaElement(n.mediaElement),n.mediaMap=e,StateInteractor.onReady()}}return e.getInstance=function(){return this.instance},e.prototype.getSegment=function(e,t,n){var r={headers:""===n?{}:JSON.parse(n),url:t},a={onError:function(t){SegmentProxyRequestInteractor.onFailure(e,t.message)},onSuccess:function(t,n,r){var a=n.cdnDownloaded+n.p2pDownloaded,i=n.cdnDuration+n.p2pDuration;SegmentProxyRequestInteractor.onSucceed(e,t.id,t.recyclable,i,a)}},i=this.mediaMap.getSegmentViewByUrl(t);if(i){for(var o=0,u=this.mediaMap.getTrackList();o<u.length;o++){var s=u[o];!i.isInTrack(s)||void 0!==this.lastTrackView&&this.lastTrackView.viewToString()===s.viewToString()||(this.lastTrackView=s,this.playerInterface.emit("onTrackChange",{video:s}))}this.peerAgent.getSegment(r,a,i)}else SegmentProxyRequestInteractor.onFailure(e,'Segment view not found for url "'+t+'"')},e.prototype.updateMainManifest=function(e,t){this.adapter.updateManifest(t,e)},e.prototype.updatePlaylistManifest=function(e,t){this.adapter.updateManifest(t,e)},e.prototype.updateMediaElement=function(e,t){this.mediaElement.currentTime=e,this.mediaElement.updateBuffered(t)},e.prototype.sendAnalytics=function(e,t){this.peerAgent&&this.peerAgent.sendAnalytics(e,t)},e.prototype.getPublicAnalytics=function(){return this.peerAgent?{dnaUpload:this.peerAgent.p2pUploadOn,dnaDownload:this.peerAgent.p2pDownloadOn,cdn:this.peerAgent.stats.cdn,p2p:this.peerAgent.stats.p2p,peers:this.peerAgent.stats.peers,upload:this.peerAgent.stats.upload}:{dnaUpload:!1,dnaDownload:!1,cdn:0,p2p:0,peers:0,upload:0}},e.prototype.getStatsAnalytics=function(){return this.peerAgent?this.peerAgent.getAnalytics("stats"):{}},e.prototype.getTrafficAnalytics=function(){return this.peerAgent?this.peerAgent.getAnalytics("traffic"):{}},e.prototype.getControlAnalytics=function(){return this.peerAgent?this.peerAgent.getAnalytics("control"):{}},Object.defineProperty(e.prototype,"dnaDownloadAllowed",{set:function(e){this.peerAgent&&(this.peerAgent.dnaDownloadAllowed=e),this.mDnaDownloadAllowed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dnaUploadAllowed",{set:function(e){this.peerAgent&&(this.peerAgent.dnaUploadAllowed=e),this.mDnaUploadAllow=e},enumerable:!0,configurable:!0}),e.prototype.resetDnaDownloadOnWifiEthernetAllowed=function(){this.peerAgent&&(this.peerAgent.dnaDownloadOnWifiEthernetAllowed=null),this.mDnaDownloadOnWifiEthernetAllowed=null},Object.defineProperty(e.prototype,"dnaDownloadOnWifiEthernetAllowed",{set:function(e){this.peerAgent&&(this.peerAgent.dnaDownloadOnWifiEthernetAllowed=e),this.mDnaDownloadOnWifiEthernetAllowed=e},enumerable:!0,configurable:!0}),e.prototype.resetDnaUploadOnWifiEthernetAllowed=function(){this.peerAgent&&(this.peerAgent.dnaUploadOnWifiEthernetAllowed=null),this.mDnaUploadOnWifiEthernetAllowed=null},Object.defineProperty(e.prototype,"dnaUploadOnWifiEthernetAllowed",{set:function(e){this.peerAgent&&(this.peerAgent.dnaUploadOnWifiEthernetAllowed=e),this.mDnaUploadOnWifiEthernetAllowed=e},enumerable:!0,configurable:!0}),e.prototype.resetDnaDownloadOnCellularAllowed=function(){this.peerAgent&&(this.peerAgent.dnaDownloadOnCellularAllowed=null),this.mDnaDownloadOnCellularAllowed=null},Object.defineProperty(e.prototype,"dnaDownloadOnCellularAllowed",{set:function(e){this.peerAgent&&(this.peerAgent.dnaDownloadOnCellularAllowed=e),this.mDnaDownloadOnCellularAllowed=e},enumerable:!0,configurable:!0}),e.prototype.resetDnaUploadOnCellularAllowed=function(){this.peerAgent&&(this.peerAgent.dnaUploadOnCellularAllowed=null),this.mDnaUploadOnCellularAllowed=null},Object.defineProperty(e.prototype,"dnaUploadOnCellularAllowed",{set:function(e){this.peerAgent&&(this.peerAgent.dnaUploadOnCellularAllowed=e),this.mDnaUploadOnCellularAllowed=e},enumerable:!0,configurable:!0}),e.prototype.trackerAskPeersSuccess=function(e){this.trackerFactory.askPeersSuccess(e)},e.prototype.trackerAskPeerFailure=function(){this.trackerFactory.askPeerFailure()},e.prototype.trackerConnectionCreated=function(e,t){this.trackerFactory.connectionCreated(e,t)},Object.defineProperty(e.prototype,"networkType",{set:function(e){this.mNetworkType=this.convertNetworkType(e),this.peerAgent&&(this.peerAgent.networkType=this.mNetworkType)},enumerable:!0,configurable:!0}),e.prototype.peerPoolHigh=function(){this.eventEmitter.emit(a.default.RESOURCE_USAGE.PEER_POOL_HIGH)},e.prototype.convertNetworkType=function(e){switch(e){case 0:return r.default.NONE;case 1:return r.default.WIFI_AND_ETHERNET;case 2:return r.default.CELLULAR_AND_OTHERS;default:return r.default.NONE}},e.Builder=s.default,e.instance=null,e}();t.default=d},function(e,t,n){var r=n(10),a=n(8),i=n(52);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],o={};o[e]=t(n),r(r.S+r.F*i(function(){n(1)}),"Object",o)}},function(e,t,n){var r=n(123);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports={}},function(e,t,n){n(500);for(var r=n(21),a=n(53),i=n(80),o=n(23)("toStringTag"),u="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),s=0;s<u.length;s++){var l=u[s],c=r[l],f=c&&c.prototype;f&&!f[o]&&a(f,o,l),i[l]=i.Array}},function(e,t,n){e.exports={default:n(524),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var r=i(n(529)),a=i(n(17));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,r.default)(Object(e)))return function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var u,s=(0,a.default)(e);!(r=(u=s.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(e,t,n){e.exports={default:n(537),__esModule:!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={SAFE:"safe",UNSAFE:"unsafe"};t.default=r},function(e,t,n){e.exports={default:n(572),__esModule:!0}},function(e,t,n){var r=n(34);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(34),a=n(9)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?n:i?r(t):"Object"==(o=r(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){e.exports={default:n(490),__esModule:!0}},function(e,t,n){var r=n(233),a=n(169);e.exports=Object.keys||function(e){return r(e,a)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=!0},function(e,t,n){var r=n(36).f,a=n(67),i=n(23)("toStringTag");e.exports=function(e,t,n){e&&!a(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},function(e,t,n){var r=n(47),a=n(243),i=n(244),o=n(44),u=n(124),s=n(177),l={},c={};(t=e.exports=function(e,t,n,f,d){var h,_,p,v,E=d?function(){return e}:s(e),g=r(n,f,t?2:1),m=0;if("function"!=typeof E)throw TypeError(e+" is not iterable!");if(i(E)){for(h=u(e.length);h>m;m++)if((v=t?g(o(_=e[m])[0],_[1]):g(e[m]))===l||v===c)return v}else for(p=E.call(e);!(_=p.next()).done;)if((v=a(p,g,_.value,t))===l||v===c)return v}).BREAK=l,t.RETURN=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o="Unvalid weight parameter for EMWA: must be an number in ]0,1[",u=function(){function e(t,n){if((0,r.default)(this,e),n<=0||n>=1)throw new Error(o);this._emwaValue=t,this._weight=n}return(0,a.default)(e,[{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null!==t?t:this._weight;this._emwaValue=(1-n)*this._emwaValue+n*e}},{key:"value",get:function(){return this._emwaValue}}],[{key:"Errors",value:function(){return{UNVALID_WEIGHT:o}}},{key:"fromHalfLife",value:function(t,n,r){return new e(t,this.halfLifeToEMAWeight(n,r))}},{key:"halfLifeToEMAWeight",value:function(e,t){var n=e/t;return 1-1/Math.pow(2,1/n)}}]),e}();t.default=u},function(e,t,n){e.exports={default:n(573),__esModule:!0}},function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(48),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,i.default)(e)}},function(e,t,n){"use strict";t.__esModule=!0;var r=i(n(13)),a=i(n(629));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t,n,i){null===t&&(t=Function.prototype);var o=(0,a.default)(t,n);if(void 0===o){var u=(0,r.default)(t);return null===u?void 0:e(u,n,i)}if("value"in o)return o.value;var s=o.get;return void 0!==s?s.call(i):void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={Methods:{GET:"GET",POST:"POST"},ResponseTypes:{JSON:"json",ARRAY_BUFFER:"arraybuffer"},ReadyStates:{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},Errors:{INVALID_STATUS:"Response status is not part of valid status codes",REQUEST_ABORTED:"Request has been aborted",REQUEST_ERROR:"An error occured while sending the request",REQUEST_TIMEOUT:"Request timeout"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={TRACKER_ATTEMPT:"trackerAttempt",TRACKER_REQUEST:"trackerRequest",TRACKER_SUCCESS:"trackerSuccess",TRACKER_ERROR:"trackerError"}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(32),a=n(5),i=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(50)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(29),a=n(16),i=n(60);e.exports=function(e){return function(t,n,o){var u,s=r(t),l=a(s.length),c=i(o,l);if(e&&n!=n){for(;l>c;)if((u=s[c++])!=u)return!0}else for(;l>c;c++)if((e||c in s)&&s[c]===n)return e||c||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(34);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(7),a=n(34),i=n(9)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==a(e))}},function(e,t,n){var r=n(9)("iterator"),a=!1;try{var i=[7][r]();i.return=function(){a=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var i=[7],o=i[r]();o.next=function(){return{done:n=!0}},i[r]=function(){return o},e(i)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(4);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";var r=n(25),a=n(26),i=n(6),o=n(40),u=n(9);e.exports=function(e,t,n){var s=u(e),l=n(o,s,""[e]),c=l[0],f=l[1];i(function(){var t={};return t[s]=function(){return 7},7!=""[e](t)})&&(a(String.prototype,e,c),r(RegExp.prototype,s,2==t?function(e,t){return f.call(e,this,t)}:function(e){return f.call(e,this)}))}},function(e,t,n){var r=n(4),a=n(22),i=n(9)("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||void 0==(n=r(o)[i])?t:a(n)}},function(e,t,n){var r=n(5).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(5),a=n(0),i=n(26),o=n(66),u=n(49),s=n(65),l=n(64),c=n(7),f=n(6),d=n(110),h=n(73),_=n(142);e.exports=function(e,t,n,p,v,E){var g=r[e],m=g,S=v?"set":"add",y=m&&m.prototype,T={},A=function(e){var t=y[e];i(y,e,"delete"==e?function(e){return!(E&&!c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(E&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return E&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof m&&(E||y.forEach&&!f(function(){(new m).entries().next()}))){var C=new m,D=C[S](E?{}:-0,1)!=C,P=f(function(){C.has(1)}),R=d(function(e){new m(e)}),w=!E&&f(function(){for(var e=new m,t=5;t--;)e[S](t,t);return!e.has(-0)});R||((m=t(function(t,n){l(t,m,e);var r=_(new g,t,m);return void 0!=n&&s(n,v,r[S],r),r})).prototype=y,y.constructor=m),(P||w)&&(A("delete"),A("has"),v&&A("get")),(w||D)&&A(S),E&&y.clear&&delete y.clear}else m=p.getConstructor(t,e,v,S),o(m.prototype,n),u.NEED=!0;return h(m,e),T[e]=m,a(a.G+a.W+a.F*(m!=g),T),E||p.setStrong(m,e,v),m}},function(e,t,n){for(var r,a=n(5),i=n(25),o=n(58),u=o("typed_array"),s=o("view"),l=!(!a.ArrayBuffer||!a.DataView),c=l,f=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=a[d[f++]])?(i(r.prototype,u,!0),i(r.prototype,s,!0)):c=!1;e.exports={ABV:l,CONSTR:c,TYPED:u,VIEW:s}},function(e,t,n){"use strict";e.exports=n(50)||!n(6)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete n(5)[e]})},function(e,t,n){"use strict";var r=n(0);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";var r=n(0),a=n(22),i=n(33),o=n(65);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,u,s=arguments[1];return a(this),(t=void 0!==s)&&a(s),void 0==e?new this:(n=[],t?(r=0,u=i(s,arguments[2],2),o(e,!1,function(e){n.push(u(e,r++))})):o(e,!1,n.push,n),new this(n))}})}},function(e,t,n){e.exports={default:n(486),__esModule:!0}},function(e,t,n){var r=n(122)("meta"),a=n(24),i=n(67),o=n(36).f,u=0,s=Object.isExtensible||function(){return!0},l=!n(52)(function(){return s(Object.preventExtensions({}))}),c=function(e){o(e,r,{value:{i:"O"+ ++u,w:{}}})},f=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,r)){if(!s(e))return"F";if(!t)return"E";c(e)}return e[r].i},getWeak:function(e,t){if(!i(e,r)){if(!s(e))return!0;if(!t)return!1;c(e)}return e[r].w},onFreeze:function(e){return l&&f.NEED&&s(e)&&!i(e,r)&&c(e),e}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(166),a=Math.min;e.exports=function(e){return e>0?a(r(e),9007199254740991):0}},function(e,t,n){e.exports={default:n(494),__esModule:!0}},function(e,t,n){var r=n(44),a=n(235),i=n(169),o=n(167)("IE_PROTO"),u=function(){},s=function(){var e,t=n(162)("iframe"),r=i.length;for(t.style.display="none",n(236).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),s=e.F;r--;)delete s.prototype[i[r]];return s()};e.exports=Object.create||function(e,t){var n;return null!==e?(u.prototype=r(e),n=new u,u.prototype=null,n[o]=e):n=s(),void 0===t?n:a(n,t)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t){},function(e,t,n){var r=n(94),a=n(23)("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),a))?n:i?r(t):"Object"==(o=r(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t,n){var r=n(551),a=n(552),i=a;i.v1=r,i.v4=a,e.exports=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=n(38);function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,r.default)(this,e);var t=Date.now();this._metricSum=0,this._latestValue=0,this._integralTimestampDelta=new i.Delta(t),this._getterTimestampDelta=new i.Delta(t)}return(0,a.default)(e,[{key:"getAverage",value:function(){var e=this.getIntegral();return e.intervalLength?e.value/e.intervalLength:e.value}},{key:"getIntegral",value:function(){var e=Date.now(),t=this._integralTimestampDelta.calcDelta(e),n=this._getterTimestampDelta.calcDelta(e);this._metricSum+=this._latestValue*t;var r=this._metricSum;return this._metricSum=0,{value:r,intervalLength:n}}},{key:"updateMetric",value:function(e){var t=Date.now(),n=this._integralTimestampDelta.calcDelta(t);this._metricSum+=this._latestValue*n,this._latestValue=e}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(20)),a=o(n(1)),i=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,a.default)(this,e),this._scopes=new r.default}return(0,i.default)(e,[{key:"add",value:function(e,t,n){this._scopes.has(e)||this._scopes.set(e,new r.default);var a=this._scopes.get(e);a&&a.set(t,n)}},{key:"remove",value:function(e,t){var n=this._scopes.get(e);return!!n&&n.delete(t)}},{key:"removeAll",value:function(){this._scopes.clear()}},{key:"get",value:function(e,t){var n=this._scopes.get(e);return n&&n.has(t)?n.get(t):null}},{key:"count",value:function(e){var t=this._scopes.get(e);return t?t.size:0}}]),e}();t.default=new u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(13)),a=s(n(1)),i=s(n(2)),o=s(n(11)),u=s(n(12));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){(0,a.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this));return i.offset=0,i._byteLength=e,i.id=n||SegmentInteractor.allocate(e),i}return(0,u.default)(t,e),(0,i.default)(t,[{key:"getBinaryData",value:function(e,n){var r=new t(n,this.id);return r.offset=e,r}},{key:"setBinaryData",value:function(e,t){if(t+e.byteLength>this._byteLength)throw new RangeError("Trying to write past expected byteLength in setBinaryData");SegmentInteractor.mergeBinaryData(e.id,this.id,t)}},{key:"equals",value:function(e){return e.id===this.id}},{key:"destroy",value:function(){SegmentInteractor.clearBinaryData(this.id)}}]),t}(s(n(263)).default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e)}return(0,a.default)(e,[{key:"getSegmentList",value:function(e,t,n){return[]}},{key:"getTrackList",value:function(){return[]}},{key:"getSegmentTime",value:function(e){return 0}},{key:"getSegmentDuration",value:function(e){return 0}},{key:"getTrackBitrate",value:function(e){return 0}},{key:"isLive",value:function(){return!1}}]),e}();t.default=o},function(e,t,n){var r=n(7),a=n(5).document,i=r(a)&&r(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},function(e,t,n){var r=n(5),a=n(32),i=n(50),o=n(198),u=n(15).f;e.exports=function(e){var t=a.Symbol||(a.Symbol=i?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||u(t,e,{value:o.f(e)})}},function(e,t,n){var r=n(105)("keys"),a=n(58);e.exports=function(e){return r[e]||(r[e]=a(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(5).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(7),a=n(4),i=function(e,t){if(a(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(33)(Function.call,n(30).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:i}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(7),a=n(140).set;e.exports=function(e,t,n){var i,o=t.constructor;return o!==n&&"function"==typeof o&&(i=o.prototype)!==n.prototype&&r(i)&&a&&a(e,i),e}},function(e,t,n){"use strict";var r=n(41),a=n(40);e.exports=function(e){var t=String(a(this)),n="",i=r(e);if(i<0||i==1/0)throw RangeError("Count can't be negative");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){var r=n(41),a=n(40);e.exports=function(e){return function(t,n){var i,o,u=String(a(t)),s=r(n),l=u.length;return s<0||s>=l?e?"":void 0:(i=u.charCodeAt(s))<55296||i>56319||s+1===l||(o=u.charCodeAt(s+1))<56320||o>57343?e?u.charAt(s):i:e?u.slice(s,s+2):o-56320+(i-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(50),a=n(0),i=n(26),o=n(25),u=n(75),s=n(148),l=n(73),c=n(31),f=n(9)("iterator"),d=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,_,p,v,E){s(n,t,_);var g,m,S,y=function(e){if(!d&&e in D)return D[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",A="values"==p,C=!1,D=e.prototype,P=D[f]||D["@@iterator"]||p&&D[p],R=P||y(p),w=p?A?y("entries"):R:void 0,O="Array"==t&&D.entries||P;if(O&&(S=c(O.call(new e)))!==Object.prototype&&S.next&&(l(S,T,!0),r||"function"==typeof S[f]||o(S,f,h)),A&&P&&"values"!==P.name&&(C=!0,R=function(){return P.call(this)}),r&&!E||!d&&!C&&D[f]||o(D,f,R),u[t]=R,u[T]=h,p)if(g={values:A?R:y("values"),keys:v?R:y("keys"),entries:w},E)for(m in g)m in D||i(D,m,g[m]);else a(a.P+a.F*(d||C),t,g);return g}},function(e,t,n){"use strict";var r=n(61),a=n(57),i=n(73),o={};n(25)(o,n(9)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(o,{next:a(1,n)}),i(e,t+" Iterator")}},function(e,t,n){var r=n(109),a=n(40);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(a(e))}},function(e,t,n){var r=n(9)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var r=n(75),a=n(9)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[a]===e)}},function(e,t,n){"use strict";var r=n(15),a=n(57);e.exports=function(e,t,n){t in e?r.f(e,t,a(0,n)):e[t]=n}},function(e,t,n){var r=n(89),a=n(9)("iterator"),i=n(75);e.exports=n(32).getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(374);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){"use strict";var r=n(19),a=n(60),i=n(16);e.exports=function(e){for(var t=r(this),n=i(t.length),o=arguments.length,u=a(o>1?arguments[1]:void 0,n),s=o>2?arguments[2]:void 0,l=void 0===s?n:a(s,n);l>u;)t[u++]=e;return t}},function(e,t,n){"use strict";var r=n(51),a=n(214),i=n(75),o=n(29);e.exports=n(147)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,a(1)):a(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var r,a,i,o=n(33),u=n(204),s=n(139),l=n(135),c=n(5),f=c.process,d=c.setImmediate,h=c.clearImmediate,_=c.MessageChannel,p=c.Dispatch,v=0,E={},g=function(){var e=+this;if(E.hasOwnProperty(e)){var t=E[e];delete E[e],t()}},m=function(e){g.call(e.data)};d&&h||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return E[++v]=function(){u("function"==typeof e?e:Function(e),t)},r(v),v},h=function(e){delete E[e]},"process"==n(34)(f)?r=function(e){f.nextTick(o(g,e,1))}:p&&p.now?r=function(e){p.now(o(g,e,1))}:_?(i=(a=new _).port2,a.port1.onmessage=m,r=o(i.postMessage,i,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",m,!1)):r="onreadystatechange"in l("script")?function(e){s.appendChild(l("script")).onreadystatechange=function(){s.removeChild(this),g.call(e)}}:function(e){setTimeout(o(g,e,1),0)}),e.exports={set:d,clear:h}},function(e,t,n){var r=n(5),a=n(157).set,i=r.MutationObserver||r.WebKitMutationObserver,o=r.process,u=r.Promise,s="process"==n(34)(o);e.exports=function(){var e,t,n,l=function(){var r,a;for(s&&(r=o.domain)&&r.exit();e;){a=e.fn,e=e.next;try{a()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(s)n=function(){o.nextTick(l)};else if(!i||r.navigator&&r.navigator.standalone)if(u&&u.resolve){var c=u.resolve(void 0);n=function(){c.then(l)}}else n=function(){a.call(r,l)};else{var f=!0,d=document.createTextNode("");new i(l).observe(d,{characterData:!0}),n=function(){d.data=f=!f}}return function(r){var a={fn:r,next:void 0};t&&(t.next=a),e||(e=a,n()),t=a}}},function(e,t,n){"use strict";var r=n(22);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){"use strict";var r=n(5),a=n(14),i=n(50),o=n(116),u=n(25),s=n(66),l=n(6),c=n(64),f=n(41),d=n(16),h=n(223),_=n(62).f,p=n(15).f,v=n(155),E=n(73),g="prototype",m="Wrong index!",S=r.ArrayBuffer,y=r.DataView,T=r.Math,A=r.RangeError,C=r.Infinity,D=S,P=T.abs,R=T.pow,w=T.floor,O=T.log,I=T.LN2,k=a?"_b":"buffer",N=a?"_l":"byteLength",M=a?"_o":"byteOffset";function b(e,t,n){var r,a,i,o=new Array(n),u=8*n-t-1,s=(1<<u)-1,l=s>>1,c=23===t?R(2,-24)-R(2,-77):0,f=0,d=e<0||0===e&&1/e<0?1:0;for((e=P(e))!=e||e===C?(a=e!=e?1:0,r=s):(r=w(O(e)/I),e*(i=R(2,-r))<1&&(r--,i*=2),(e+=r+l>=1?c/i:c*R(2,1-l))*i>=2&&(r++,i/=2),r+l>=s?(a=0,r=s):r+l>=1?(a=(e*i-1)*R(2,t),r+=l):(a=e*R(2,l-1)*R(2,t),r=0));t>=8;o[f++]=255&a,a/=256,t-=8);for(r=r<<t|a,u+=t;u>0;o[f++]=255&r,r/=256,u-=8);return o[--f]|=128*d,o}function L(e,t,n){var r,a=8*n-t-1,i=(1<<a)-1,o=i>>1,u=a-7,s=n-1,l=e[s--],c=127&l;for(l>>=7;u>0;c=256*c+e[s],s--,u-=8);for(r=c&(1<<-u)-1,c>>=-u,u+=t;u>0;r=256*r+e[s],s--,u-=8);if(0===c)c=1-o;else{if(c===i)return r?NaN:l?-C:C;r+=R(2,t),c-=o}return(l?-1:1)*r*R(2,c-t)}function U(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function x(e){return[255&e]}function F(e){return[255&e,e>>8&255]}function B(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function H(e){return b(e,52,8)}function G(e){return b(e,23,4)}function j(e,t,n){p(e[g],t,{get:function(){return this[n]}})}function V(e,t,n,r){var a=h(+n);if(a+t>e[N])throw A(m);var i=e[k]._b,o=a+e[M],u=i.slice(o,o+t);return r?u:u.reverse()}function q(e,t,n,r,a,i){var o=h(+n);if(o+t>e[N])throw A(m);for(var u=e[k]._b,s=o+e[M],l=r(+a),c=0;c<t;c++)u[s+c]=l[i?c:t-c-1]}if(o.ABV){if(!l(function(){S(1)})||!l(function(){new S(-1)})||l(function(){return new S,new S(1.5),new S(NaN),"ArrayBuffer"!=S.name})){for(var W,K=(S=function(e){return c(this,S),new D(h(e))})[g]=D[g],Y=_(D),X=0;Y.length>X;)(W=Y[X++])in S||u(S,W,D[W]);i||(K.constructor=S)}var z=new y(new S(2)),Q=y[g].setInt8;z.setInt8(0,2147483648),z.setInt8(1,2147483649),!z.getInt8(0)&&z.getInt8(1)||s(y[g],{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},!0)}else S=function(e){c(this,S,"ArrayBuffer");var t=h(e);this._b=v.call(new Array(t),0),this[N]=t},y=function(e,t,n){c(this,y,"DataView"),c(e,S,"DataView");var r=e[N],a=f(t);if(a<0||a>r)throw A("Wrong offset!");if(a+(n=void 0===n?r-a:d(n))>r)throw A("Wrong length!");this[k]=e,this[M]=a,this[N]=n},a&&(j(S,"byteLength","_l"),j(y,"buffer","_b"),j(y,"byteLength","_l"),j(y,"byteOffset","_o")),s(y[g],{getInt8:function(e){return V(this,1,e)[0]<<24>>24},getUint8:function(e){return V(this,1,e)[0]},getInt16:function(e){var t=V(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=V(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return U(V(this,4,e,arguments[1]))},getUint32:function(e){return U(V(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return L(V(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return L(V(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){q(this,1,e,x,t)},setUint8:function(e,t){q(this,1,e,x,t)},setInt16:function(e,t){q(this,2,e,F,t,arguments[2])},setUint16:function(e,t){q(this,2,e,F,t,arguments[2])},setInt32:function(e,t){q(this,4,e,B,t,arguments[2])},setUint32:function(e,t){q(this,4,e,B,t,arguments[2])},setFloat32:function(e,t){q(this,4,e,G,t,arguments[2])},setFloat64:function(e,t){q(this,8,e,H,t,arguments[2])}});E(S,"ArrayBuffer"),E(y,"DataView"),u(y[g],o.VIEW,!0),t.ArrayBuffer=S,t.DataView=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(120),i=(r=a)&&r.__esModule?r:{default:r};t.default=(0,i.default)({WIFI_AND_ETHERNET:"wifiEthernet",CELLULAR_AND_OTHERS:"cellularOther",UNKNOWN:"unknown",NONE:"none"})},function(e,t,n){var r=n(24),a=n(21).document,i=r(a)&&r(a.createElement);e.exports=function(e){return i?a.createElement(e):{}}},function(e,t,n){var r=n(24);e.exports=function(e,t){if(!r(e))return e;var n,a;if(t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;if("function"==typeof(n=e.valueOf)&&!r(a=n.call(e)))return a;if(!t&&"function"==typeof(n=e.toString)&&!r(a=n.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(94);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(168)("keys"),a=n(122);e.exports=function(e){return r[e]||(r[e]=a(e))}},function(e,t,n){var r=n(8),a=n(21),i=a["__core-js_shared__"]||(a["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(95)?"pure":"global",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var r=n(95),a=n(10),i=n(234),o=n(53),u=n(80),s=n(499),l=n(96),c=n(237),f=n(23)("iterator"),d=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,n,_,p,v,E){s(n,t,_);var g,m,S,y=function(e){if(!d&&e in D)return D[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",A="values"==p,C=!1,D=e.prototype,P=D[f]||D["@@iterator"]||p&&D[p],R=P||y(p),w=p?A?y("entries"):R:void 0,O="Array"==t&&D.entries||P;if(O&&(S=c(O.call(new e)))!==Object.prototype&&S.next&&(l(S,T,!0),r||"function"==typeof S[f]||o(S,f,h)),A&&P&&"values"!==P.name&&(C=!0,R=function(){return P.call(this)}),r&&!E||!d&&!C&&D[f]||o(D,f,R),u[t]=R,u[T]=h,p)if(g={values:A?R:y("values"),keys:v?R:y("keys"),entries:w},E)for(m in g)m in D||i(D,m,g[m]);else a(a.P+a.F*(d||C),t,g);return g}},function(e,t,n){t.f=n(23)},function(e,t,n){var r=n(21),a=n(8),i=n(95),o=n(171),u=n(36).f;e.exports=function(e){var t=a.Symbol||(a.Symbol=i?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||u(t,e,{value:o.f(e)})}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(127),a=n(91),i=n(69),o=n(163),u=n(67),s=n(231),l=Object.getOwnPropertyDescriptor;t.f=n(37)?l:function(e,t){if(e=i(e),t=o(t,!0),s)try{return l(e,t)}catch(e){}if(u(e,t))return a(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(53);e.exports=function(e,t,n){for(var a in t)n&&e[a]?e[a]=t[a]:r(e,a,t[a]);return e}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(129),a=n(23)("iterator"),i=n(80);e.exports=n(8).getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||i[r(e)]}},function(e,t,n){var r=n(24);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){e.exports={default:n(526),__esModule:!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(71);!function(e){e[e.DASH=0]="DASH",e[e.HLS=1]="HLS",e[e.SMOOTH=2]="SMOOTH"}(r=t.StreamType||(t.StreamType={})),t.toPeerAgentStreamType=function(e){switch(e){case r.DASH:return a.StreamTypes.DASH;case r.HLS:return a.StreamTypes.HLS;case r.SMOOTH:return a.StreamTypes.SMOOTH;default:throw new Error("Peer-agent doesn't support the stream format "+e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(120)),a=o(n(1)),i=n(38);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t,n,o){var u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if((0,a.default)(this,e),!(0,i.isNumeric)(n))throw new Error("Invalid value for size");if(!o)throw new Error("No hash");this.segmentView=t,this.size=n,this.hash=o,this.trusted=u,(0,r.default)(this)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={IDLE:"IDLE",NO_PEER:"NO_PEER",RANDOM:"RANDOM",DYNAMIC:"DYNAMIC",TOP_SEEDER:"TOP_SEEDER",STATIC:"STATIC"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={DISABLED:"disabled",FORBIDDEN:"forbidden",FORCED:"forced"};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(17)),a=u(n(20)),i=u(n(1)),o=u(n(2));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){(0,i.default)(this,e),this._timers=new a.default}return(0,o.default)(e,[{key:"register",value:function(e){var t=e.name;return!this._timers.has(t)&&(this._timers.set(t,e),!0)}},{key:"registerAs",value:function(e,t){return!this._timers.has(e)&&(t.name=e,this._timers.set(e,t),!0)}},{key:"clear",value:function(e){return!!e&&this.clearNamedTimer(e.name)}},{key:"clearNamedTimer",value:function(e){var t=this._timers.get(e);return!!t&&(t.clear(),this._timers.delete(t.name))}},{key:"clearAll",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,i=(0,r.default)(this._timers.values());!(e=(a=i.next()).done);e=!0){var o=a.value;this.clear(o)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){(0,r.default)(this,e),this._expirationThreshold=t,this._values=[]}return(0,a.default)(e,[{key:"push",value:function(e){this._cleanExpiredValues(),this._values.push({time:Date.now(),value:e})}},{key:"_cleanExpiredValues",value:function(){for(var e=Date.now();this._values.length>0&&e-this._expirationThreshold>=this._values[0].time;)this._values.shift()}},{key:"subDelta",value:function(e){if(this._cleanExpiredValues(),e>this._expirationThreshold)return null;for(var t=Date.now()-e,n=0;n<this._values.length&&this._values[n].time<=t;)n++;return n<this._values.length-1?this._values[this._values.length-1].value-this._values[n].value:null}},{key:"subTimeDelta",value:function(e){if(this._cleanExpiredValues(),e>this._expirationThreshold)return null;for(var t=Date.now()-e,n=0;n<this._values.length&&this._values[n].time<=t;)n++;return n<this._values.length-1?this._values[this._values.length-1].time-this._values[n].time:null}},{key:"delta",get:function(){return this._cleanExpiredValues(),this._values.length>1?this._values[this._values.length-1].value-this._values[0].value:null}},{key:"timeDelta",get:function(){return this._cleanExpiredValues(),this._values.length>1?this._values[this._values.length-1].time-this._values[0].time:null}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){(0,r.default)(this,e),this._maxSize=t,this._internalQueue=[]}return(0,a.default)(e,[{key:"addSample",value:function(e){this._internalQueue.length>=this._maxSize&&this._internalQueue.shift(),this._internalQueue.push(e)}},{key:"fetchSample",value:function(){if(this._internalQueue.length>0){var e=Math.floor(Math.random()*this._internalQueue.length);return this._internalQueue.splice(e,1)[0]}}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ACTIVE:"active",CLOSED:"closed",SHUT:"shut"};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(48)),a=c(n(84)),i=c(n(1)),o=c(n(2)),u=c(n(262)),s=c(n(132)),l=c(n(3));function c(e){return e&&e.__esModule?e:{default:e}}var f="peer_connector",d="peer_pool",h="shared_state",_=function(){function e(t,n,r){(0,i.default)(this,e),e.instance=this,s.default.add(f,d,n),s.default.add(f,h,r),this.pendingPeerSet=new a.default,this._peerId=t,this._conf=r.conf,this._pool=n,PeerConnectorInteractor.registerToSignaling(t,this._conf.PEER_CONNECTION_TIMEOUT),r.eventBus.on(l.default.Signaling.SIGNALING_DISCONNECTION_REQUEST,function(e){})}return(0,o.default)(e,[{key:"createPeerConnection",value:function(e){PeerConnectorInteractor.openConnection(e)&&this.pendingPeerSet.add(e)}},{key:"getPeerConnectionCount",value:function(){return this.pendingPeerSet.size}},{key:"getOpenConnectorSlotsCount",value:function(){return Math.max(Math.round(this._pool.openSlotsCount()-this.getPeerConnectionCount()*this._conf.EXPECTED_CONNECTION_SUCCESS_RATE),0)}},{key:"getPendingConnectionDebugInfos",value:function(){return[]}},{key:"dispose",value:function(){}},{key:"getPendingConnectionPeers",value:function(){return(0,r.default)(this.pendingPeerSet)}}],[{key:"connectedToSignalingServer",value:function(){var e=s.default.get(f,h);e&&e.status&&e.status.setConnectedToSignalingServer()}},{key:"disconnectedFromSignalingServer",value:function(){var e=s.default.get(f,h);e&&e.status&&e.status.setDisconnectedToSignalingServer()}},{key:"peerConnectionCallback",value:function(t,n,r){var a=s.default.get(f,d);if(a){var i=e.instance;if(i)switch(i.pendingPeerSet.add(r),t){case"success":var o=s.default.get(f,h);if(o){var l=new u.default(n,o);a.addPeerConnection(r,l),i.pendingPeerSet.delete(r)}break;case"timeout":a.connectionAttemptTimeout(r),i.pendingPeerSet.delete(r);break;case"declined":a.offerDeclined(r),i.pendingPeerSet.delete(r);break;default:ErrorInteractor.error("[SIGNALING] bad status")}else ErrorInteractor.error("PeerConnector was not initialized when peerConnectionCallback was called")}else ErrorInteractor.error("[SIGNALING] peerPool cannot be null")}},{key:"peerConnectionOffered",value:function(t){var n=e.instance;return!!(n&&n.getOpenConnectorSlotsCount()>0)&&(n.pendingPeerSet.add(t),!0)}}]),e}();_.instance=null,t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(82)),a=h(n(83)),i=h(n(100)),o=h(n(17)),u=h(n(48)),s=h(n(20)),l=h(n(1)),c=h(n(2)),f=h(n(604)),d=h(n(3));function h(e){return e&&e.__esModule?e:{default:e}}var _=function(){function e(t,n,r,a){var i=this;(0,l.default)(this,e),this._isFull=!1,this._onCacheFull=function(){i._isFull=!0},this._onCacheFree=function(){i._isFull=!1},this._peerPool=t,this._segmentInfoMap=n,this._sharedState=r,this._timeline=a,this._segmentHandlers=new s.default,this._sharedState.eventBus.on(d.default.GarbageCollector.CACHE_FULL,this._onCacheFull),this._sharedState.eventBus.on(d.default.GarbageCollector.CACHE_FREE,this._onCacheFree)}return(0,c.default)(e,[{key:"dispose",value:function(){this._segmentHandlers=new s.default,this._sharedState.eventBus.removeListener(d.default.GarbageCollector.CACHE_FULL,this._onCacheFull),this._sharedState.eventBus.removeListener(d.default.GarbageCollector.CACHE_FREE,this._onCacheFree)}},{key:"getTimeline",value:function(){return this._timeline}},{key:"getSegmentSize",value:function(e){var t=this.getSegmentHandler(e);return t&&t.chunkManager.size||0}},{key:"getTotalSize",value:function(){return(0,u.default)(this._segmentHandlers.values()).reduce(function(e,t){return e+(t.chunkManager.size||0)},0)}},{key:"getSegmentList",value:function(){return(0,u.default)(this._segmentHandlers.values()).map(function(e){return e.segmentView})}},{key:"removePeer",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=(0,o.default)(this._segmentHandlers.values());!(t=(a=i.next()).done);t=!0){a.value.seeders.remove(e)}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}}},{key:"getSegmentHandler",value:function(e){var t=this._segmentHandlers.get(e.viewToString());return t||null}},{key:"getOrCreateSegmentHandler",value:function(e){var t=this.getSegmentHandler(e);return t||(this._isFull?null:this._createSegmentHandler(e))}},{key:"removeSegmentHandler",value:function(e){var t=e.viewToString(),n=this._segmentHandlers.get(t);n&&(n.dispose(),this._segmentHandlers.delete(t)),this._timeline.remove(e)}},{key:"resetSegmentHandler",value:function(e){return this.removeSegmentHandler(e),this._createSegmentHandler(e)}},{key:"_createSegmentHandler",value:function(e){var t=new f.default(e,this,this._peerPool,this._segmentInfoMap,this._sharedState);return this._segmentHandlers.set(t.segmentView.viewToString(),t),this._timeline.add(e),this._peerPool.requestHasSegment(e),this._sharedState.eventBus.emit(d.default.P2PCache.CACHE_GC_NEEDED),t}},{key:"removeSegmentInfo",value:function(e){this._segmentInfoMap.removeSegmentInfo(e)}},{key:"fillSegment",value:function(e,t){var n=this.getOrCreateSegmentHandler(e);n?(n.chunkManager.storeSegment(t),n.seeders.clear(),this._peerPool.broadcastSegmentInfo(e)):t.recyclable=!0}},{key:"getPartialSegment",value:function(e){var t=this.getSegmentHandler(e),n=t?t.chunkManager:null;return n?n.getPartialSegment():null}},{key:"listSegmentsToSkipForTrack",value:function(e){return[].concat((0,i.default)(this._segmentHandlers)).filter(function(t){var n=(0,a.default)(t,2),r=(n[0],n[1]);return r.segmentView.isInTrack(e)&&!r.chunkManager.shouldDownloadSegment()}).map(function(e){var t=(0,a.default)(e,2);t[0];return t[1].segmentView})}},{key:"listSegmentsDownloadStatus",value:function(){return[].concat((0,i.default)(this._segmentHandlers)).map(function(e){var t=(0,a.default)(e,2),n=(t[0],t[1]);return{segmentcoord:n.segmentView,downloadStatusList:n.chunkManager.downloadStatus,seederCount:n.seeders.length}})}},{key:"listDownloadedSegmentsForTrack",value:function(e){return[].concat((0,i.default)(this._segmentHandlers)).filter(function(t){var n=(0,a.default)(t,2),r=(n[0],n[1]);return r.segmentView.isInTrack(e)&&r.chunkManager.isSegmentDownloaded()}).map(function(e){var t=(0,a.default)(e,2);t[0];return t[1].segmentView})}},{key:"getSegmentsStats",value:function(){if(!this._segmentHandlers.size)return{};var e=void 0,t=0,n=r.default,a=!0,i=!1,u=void 0;try{for(var s,l=(0,o.default)(this._segmentHandlers.values());!(a=(s=l.next()).done);a=!0){e=s.value.segmentView.getId(),n=Math.min(n,e),t=Math.max(t,e)}}catch(e){i=!0,u=e}finally{try{!a&&l.return&&l.return()}finally{if(i)throw u}}return{minSegmentId:n,maxSegmentId:t}}}]),e}();t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(13)),a=f(n(1)),i=f(n(2)),o=f(n(11)),u=f(n(101)),s=f(n(12)),l=f(n(270)),c=f(n(632));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,n,i){(0,a.default)(this,t);var u=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i));return u._initStats(),u}return(0,s.default)(t,e),(0,i.default)(t,[{key:"_initStats",value:function(){this._stats={cdnDownloaded:0,cdnDuration:0,p2pDownloaded:0,p2pDuration:0}}},{key:"_getSegmentImplementation",value:function(){var e=this,t={result:function(t,n){t?e._onHttpError(t):e._onHttpSuccess(n)},progress:this._handlers.onProgress},n=this._getRange(),r=new c.default(this._sharedState,this._request,this._stats,t,n);this._httpRequest=r.send()}},{key:"_getRange",value:function(){}},{key:"_onHttpError",value:function(e){this._onRequestError(e)}},{key:"_onHttpSuccess",value:function(e){this._onRequestSuccess(e)}},{key:"_abort",value:function(){(0,u.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"_abort",this).call(this),this._httpRequest.abort()}}]),t}(l.default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.noop=function(){}},function(e,t,n){"use strict";e.exports=n(271).default},function(e,t,n){"use strict";var r=n(90);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(86)),a=c(n(92)),i=c(n(640)),o=c(n(54)),u=c(n(643)),s=c(n(120)),l=c(n(55));function c(e){return e&&e.__esModule?e:{default:e}}t.default={merge:function(e,t){return(0,l.default)(e,t)},deepFreeze:function e(t){(0,s.default)(t);for(var n=(0,u.default)(t),r=0;r<n.length;r++){var a=t[n[r]];null===a||"object"!==(void 0===a?"undefined":(0,o.default)(a))||(0,i.default)(a)||e(a)}},omit:function(e,t){for(var n={},r=(0,a.default)(e),i=0;i<r.length;i++){var o=r[i];t!==o&&(n[o]=e[o])}return n},deepCopy:function(e){return JSON.parse((0,r.default)(e))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t,n,a){(0,r.default)(this,e),this._message=t,this._status=n,this._readyState=a}return(0,a.default)(e,[{key:"message",get:function(){return this._message}},{key:"status",get:function(){return this._status}},{key:"readyState",get:function(){return this._readyState}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeFromRequest=t.getHttpRequestHeaders=void 0;var r,a=n(55),i=(r=a)&&r.__esModule?r:{default:r};t.getHttpRequestHeaders=function(e,t){var n={},r=e.headers;if(r&&void 0!==r.length)throw new Error("Custom headers object should not have a `length` attribute (you might use the previous API format)");return r&&(0,i.default)(n,r),t&&(n.Range=function(e){return"bytes="+e.start+"-"+(e.end||"")}(t)),n},t.getRangeFromRequest=function(e){var t=e.headers;if(t&&void 0!==t.Range){var n=t.Range.split("=")[1].split("-"),r=parseInt(n[0],10),a=parseInt(n[1],10);return isNaN(a)?{start:r}:{start:r,end:a}}}},function(e,t,n){e.exports=!n(14)&&!n(6)(function(){return 7!=Object.defineProperty(n(135)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){t.f=n(9)},function(e,t,n){var r=n(28),a=n(29),i=n(106)(!1),o=n(137)("IE_PROTO");e.exports=function(e,t){var n,u=a(e),s=0,l=[];for(n in u)n!=o&&r(u,n)&&l.push(n);for(;t.length>s;)r(u,n=t[s++])&&(~i(l,n)||l.push(n));return l}},function(e,t,n){var r=n(15),a=n(4),i=n(59);e.exports=n(14)?Object.defineProperties:function(e,t){a(e);for(var n,o=i(t),u=o.length,s=0;u>s;)r.f(e,n=o[s++],t[n]);return e}},function(e,t,n){var r=n(29),a=n(62).f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==i.call(e)?function(e){try{return a(e)}catch(e){return o.slice()}}(e):a(r(e))}},function(e,t,n){"use strict";var r=n(59),a=n(107),i=n(88),o=n(19),u=n(87),s=Object.assign;e.exports=!s||n(6)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=s({},e)[n]||Object.keys(s({},t)).join("")!=r})?function(e,t){for(var n=o(e),s=arguments.length,l=1,c=a.f,f=i.f;s>l;)for(var d,h=u(arguments[l++]),_=c?r(h).concat(c(h)):r(h),p=_.length,v=0;p>v;)f.call(h,d=_[v++])&&(n[d]=h[d]);return n}:s},function(e,t,n){"use strict";var r=n(22),a=n(7),i=n(204),o=[].slice,u={};e.exports=Function.bind||function(e){var t=r(this),n=o.call(arguments,1),s=function(){var r=n.concat(o.call(arguments));return this instanceof s?function(e,t,n){if(!(t in u)){for(var r=[],a=0;a<t;a++)r[a]="a["+a+"]";u[t]=Function("F,a","return new F("+r.join(",")+")")}return u[t](e,n)}(t,r.length,r):i(t,r,e)};return a(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(5).parseInt,a=n(74).trim,i=n(141),o=/^[-+]?0[xX]/;e.exports=8!==r(i+"08")||22!==r(i+"0x16")?function(e,t){var n=a(String(e),3);return r(n,t>>>0||(o.test(n)?16:10))}:r},function(e,t,n){var r=n(5).parseFloat,a=n(74).trim;e.exports=1/r(n(141)+"-0")!=-1/0?function(e){var t=a(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(34);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){var r=n(7),a=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&a(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){var r=n(144),a=Math.pow,i=a(2,-52),o=a(2,-23),u=a(2,127)*(2-o),s=a(2,-126);e.exports=Math.fround||function(e){var t,n,a=Math.abs(e),l=r(e);return a<s?l*(a/s/o+1/i-1/i)*s*o:(n=(t=(1+o/i)*a)-(t-a))>u||n!=n?l*(1/0):l*n}},function(e,t,n){var r=n(4);e.exports=function(e,t,n,a){try{return a?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(22),a=n(19),i=n(87),o=n(16);e.exports=function(e,t,n,u,s){r(t);var l=a(e),c=i(l),f=o(l.length),d=s?f-1:0,h=s?-1:1;if(n<2)for(;;){if(d in c){u=c[d],d+=h;break}if(d+=h,s?d<0:f<=d)throw TypeError("Reduce of empty array with no initial value")}for(;s?d>=0:f>d;d+=h)d in c&&(u=t(u,c[d],d,l));return u}},function(e,t,n){"use strict";var r=n(19),a=n(60),i=n(16);e.exports=[].copyWithin||function(e,t){var n=r(this),o=i(n.length),u=a(e,o),s=a(t,o),l=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===l?o:a(l,o))-s,o-u),f=1;for(s<u&&u<s+c&&(f=-1,s+=c-1,u+=c-1);c-- >0;)s in n?n[u]=n[s]:delete n[u],u+=f,s+=f;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){n(14)&&"g"!=/./g.flags&&n(15).f(RegExp.prototype,"flags",{configurable:!0,get:n(111)})},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(4),a=n(7),i=n(159);e.exports=function(e,t){if(r(e),a(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(219),a=n(76);e.exports=n(115)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(a(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(a(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(15).f,a=n(61),i=n(66),o=n(33),u=n(64),s=n(65),l=n(147),c=n(214),f=n(63),d=n(14),h=n(49).fastKey,_=n(76),p=d?"_s":"size",v=function(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var c=e(function(e,r){u(e,c,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[p]=0,void 0!=r&&s(r,n,e[l],e)});return i(c.prototype,{clear:function(){for(var e=_(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[p]=0},delete:function(e){var n=_(this,t),r=v(n,e);if(r){var a=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=a),a&&(a.p=i),n._f==r&&(n._f=a),n._l==r&&(n._l=i),n[p]--}return!!r},forEach:function(e){_(this,t);for(var n,r=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!v(_(this,t),e)}}),d&&r(c.prototype,"size",{get:function(){return _(this,t)[p]}}),c},def:function(e,t,n){var r,a,i=v(e,t);return i?i.v=n:(e._l=i={i:a=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=i),r&&(r.n=i),e[p]++,"F"!==a&&(e._i[a]=i)),e},getEntry:v,setStrong:function(e,t,n){l(e,t,function(e,n){this._t=_(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?c(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,c(1))},n?"entries":"values",!n,!0),f(t)}}},function(e,t,n){"use strict";var r=n(219),a=n(76);e.exports=n(115)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(a(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,a=n(43)(0),i=n(26),o=n(49),u=n(202),s=n(222),l=n(7),c=n(6),f=n(76),d=o.getWeak,h=Object.isExtensible,_=s.ufstore,p={},v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},E={get:function(e){if(l(e)){var t=d(e);return!0===t?_(f(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return s.def(f(this,"WeakMap"),e,t)}},g=e.exports=n(115)("WeakMap",v,E,s,!0,!0);c(function(){return 7!=(new g).set((Object.freeze||Object)(p),7).get(p)})&&(u((r=s.getConstructor(v,"WeakMap")).prototype,E),o.NEED=!0,a(["delete","has","get","set"],function(e){var t=g.prototype,n=t[e];i(t,e,function(t,a){if(l(t)&&!h(t)){this._f||(this._f=new r);var i=this._f[e](t,a);return"set"==e?this:i}return n.call(this,t,a)})}))},function(e,t,n){"use strict";var r=n(66),a=n(49).getWeak,i=n(4),o=n(7),u=n(64),s=n(65),l=n(43),c=n(28),f=n(76),d=l(5),h=l(6),_=0,p=function(e){return e._l||(e._l=new v)},v=function(){this.a=[]},E=function(e,t){return d(e.a,function(e){return e[0]===t})};v.prototype={get:function(e){var t=E(this,e);if(t)return t[1]},has:function(e){return!!E(this,e)},set:function(e,t){var n=E(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=h(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,i){var l=e(function(e,r){u(e,l,t,"_i"),e._t=t,e._i=_++,e._l=void 0,void 0!=r&&s(r,n,e[i],e)});return r(l.prototype,{delete:function(e){if(!o(e))return!1;var n=a(e);return!0===n?p(f(this,t)).delete(e):n&&c(n,this._i)&&delete n[this._i]},has:function(e){if(!o(e))return!1;var n=a(e);return!0===n?p(f(this,t)).has(e):n&&c(n,this._i)}}),l},def:function(e,t,n){var r=a(i(t),!0);return!0===r?p(e).set(t,n):r[e._i]=n,e},ufstore:p}},function(e,t,n){var r=n(41),a=n(16);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=a(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var r=n(62),a=n(107),i=n(4),o=n(5).Reflect;e.exports=o&&o.ownKeys||function(e){var t=r.f(i(e)),n=a.f;return n?t.concat(n(e)):t}},function(e,t,n){"use strict";var r=n(108),a=n(7),i=n(16),o=n(33),u=n(9)("isConcatSpreadable");e.exports=function e(t,n,s,l,c,f,d,h){for(var _,p,v=c,E=0,g=!!d&&o(d,h,3);E<l;){if(E in s){if(_=g?g(s[E],E,n):s[E],p=!1,a(_)&&(p=void 0!==(p=_[u])?!!p:r(_)),p&&f>0)v=e(t,n,_,i(_.length),v,f-1)-1;else{if(v>=9007199254740991)throw TypeError();t[v]=_}v++}E++}return v}},function(e,t,n){var r=n(16),a=n(143),i=n(40);e.exports=function(e,t,n,o){var u=String(i(e)),s=u.length,l=void 0===n?" ":String(n),c=r(t);if(c<=s||""==l)return u;var f=c-s,d=a.call(l,Math.ceil(f/l.length));return d.length>f&&(d=d.slice(0,f)),o?d+u:u+d}},function(e,t,n){var r=n(59),a=n(29),i=n(88).f;e.exports=function(e){return function(t){for(var n,o=a(t),u=r(o),s=u.length,l=0,c=[];s>l;)i.call(o,n=u[l++])&&c.push(e?[n,o[n]]:o[n]);return c}}},function(e,t,n){var r=n(89),a=n(229);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},function(e,t,n){var r=n(65);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t){e.exports=Math.scale||function(e,t,n,r,a){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||a!=a?NaN:e===1/0||e===-1/0?e:(e-t)*(a-r)/(n-t)+r}},function(e,t,n){e.exports=!n(37)&&!n(52)(function(){return 7!=Object.defineProperty(n(162)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,a="~";function i(){}function o(e,t,n,r,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new function(e,t,n){this.fn=e,this.context=t,this.once=n||!1}(n,r||e,i),u=a?a+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],o]:e._events[u].push(o):(e._events[u]=o,e._eventsCount++),e}function u(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(a=!1)),s.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(a?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},s.prototype.listeners=function(e){var t=a?a+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,o=new Array(i);r<i;r++)o[r]=n[r].fn;return o},s.prototype.listenerCount=function(e){var t=a?a+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,r,i,o){var u=a?a+e:e;if(!this._events[u])return!1;var s,l,c=this._events[u],f=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,i),!0;case 6:return c.fn.call(c.context,t,n,r,i,o),!0}for(l=1,s=new Array(f-1);l<f;l++)s[l-1]=arguments[l];c.fn.apply(c.context,s)}else{var d,h=c.length;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),f){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,n);break;case 4:c[l].fn.call(c[l].context,t,n,r);break;default:if(!s)for(d=1,s=new Array(f-1);d<f;d++)s[d-1]=arguments[d];c[l].fn.apply(c[l].context,s)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,n,r){var i=a?a+e:e;if(!this._events[i])return this;if(!t)return u(this,i),this;var o=this._events[i];if(o.fn)o.fn!==t||r&&!o.once||n&&o.context!==n||u(this,i);else{for(var s=0,l=[],c=o.length;s<c;s++)(o[s].fn!==t||r&&!o[s].once||n&&o[s].context!==n)&&l.push(o[s]);l.length?this._events[i]=1===l.length?l[0]:l:u(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=a?a+e:e,this._events[t]&&u(this,t)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=a,s.EventEmitter=s,e.exports=s},function(e,t,n){var r=n(67),a=n(69),i=n(492)(!1),o=n(167)("IE_PROTO");e.exports=function(e,t){var n,u=a(e),s=0,l=[];for(n in u)n!=o&&r(u,n)&&l.push(n);for(;t.length>s;)r(u,n=t[s++])&&(~i(l,n)||l.push(n));return l}},function(e,t,n){e.exports=n(53)},function(e,t,n){var r=n(36),a=n(44),i=n(93);e.exports=n(37)?Object.defineProperties:function(e,t){a(e);for(var n,o=i(t),u=o.length,s=0;u>s;)r.f(e,n=o[s++],t[n]);return e}},function(e,t,n){var r=n(21).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(67),a=n(79),i=n(167)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=a(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var r=n(94);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(69),a=n(241).f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==i.call(e)?function(e){try{return a(e)}catch(e){return o.slice()}}(e):a(r(e))}},function(e,t,n){var r=n(233),a=n(169).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,a)}},function(e,t,n){"use strict";var r=n(36).f,a=n(126),i=n(175),o=n(47),u=n(176),s=n(97),l=n(170),c=n(238),f=n(245),d=n(37),h=n(121).fastKey,_=n(178),p=d?"_s":"size",v=function(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,l){var c=e(function(e,r){u(e,c,t,"_i"),e._t=t,e._i=a(null),e._f=void 0,e._l=void 0,e[p]=0,void 0!=r&&s(r,n,e[l],e)});return i(c.prototype,{clear:function(){for(var e=_(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[p]=0},delete:function(e){var n=_(this,t),r=v(n,e);if(r){var a=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=a),a&&(a.p=i),n._f==r&&(n._f=a),n._l==r&&(n._l=i),n[p]--}return!!r},forEach:function(e){_(this,t);for(var n,r=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!v(_(this,t),e)}}),d&&r(c.prototype,"size",{get:function(){return _(this,t)[p]}}),c},def:function(e,t,n){var r,a,i=v(e,t);return i?i.v=n:(e._l=i={i:a=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=i),r&&(r.n=i),e[p]++,"F"!==a&&(e._i[a]=i)),e},getEntry:v,setStrong:function(e,t,n){l(e,t,function(e,n){this._t=_(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?c(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,c(1))},n?"entries":"values",!n,!0),f(t)}}},function(e,t,n){var r=n(44);e.exports=function(e,t,n,a){try{return a?t(r(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&r(i.call(e)),t}}},function(e,t,n){var r=n(80),a=n(23)("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||i[a]===e)}},function(e,t,n){"use strict";var r=n(21),a=n(8),i=n(36),o=n(37),u=n(23)("species");e.exports=function(e){var t="function"==typeof a[e]?a[e]:r[e];o&&t&&!t[u]&&i.f(t,u,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var r=n(21),a=n(10),i=n(121),o=n(52),u=n(53),s=n(175),l=n(97),c=n(176),f=n(24),d=n(96),h=n(36).f,_=n(517)(0),p=n(37);e.exports=function(e,t,n,v,E,g){var m=r[e],S=m,y=E?"set":"add",T=S&&S.prototype,A={};return p&&"function"==typeof S&&(g||T.forEach&&!o(function(){(new S).entries().next()}))?(S=t(function(t,n){c(t,S,e,"_c"),t._c=new m,void 0!=n&&l(n,E,t[y],t)}),_("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in T&&(!g||"clear"!=e)&&u(S.prototype,e,function(n,r){if(c(this,S,e),!t&&g&&!f(n))return"get"==e&&void 0;var a=this._c[e](0===n?0:n,r);return t?this:a})}),g||h(S.prototype,"size",{get:function(){return this._c.size}})):(S=v.getConstructor(t,e,E,y),s(S.prototype,n),i.NEED=!0),d(S,e),A[e]=S,a(a.G+a.W+a.F,A),g||v.setStrong(S,e,E),S}},function(e,t,n){var r=n(129),a=n(521);e.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return a(this)}}},function(e,t,n){"use strict";var r=n(10);e.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";var r=n(10),a=n(90),i=n(47),o=n(97);e.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,u,s=arguments[1];return a(this),(t=void 0!==s)&&a(s),void 0==e?new this:(n=[],t?(r=0,u=i(s,arguments[2],2),o(e,!1,function(e){n.push(u(e,r++))})):o(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(125),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(e,t,n){return t in e?(0,i.default)(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";(function(t){var r=n(535),a=n(536),i=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,u=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],s={hash:1,query:1};function l(e){var n,r=("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}).location||{},a={},i=typeof(e=e||r);if("blob:"===e.protocol)a=new f(unescape(e.pathname),{});else if("string"===i)for(n in a=new f(e,{}),s)delete a[n];else if("object"===i){for(n in e)n in s||(a[n]=e[n]);void 0===a.slashes&&(a.slashes=o.test(e.href))}return a}function c(e){var t=i.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function f(e,t,n){if(!(this instanceof f))return new f(e,t,n);var i,o,s,d,h,_,p=u.slice(),v=typeof t,E=this,g=0;for("object"!==v&&"string"!==v&&(n=t,t=null),n&&"function"!=typeof n&&(n=a.parse),t=l(t),i=!(o=c(e||"")).protocol&&!o.slashes,E.slashes=o.slashes||i&&t.slashes,E.protocol=o.protocol||t.protocol||"",e=o.rest,o.slashes||(p[3]=[/(.*)/,"pathname"]);g<p.length;g++)"function"!=typeof(d=p[g])?(s=d[0],_=d[1],s!=s?E[_]=e:"string"==typeof s?~(h=e.indexOf(s))&&("number"==typeof d[2]?(E[_]=e.slice(0,h),e=e.slice(h+d[2])):(E[_]=e.slice(h),e=e.slice(0,h))):(h=s.exec(e))&&(E[_]=h[1],e=e.slice(0,h.index)),E[_]=E[_]||i&&d[3]&&t[_]||"",d[4]&&(E[_]=E[_].toLowerCase())):e=d(e);n&&(E.query=n(E.query)),i&&t.slashes&&"/"!==E.pathname.charAt(0)&&(""!==E.pathname||""!==t.pathname)&&(E.pathname=function(e,t){for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,a=n[r-1],i=!1,o=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),o++):o&&(0===r&&(i=!0),n.splice(r,1),o--);return i&&n.unshift(""),"."!==a&&".."!==a||n.push(""),n.join("/")}(E.pathname,t.pathname)),r(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(d=E.auth.split(":"),E.username=d[0]||"",E.password=d[1]||""),E.origin=E.protocol&&E.host&&"file:"!==E.protocol?E.protocol+"//"+E.host:"null",E.href=E.toString()}f.prototype={set:function(e,t,n){var i=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||a.parse)(t)),i[e]=t;break;case"port":i[e]=t,r(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="");break;case"hostname":i[e]=t,i.port&&(t+=":"+i.port),i.host=t;break;case"host":i[e]=t,/:\d+$/.test(t)?(t=t.split(":"),i.port=t.pop(),i.hostname=t.join(":")):(i.hostname=t,i.port="");break;case"protocol":i.protocol=t.toLowerCase(),i.slashes=!n;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";i[e]=t.charAt(0)!==o?o+t:t}else i[e]=t;break;default:i[e]=t}for(var s=0;s<u.length;s++){var l=u[s];l[4]&&(i[l[1]]=i[l[1]].toLowerCase())}return i.origin=i.protocol&&i.host&&"file:"!==i.protocol?i.protocol+"//"+i.host:"null",i.href=i.toString(),i},toString:function(e){e&&"function"==typeof e||(e=a.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var i=r+(n.slashes?"//":"");return n.username&&(i+=n.username,n.password&&(i+=":"+n.password),i+="@"),i+=n.host+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(i+=n.hash),i}},f.extractProtocol=c,f.location=l,f.qs=a,e.exports=f}).call(this,n(104))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77),a=function(){function e(e,t,n,r){this.contentId=null,this.peerAgentCounter=1,this.platform=e,this.platformVersion=t,this.streamrootKey=n,this.manifestUrl=r}return e.newBuilder=function(t,n,r,a){return new e(t,n,r,a)},e.prototype.getPlatform=function(){return this.platform},e.prototype.getPlatformVersion=function(){return this.platformVersion},e.prototype.getStreamrootKey=function(){return this.streamrootKey},e.prototype.getManifestUrl=function(){return this.manifestUrl},e.prototype.setContentId=function(e){return this.contentId=e,this},e.prototype.getContentId=function(){return this.contentId},e.prototype.setStreamType=function(e){return this.streamType=e,this},e.prototype.getStreamType=function(){return this.streamType},e.prototype.setBackendUrls=function(e){return this.backendUrls=e,this},e.prototype.getBackendUrls=function(){return this.backendUrls},e.prototype.setPropertyParameters=function(e){return this.propertyParameters=e,this},e.prototype.getPropertyParameters=function(){return this.propertyParameters},e.prototype.setPaConfig=function(e){return this.paConfig=e,this},e.prototype.getPaConfig=function(){return this.paConfig},e.prototype.setSiteId=function(e){return this.siteId=e,this},e.prototype.getSiteId=function(){return this.siteId},e.prototype.setPeerAgentCounter=function(e){return this.peerAgentCounter=e,this},e.prototype.getPeerAgentCounter=function(){return this.peerAgentCounter},e.prototype.setNetworkType=function(e){return this.networkType=e,this},e.prototype.getNetworkType=function(){return this.networkType},e.prototype.build=function(){return new r.default(this)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TIMER_TYPE=t.AbstractTimer=void 0;var r=o(n(1)),a=o(n(2)),i=o(n(130));function o(e){return e&&e.__esModule?e:{default:e}}var u={TIMEOUT:0,INTERVAL:1},s=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u.TIMEOUT;(0,r.default)(this,e),this._id="timer-"+i.default.v4(),this._name=this._id,this._callback=t,this._time=n,this._type=a,this._isRepeatable=a===u.INTERVAL}return(0,a.default)(e,[{key:"clear",value:function(){throw new Error("Cannot call abstract method")}},{key:"id",get:function(){return this._id}},{key:"name",set:function(e){this._name=e},get:function(){return this._name}}]),e}();t.AbstractTimer=s,t.TIMER_TYPE=u},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var a=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,a=n;return[a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],"-",a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]],a[e[r++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o="Method not implemented",u=function(){function e(){(0,r.default)(this,e)}return(0,a.default)(e,[{key:"getUpdatedRange",value:function(e){throw new Error(o)}},{key:"getFullSegment",value:function(e,t,n){throw new Error(o)}},{key:"isComplete",value:function(){throw new Error(o)}},{key:"isLocked",value:function(){throw new Error(o)}},{key:"p2pSpeed",get:function(){throw new Error(o)}},{key:"p2pAmount",get:function(){throw new Error(o)}},{key:"byteLength",get:function(){throw new Error(o)}}]),e}();t.default=u},function(e,t,n){var r=n(23)("iterator"),a=!1;try{var i=[7][r]();i.return=function(){a=!0},Array.from(i,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var i=[7],o=i[r]();o.next=function(){return{done:n=!0}},i[r]=function(){return o},e(i)}catch(e){}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(575),i=(r=a)&&r.__esModule?r:{default:r};t.default={clear:function(e){e.length=0},withoutAll:function(e,t){for(var n=0,r=e.length-1;r>=0;r--)(0,i.default)(e[r],t)&&(e.splice(r,1),n++);return n}}},function(e,t,n){e.exports={default:n(581),__esModule:!0}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t,n,a,i){(0,r.default)(this,e),this._requestId=t,this._segmentView=n,this._chunkIndex=a,this._bandwidthSafety=i,this._timestamp=Date.now()}return(0,a.default)(e,[{key:"requestId",get:function(){return this._requestId}},{key:"segmentView",get:function(){return this._segmentView}},{key:"chunkIndex",get:function(){return this._chunkIndex}},{key:"bandwidthSafety",get:function(){return this._bandwidthSafety}},{key:"timestamp",get:function(){return this._timestamp}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=_(n(86)),a=_(n(13)),i=_(n(1)),o=_(n(2)),u=_(n(11)),s=_(n(12)),l=_(n(593)),c=_(n(132)),f=_(n(264)),d=_(n(133)),h=_(n(3));function _(e){return e&&e.__esModule?e:{default:e}}var p="peer_connection",v="shared_state",E=function(e){function t(e,n){(0,i.default)(this,t);var r=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,n));return c.default.add(p,v,n),c.default.add(p,e,r),r._connectionId=e,r._checkHeartbeat(),r}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_closeConnectionIfOpen",value:function(){PeerConnectorInteractor.closeConnection(this._connectionId),this._setDisconnected()}},{key:"sendMessage",value:function(e,t){var n=f.default.encode(e,t);PeerConnectorInteractor.sendMessage(this._connectionId,(0,r.default)(n))}},{key:"sendBinaryData",value:function(e,t){return PeerConnectorInteractor.sendData(this._connectionId,t.requestId,t.chunkIndex,e.id,e.offset,e.byteLength)}},{key:"destroy",value:function(){c.default.remove(p,this._connectionId),this._timerStore.clearAll()}},{key:"close",value:function(){this._closeConnectionIfOpen(),this.destroy()}},{key:"getRtt",value:function(){return-1}},{key:"getBufferedAmount",value:function(){return PeerConnectorInteractor.getBufferedAmount(this._connectionId)}},{key:"onbufferedamountlow",set:function(e){this._onBufferedAmountLow=e}}],[{key:"receivedMessage",value:function(e,t){var n=c.default.get(p,v);n&&(n.transferStats.p2pMessagesCount++,n.transferStats.p2pMessagesDownloaded+=t.length);var r=c.default.get(p,e);if(r){r._lastCommunication=Date.now();var a=f.default.decode(JSON.parse(t));r.emit(h.default.PeerConnection.MESSAGE_RECEIVED,a.type,a.args)}}},{key:"receivedData",value:function(e,t,n,r,a,i){var o=c.default.get(p,e);if(o){o._lastCommunication=Date.now();var u=c.default.get(p,v);u&&(u.transferStats.p2pHeadersDownloaded+=a,u.transferStats.p2pMediaDownloaded+=i);var s=new d.default(i,t);o.emit(h.default.PeerConnection.BINARY_DATA_RECEIVED,s,r,n)}else SegmentInteractor.clearBinaryData(t)}},{key:"onDisconnect",value:function(e){var t=c.default.get(p,e);t&&t._setDisconnected()}},{key:"onBufferedAmountLow",value:function(e){var t=c.default.get(p,e);t&&t._onBufferedAmountLow&&t._onBufferedAmountLow()}}]),t}(l.default);t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e)}return(0,a.default)(e,[{key:"getBinaryData",value:function(e,t){throw new Error("must be implemented")}},{key:"setBinaryData",value:function(e,t){throw new Error("must be implemented")}},{key:"equals",value:function(e){throw new Error("must be implemented")}},{key:"destroy",value:function(){}},{key:"byteLength",get:function(){return this._byteLength}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(55),i=(r=a)&&r.__esModule?r:{default:r},o=n(596);t.default={encode:function(e,t){var n=void 0;switch(e){case o.MessageTypes.INFO:n=o.InfoPayload;break;case o.MessageTypes.HEARTBEAT:n=o.HeartbeatPayload;break;case o.MessageTypes.REQUEST_HAS_SEGMENT:n=o.RequestHasSegmentPayload;break;case o.MessageTypes.HAS_SEGMENT:n=o.HasSegmentPayload;break;case o.MessageTypes.REQUEST_CHUNK:n=o.RequestChunkPayload;break;default:throw new Error("P2P protocol error: unhandled message type")}return(0,i.default)(new n,t).encode()},decode:function(e){var t=void 0;switch(e.a){case o.PayloadTypes.INFO:t=o.InfoPayload;break;case o.PayloadTypes.REQUEST_HAS_SEGMENT:t=o.RequestHasSegmentPayload;break;case o.PayloadTypes.HAS_SEGMENT:t=o.HasSegmentPayload;break;case o.PayloadTypes.REQUEST_CHUNK:t=o.RequestChunkPayload;break;case o.PayloadTypes.HEARTBEAT:t=o.HeartbeatPayload;break;default:throw new Error("P2P protocol error: unhandled message type")}var n=t.decode(e),r=n.type;return delete n.type,{type:r,args:n}}}},function(e,t,n){"use strict";function r(e){if(0===e.length)return null;for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length}Object.defineProperty(t,"__esModule",{value:!0}),t.default={median:function(e){if(0===e.length)return null;e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2},mean:r,meanAbsoluteDeviation:function(e){var t=r(e);if(!t)return null;for(var n=0,a=0;a<e.length;a++)n+=Math.abs(e[a]-t);return n/e.length}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={PeerStats:{SAMPLED_PUC:"sampledPUC",SAMPLED_LIVE_CONNECTION_RTT:"sampledLiveConnectionRtt",SAMPLED_RESPONSE_TIME:"sampledResponseTime",SAMPLED_RESPONSE_DURATION_PER_CHUNK:"sampledResponseDurationPerChunk",SAMPLED_LAST_CHUNK_DELAY_FROM_TIMEOUT:"sampledLastChunkDelayFromTimeout",TOTAL_CONNECTION_DURATION:"totalConnectionDuration"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),a=u(n(2)),i=u(n(616)),o=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n){var a=this;(0,r.default)(this,e),this._onGarbageCollectionNeeded=function(){a.run()},this._onTrackEdgeChanged=function(e){e.isVideo&&a._cacheIsFull&&a.run()},this._onTrackSwitch=function(){a._cacheIsFull&&a.run()},this._sharedState=t,this._p2pCache=n,this._sharedState.eventBus.on(o.default.P2PCache.CACHE_GC_NEEDED,this._onGarbageCollectionNeeded),this._sharedState.eventBus.on(o.default.Media.TRACK_EDGE_CHANGED,this._onTrackEdgeChanged),this._sharedState.eventBus.on(o.default.Metrics.TRACK_SWITCH,this._onTrackSwitch)}return(0,a.default)(e,[{key:"dispose",value:function(){this._sharedState.eventBus.removeListener(o.default.P2PCache.CACHE_GC_NEEDED,this._onGarbageCollectionNeeded),this._sharedState.eventBus.removeListener(o.default.Media.TRACK_EDGE_CHANGED,this._onTrackEdgeChanged),this._sharedState.eventBus.removeListener(o.default.Metrics.TRACK_SWITCH,this._onTrackSwitch)}},{key:"run",value:function(){var e=this._sharedState.moduleState.isLive(),t=e?this._sharedState.conf.LIVE.P2P_CACHE_MAX_SIZE:this._sharedState.conf.P2P_CACHE_MAX_SIZE,n=e?this._sharedState.conf.LIVE.P2P_CACHE_MAX_DURATION:this._sharedState.conf.P2P_CACHE_MAX_DURATION,r=0;t>0&&(r=this._p2pCache.getTotalSize()-t);var a=0;n>0&&(a=this._p2pCache.getTimeline().getTotalDuration()-n);var u=this._collect(new i.default(r,a));u!==this._cacheIsFull&&(this._cacheIsFull=u,u?this._sharedState.eventBus.emit(o.default.GarbageCollector.CACHE_FULL):this._sharedState.eventBus.emit(o.default.GarbageCollector.CACHE_FREE))}},{key:"_collect",value:function(e){return!e.finished}},{key:"_removeSegment",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this._p2pCache.getSegmentSize(e),a=this._p2pCache.getTimeline().getSegmentDuration(e);t.recordRemoved(r,a),n&&t.finished||(this._p2pCache.removeSegmentHandler(e),this._p2pCache.removeSegmentInfo(e))}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(48)),a=h(n(20)),i=h(n(84)),o=h(n(17)),u=h(n(1)),s=h(n(2)),l=h(n(621)),c=h(n(622)),f=h(n(3)),d=n(71);function h(e){return e&&e.__esModule?e:{default:e}}var _=function(){function e(t,n,r,a){(0,u.default)(this,e),this._videoSegmentCountMissingFromME=-1,this._cachedSegmentToDownload=[],this._sharedState=a,this._currentTracks=a.moduleState.currentTracks,this._p2pCache=n,this._distributedSegmentList=r,this._mediaMapCache=new c.default(t,a),this._edges=new l.default(this._mediaMapCache,a)}return(0,s.default)(e,[{key:"_getSegmentsToDownloadByTrack",value:function(e,t){var n=[],r=void 0;if(r="audio"===t?this._edges.audio:this._edges.video){var a=this._mediaMapCache.getSegmentListAfterEdge(e,r,this._sharedState.conf.MAX_BUFFER_DURATION),i=this._distributedSegmentList.getSegmentListAfter(r),o=this._mergeDedupe(a,i),u=0===o.length?[]:this._p2pCache.listSegmentsToSkipForTrack(e);if("video"===t&&a.length!==this._videoSegmentCountMissingFromME&&(this._videoSegmentCountMissingFromME=a.length,this._sharedState.eventBus.emit(f.default.Scheduler.UPDATE_VIDEO_SEGMENT_LIST_MISSING_FROM_ME,{count:this._videoSegmentCountMissingFromME})),n=this._getDifference(o,u),this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK&&this._checkNextSegmentPrebuffered(t,o,n),null===this._mediaMapCache.getSegmentTime(r))this._sharedState.errorFunnel.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable"));else if(this._sharedState.moduleState.isLive()){var s=this._sharedState.moduleState.streamType===d.StreamTypes.HLS?a:o;if(s.length>1){var l=s[0],c=s[s.length-1],h=this._mediaMapCache.getSegmentTime(l),_=this._mediaMapCache.getSegmentTime(c);if(null!==h&&null!==_){var p=_-h;this._sharedState.moduleState.isNearEdge=p<=this._sharedState.conf.LIVE.NEAR_EDGE_MARGIN/1e3}else this._sharedState.errorFunnel.notifyError(new Error("Unexpected getSegmentTime error: 1st and last segments in range are unreliable")),this._sharedState.moduleState.isNearEdge=!0}else this._sharedState.moduleState.isNearEdge=!0}}return n}},{key:"_checkNextSegmentPrebuffered",value:function(e,t,n){this._sharedState.moduleState.nextSegmentPrebuffered[e]=t.length>=2&&(!n.length||!t[0].isEqual(n[0])&&!t[1].isEqual(n[0]))}},{key:"isSegmentRequested",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=(0,o.default)(this._cachedSegmentToDownload);!(t=(a=i.next()).done);t=!0){var u=a.value;if(e.isEqual(u)){var s=this._p2pCache.getSegmentHandler(e);return!!s&&s.chunkManager.shouldDownloadSegment()}}}catch(e){n=!0,r=e}finally{try{!t&&i.return&&i.return()}finally{if(n)throw r}}return this._cachedSegmentToDownload.length<this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER&&this.isSegmentInAcceptableRange(e)}},{key:"isSegmentInAcceptableRange",value:function(e){for(var t=!1,n=["audio","video"],r=0;r<n.length;r++){var a=n[r],i=this._edges[a];t=t||!!i&&e.isInTrack(i.trackView)&&e.getId()>i.getId()&&e.getId()-i.getId()<=this._sharedState.conf.SEGMENT_ID_ACCEPTABLE_RANGE}return t}},{key:"_getDifference",value:function(e,t){if(0===t.length||0===e.length)return e;var n=new i.default(t.map(function(e){return e.viewToString()}));return e.filter(function(e){return!n.has(e.viewToString())})}},{key:"_mergeDedupe",value:function(e,t){var n=new a.default,i=!0,u=!1,s=void 0;try{for(var l,c=(0,o.default)(e);!(i=(l=c.next()).done);i=!0){var f=l.value;n.set(f.viewToString(),f)}}catch(e){u=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(u)throw s}}var d=!0,h=!1,_=void 0;try{for(var p,v=(0,o.default)(t);!(d=(p=v.next()).done);d=!0){var E=p.value;n.set(E.viewToString(),E)}}catch(e){h=!0,_=e}finally{try{!d&&v.return&&v.return()}finally{if(h)throw _}}return(0,r.default)(n.values())}},{key:"getCachedSegmentListToDownload",value:function(){return this._cachedSegmentToDownload}},{key:"getSegmentListToDownload",value:function(){throw new Error("Cannot call abstract method")}},{key:"updateTrackEdge",value:function(e){throw new Error("Cannot call abstract method")}},{key:"getEdgeSegment",value:function(){return this._edges.video}},{key:"dispose",value:function(){this._mediaMapCache.dispose()}}]),e}();t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=function(e){if(null===e)throw new Error("Panic! Attempted to unwrap null");if(void 0===e)throw new Error("Panic! Attempted to unwrap undefined");return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=n(191);function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n,a){(0,r.default)(this,e),this._sharedState=t,this._request=n,this._handlers=a}return(0,a.default)(e,[{key:"getSegment",value:function(){try{this._getSegmentImplementation()}catch(e){this._onRequestFallback(e)}return{abort:this._abort.bind(this)}}},{key:"_getSegmentImplementation",value:function(){throw new Error("Cannot call abstract method")}},{key:"_onRequestSuccess",value:function(e){this._incSuccessStats(),this._handlers.onSuccess(e,this._stats,this._request)}},{key:"_onRequestError",value:function(e){this._handlers.onError(e,this._request)}},{key:"_onRequestFallback",value:function(e){this._handlers.onFallback(e)}},{key:"_abort",value:function(){this._noopHandlers(),this._incAbortStats()}},{key:"_noopHandlers",value:function(){this._handlers.onSuccess=i.noop,this._handlers.onFallback=i.noop}},{key:"_incSuccessStats",value:function(){this._sharedState.controlStats.getSegmentSuccess++}},{key:"_incAbortStats",value:function(){this._sharedState.mediaStats.abortFragmentCount++}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=E(n(272)),a=E(n(86)),i=E(n(92)),o=E(n(13)),u=E(n(1)),s=E(n(2)),l=E(n(11)),c=E(n(12)),f=E(n(20)),d=E(n(130)),h=E(n(277)),_=E(n(133)),p=E(n(102)),v=E(n(195));function E(e){return e&&e.__esModule?e:{default:e}}var g=new f.default,m=function(e){function t(e,n,r){(0,u.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e,n,r));return a._aborted=!1,a._id="http-request-"+d.default.v4(),a}return(0,c.default)(t,e),(0,s.default)(t,[{key:"_init",value:function(){}},{key:"_send",value:function(e){var t=this;if("GET"!==this._method||"arraybuffer"!==this._options.responseType)throw new Error("Unsupported method "+this._method+" for "+this._url+" with body "+e);g.set(this._id,this);var n=this._options.headers&&(0,i.default)(this._options.headers).length>0?(0,a.default)(this._options.headers):"";return HttpRequestInteractor.getBinaryData(this._id,this._url,n),new r.default(function(e,n){t._onSuccess=e,t._onFailure=n})}},{key:"abort",value:function(){HttpRequestInteractor.abort(this._id)}}],[{key:"dataResponse",value:function(e,n,r,a){var i=g.get(e),o=new _.default(r,n);i?(i._aborted?(i._onFailure(new v.default(t.Errors.REQUEST_ABORTED,0,p.default.ReadyStates.OPENED)),o.destroy()):i._options.validStatusCodes.indexOf(a)>-1&&n?i._onSuccess(o):(i._onFailure(new v.default(t.Errors.REQUEST_ERROR,a,p.default.ReadyStates.DONE)),o.destroy()),g.delete(e)):(ErrorInteractor.error('Cannot get http request with id "'+e+'"'),o.destroy())}}]),t}(h.default);t.default=m},function(e,t,n){e.exports={default:n(633),__esModule:!0}},function(e,t,n){var r=n(44),a=n(90),i=n(23)("species");e.exports=function(e,t){var n,o=r(e).constructor;return void 0===o||void 0==(n=r(o)[i])?t:a(n)}},function(e,t,n){var r,a,i,o=n(47),u=n(635),s=n(236),l=n(162),c=n(21),f=c.process,d=c.setImmediate,h=c.clearImmediate,_=c.MessageChannel,p=c.Dispatch,v=0,E={},g=function(){var e=+this;if(E.hasOwnProperty(e)){var t=E[e];delete E[e],t()}},m=function(e){g.call(e.data)};d&&h||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return E[++v]=function(){u("function"==typeof e?e:Function(e),t)},r(v),v},h=function(e){delete E[e]},"process"==n(94)(f)?r=function(e){f.nextTick(o(g,e,1))}:p&&p.now?r=function(e){p.now(o(g,e,1))}:_?(i=(a=new _).port2,a.port1.onmessage=m,r=o(i.postMessage,i,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(r=function(e){c.postMessage(e+"","*")},c.addEventListener("message",m,!1)):r="onreadystatechange"in l("script")?function(e){s.appendChild(l("script")).onreadystatechange=function(){s.removeChild(this),g.call(e)}}:function(e){setTimeout(o(g,e,1),0)}),e.exports={set:d,clear:h}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var r=n(44),a=n(24),i=n(193);e.exports=function(e,t){if(r(e),a(t)&&t.constructor===e)return t;var n=i.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(272)),a=d(n(100)),i=d(n(1)),o=d(n(2)),u=d(n(102)),s=n(18),l=n(56),c=d(n(194)),f=n(191);function d(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,n,r){(0,i.default)(this,e),this._method=t,this._url=n,this._retryCount=0,this._aborted=!1,this._options=c.default.merge({responseType:e.ResponseTypes.JSON,validStatusCodes:[].concat((0,a.default)((0,l.range)(200,206)),[304]),timeout:0,retry:0,retryDelay:0,withCredentials:!1,headers:{},events:{onprogress:f.noop}},r)}return(0,o.default)(e,[{key:"send",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new r.default(function(n,r){(function e(){var a=this;this._send(t).then(function(e){n(e)}).catch(function(t){a._retryCount!==a._options.retry?(a._retryCount++,(0,s.createTimeout)(function(){a._init(),e.call(a)},a._options.retryDelay)):r(t)})}).call(e)})}},{key:"abort",value:function(){throw new TypeError('Cannot call abstract method "abort"')}},{key:"_send",value:function(e){throw new TypeError('Cannot call abstract method "_send"')}},{key:"_init",value:function(){throw new TypeError('Cannot call abstract method "_init"')}},{key:"isStreamroot",set:function(e){this._isStreamrootEndpoint=e}}]),e}();h.Methods=u.default.Methods,h.ResponseTypes=u.default.ResponseTypes,h.ReadyStates=u.default.ReadyStates,h.Errors=u.default.Errors,t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(72)),o=s(n(3)),u=n(18);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n){(0,r.default)(this,e),this._sharedState=t,this._partialSegment=n,this._eventEmitter=new i.default}return(0,a.default)(e,[{key:"once",value:function(e,t){this._eventEmitter.once(e,t)}},{key:"_emit",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];(t=this._eventEmitter).emit.apply(t,[e].concat(r)),this.removeAllListeners()}},{key:"removeAllListeners",value:function(){this._eventEmitter.removeAllListeners()}},{key:"fillSegment",value:function(e){var t=this;try{this._partialSegment.getFullSegment(e,this._onSegmentFillSuccess.bind(this),this._onSegmentFillError.bind(this))}catch(e){return void this._onSegmentFillError(e)}this._sharedState.conf.TIMEOUT_GET_FULL_SEGMENT>0&&(0,u.createTimeout)(function(){t._onSegmentFillError()},this._sharedState.conf.TIMEOUT_GET_FULL_SEGMENT)}},{key:"_onSegmentFillSuccess",value:function(e){this._emit(o.default.SegmentFiller.SUCCESS,e)}},{key:"_onSegmentFillError",value:function(e){this._emit(o.default.SegmentFiller.FALLBACK,e)}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this._providers={}}return(0,a.default)(e,[{key:"registerProvider",value:function(e,t){this._providers[e]=t}},{key:"getStat",value:function(e){var t=this._providers[e];if(t)return t()}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){(0,r.default)(this,e),this._maxSize=t,this._internalQueue=[]}return(0,a.default)(e,[{key:"addSample",value:function(e){this._internalQueue.length>=this._maxSize&&this._internalQueue.shift(),this._internalQueue.push(e)}},{key:"fetchSample",value:function(){if(this._internalQueue.length>0){var e=Math.floor(Math.random()*this._internalQueue.length);return this._internalQueue.splice(e,1)[0]}}},{key:"mean",get:function(){return this.length>0?this._internalQueue.reduce(function(e,t){return e+t})/this.length:0}},{key:"length",get:function(){return this._internalQueue.length}},{key:"sampleList",get:function(){return this._internalQueue}}]),e}();t.default=o},function(e,t,n){n(282),e.exports=n(484)},function(e,t,n){"use strict";(function(e){if(n(283),n(480),n(481),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var t="defineProperty";function r(e,n,r){e[n]||Object[t](e,n,{writable:!0,configurable:!0,value:r})}r(String.prototype,"padLeft","".padStart),r(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&r(Array,e,Function.call.bind([][e]))})}).call(this,n(104))},function(e,t,n){n(284),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(364),n(365),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(387),n(156),n(388),n(389),n(215),n(390),n(391),n(392),n(393),n(394),n(218),n(220),n(221),n(395),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(462),n(463),n(464),n(465),n(466),n(467),n(468),n(469),n(470),n(471),n(472),n(473),n(474),n(475),n(476),n(477),n(478),n(479),e.exports=n(32)},function(e,t,n){"use strict";var r=n(5),a=n(28),i=n(14),o=n(0),u=n(26),s=n(49).KEY,l=n(6),c=n(105),f=n(73),d=n(58),h=n(9),_=n(198),p=n(136),v=n(285),E=n(108),g=n(4),m=n(7),S=n(29),y=n(39),T=n(57),A=n(61),C=n(201),D=n(30),P=n(15),R=n(59),w=D.f,O=P.f,I=C.f,k=r.Symbol,N=r.JSON,M=N&&N.stringify,b=h("_hidden"),L=h("toPrimitive"),U={}.propertyIsEnumerable,x=c("symbol-registry"),F=c("symbols"),B=c("op-symbols"),H=Object.prototype,G="function"==typeof k,j=r.QObject,V=!j||!j.prototype||!j.prototype.findChild,q=i&&l(function(){return 7!=A(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=w(H,t);r&&delete H[t],O(e,t,n),r&&e!==H&&O(H,t,r)}:O,W=function(e){var t=F[e]=A(k.prototype);return t._k=e,t},K=G&&"symbol"==typeof k.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof k},Y=function(e,t,n){return e===H&&Y(B,t,n),g(e),t=y(t,!0),g(n),a(F,t)?(n.enumerable?(a(e,b)&&e[b][t]&&(e[b][t]=!1),n=A(n,{enumerable:T(0,!1)})):(a(e,b)||O(e,b,T(1,{})),e[b][t]=!0),q(e,t,n)):O(e,t,n)},X=function(e,t){g(e);for(var n,r=v(t=S(t)),a=0,i=r.length;i>a;)Y(e,n=r[a++],t[n]);return e},z=function(e){var t=U.call(this,e=y(e,!0));return!(this===H&&a(F,e)&&!a(B,e))&&(!(t||!a(this,e)||!a(F,e)||a(this,b)&&this[b][e])||t)},Q=function(e,t){if(e=S(e),t=y(t,!0),e!==H||!a(F,t)||a(B,t)){var n=w(e,t);return!n||!a(F,t)||a(e,b)&&e[b][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=I(S(e)),r=[],i=0;n.length>i;)a(F,t=n[i++])||t==b||t==s||r.push(t);return r},$=function(e){for(var t,n=e===H,r=I(n?B:S(e)),i=[],o=0;r.length>o;)!a(F,t=r[o++])||n&&!a(H,t)||i.push(F[t]);return i};G||(u((k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(n){this===H&&t.call(B,n),a(this,b)&&a(this[b],e)&&(this[b][e]=!1),q(this,e,T(1,n))};return i&&V&&q(H,e,{configurable:!0,set:t}),W(e)}).prototype,"toString",function(){return this._k}),D.f=Q,P.f=Y,n(62).f=C.f=Z,n(88).f=z,n(107).f=$,i&&!n(50)&&u(H,"propertyIsEnumerable",z,!0),_.f=function(e){return W(h(e))}),o(o.G+o.W+o.F*!G,{Symbol:k});for(var J="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;J.length>ee;)h(J[ee++]);for(var te=R(h.store),ne=0;te.length>ne;)p(te[ne++]);o(o.S+o.F*!G,"Symbol",{for:function(e){return a(x,e+="")?x[e]:x[e]=k(e)},keyFor:function(e){if(!K(e))throw TypeError(e+" is not a symbol!");for(var t in x)if(x[t]===e)return t},useSetter:function(){V=!0},useSimple:function(){V=!1}}),o(o.S+o.F*!G,"Object",{create:function(e,t){return void 0===t?A(e):X(A(e),t)},defineProperty:Y,defineProperties:X,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:$}),N&&o(o.S+o.F*(!G||l(function(){var e=k();return"[null]"!=M([e])||"{}"!=M({a:e})||"{}"!=M(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],a=1;arguments.length>a;)r.push(arguments[a++]);if(n=t=r[1],(m(t)||void 0!==e)&&!K(e))return E(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!K(t))return t}),r[1]=t,M.apply(N,r)}}),k.prototype[L]||n(25)(k.prototype,L,k.prototype.valueOf),f(k,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){var r=n(59),a=n(107),i=n(88);e.exports=function(e){var t=r(e),n=a.f;if(n)for(var o,u=n(e),s=i.f,l=0;u.length>l;)s.call(e,o=u[l++])&&t.push(o);return t}},function(e,t,n){var r=n(0);r(r.S,"Object",{create:n(61)})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(14),"Object",{defineProperty:n(15).f})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(14),"Object",{defineProperties:n(200)})},function(e,t,n){var r=n(29),a=n(30).f;n(42)("getOwnPropertyDescriptor",function(){return function(e,t){return a(r(e),t)}})},function(e,t,n){var r=n(19),a=n(31);n(42)("getPrototypeOf",function(){return function(e){return a(r(e))}})},function(e,t,n){var r=n(19),a=n(59);n(42)("keys",function(){return function(e){return a(r(e))}})},function(e,t,n){n(42)("getOwnPropertyNames",function(){return n(201).f})},function(e,t,n){var r=n(7),a=n(49).onFreeze;n(42)("freeze",function(e){return function(t){return e&&r(t)?e(a(t)):t}})},function(e,t,n){var r=n(7),a=n(49).onFreeze;n(42)("seal",function(e){return function(t){return e&&r(t)?e(a(t)):t}})},function(e,t,n){var r=n(7),a=n(49).onFreeze;n(42)("preventExtensions",function(e){return function(t){return e&&r(t)?e(a(t)):t}})},function(e,t,n){var r=n(7);n(42)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(7);n(42)("isSealed",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){var r=n(7);n(42)("isExtensible",function(e){return function(t){return!!r(t)&&(!e||e(t))}})},function(e,t,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(202)})},function(e,t,n){var r=n(0);r(r.S,"Object",{is:n(301)})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(140).set})},function(e,t,n){"use strict";var r=n(89),a={};a[n(9)("toStringTag")]="z",a+""!="[object z]"&&n(26)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(e,t,n){var r=n(0);r(r.P,"Function",{bind:n(203)})},function(e,t,n){var r=n(15).f,a=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in a||n(14)&&r(a,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(7),a=n(31),i=n(9)("hasInstance"),o=Function.prototype;i in o||n(15).f(o,i,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=a(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(0),a=n(205);r(r.G+r.F*(parseInt!=a),{parseInt:a})},function(e,t,n){var r=n(0),a=n(206);r(r.G+r.F*(parseFloat!=a),{parseFloat:a})},function(e,t,n){"use strict";var r=n(5),a=n(28),i=n(34),o=n(142),u=n(39),s=n(6),l=n(62).f,c=n(30).f,f=n(15).f,d=n(74).trim,h=r.Number,_=h,p=h.prototype,v="Number"==i(n(61)(p)),E="trim"in String.prototype,g=function(e){var t=u(e,!1);if("string"==typeof t&&t.length>2){var n,r,a,i=(t=E?t.trim():d(t,3)).charCodeAt(0);if(43===i||45===i){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===i){switch(t.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+t}for(var o,s=t.slice(2),l=0,c=s.length;l<c;l++)if((o=s.charCodeAt(l))<48||o>a)return NaN;return parseInt(s,r)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof h&&(v?s(function(){p.valueOf.call(n)}):"Number"!=i(n))?o(new _(g(t)),n,h):g(t)};for(var m,S=n(14)?l(_):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),y=0;S.length>y;y++)a(_,m=S[y])&&!a(h,m)&&f(h,m,c(_,m));h.prototype=p,p.constructor=h,n(26)(r,"Number",h)}},function(e,t,n){"use strict";var r=n(0),a=n(41),i=n(207),o=n(143),u=1..toFixed,s=Math.floor,l=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",f=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*l[n],l[n]=r%1e7,r=s(r/1e7)},d=function(e){for(var t=6,n=0;--t>=0;)n+=l[t],l[t]=s(n/e),n=n%e*1e7},h=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==l[e]){var n=String(l[e]);t=""===t?n:t+o.call("0",7-n.length)+n}return t},_=function(e,t,n){return 0===t?n:t%2==1?_(e,t-1,n*e):_(e*e,t/2,n)};r(r.P+r.F*(!!u&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(6)(function(){u.call({})})),"Number",{toFixed:function(e){var t,n,r,u,s=i(this,c),l=a(e),p="",v="0";if(l<0||l>20)throw RangeError(c);if(s!=s)return"NaN";if(s<=-1e21||s>=1e21)return String(s);if(s<0&&(p="-",s=-s),s>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(s*_(2,69,1))-69)<0?s*_(2,-t,1):s/_(2,t,1),n*=4503599627370496,(t=52-t)>0){for(f(0,n),r=l;r>=7;)f(1e7,0),r-=7;for(f(_(10,r,1),0),r=t-1;r>=23;)d(1<<23),r-=23;d(1<<r),f(1,1),d(2),v=h()}else f(0,n),f(1<<-t,0),v=h()+o.call("0",l);return v=l>0?p+((u=v.length)<=l?"0."+o.call("0",l-u)+v:v.slice(0,u-l)+"."+v.slice(u-l)):p+v}})},function(e,t,n){"use strict";var r=n(0),a=n(6),i=n(207),o=1..toPrecision;r(r.P+r.F*(a(function(){return"1"!==o.call(1,void 0)})||!a(function(){o.call({})})),"Number",{toPrecision:function(e){var t=i(this,"Number#toPrecision: incorrect invocation!");return void 0===e?o.call(t):o.call(t,e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(0),a=n(5).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&a(e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{isInteger:n(208)})},function(e,t,n){var r=n(0);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(0),a=n(208),i=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return a(e)&&i(e)<=9007199254740991}})},function(e,t,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(0),a=n(206);r(r.S+r.F*(Number.parseFloat!=a),"Number",{parseFloat:a})},function(e,t,n){var r=n(0),a=n(205);r(r.S+r.F*(Number.parseInt!=a),"Number",{parseInt:a})},function(e,t,n){var r=n(0),a=n(209),i=Math.sqrt,o=Math.acosh;r(r.S+r.F*!(o&&710==Math.floor(o(Number.MAX_VALUE))&&o(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:a(e-1+i(e-1)*i(e+1))}})},function(e,t,n){var r=n(0),a=Math.asinh;r(r.S+r.F*!(a&&1/a(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,n){var r=n(0),a=Math.atanh;r(r.S+r.F*!(a&&1/a(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(0),a=n(144);r(r.S,"Math",{cbrt:function(e){return a(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(0),a=Math.exp;r(r.S,"Math",{cosh:function(e){return(a(e=+e)+a(-e))/2}})},function(e,t,n){var r=n(0),a=n(145);r(r.S+r.F*(a!=Math.expm1),"Math",{expm1:a})},function(e,t,n){var r=n(0);r(r.S,"Math",{fround:n(210)})},function(e,t,n){var r=n(0),a=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,i=0,o=0,u=arguments.length,s=0;o<u;)s<(n=a(arguments[o++]))?(i=i*(r=s/n)*r+1,s=n):i+=n>0?(r=n/s)*r:n;return s===1/0?1/0:s*Math.sqrt(i)}})},function(e,t,n){var r=n(0),a=Math.imul;r(r.S+r.F*n(6)(function(){return-5!=a(4294967295,5)||2!=a.length}),"Math",{imul:function(e,t){var n=+e,r=+t,a=65535&n,i=65535&r;return 0|a*i+((65535&n>>>16)*i+a*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log1p:n(209)})},function(e,t,n){var r=n(0);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(0);r(r.S,"Math",{sign:n(144)})},function(e,t,n){var r=n(0),a=n(145),i=Math.exp;r(r.S+r.F*n(6)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(a(e)-a(-e))/2:(i(e-1)-i(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(0),a=n(145),i=Math.exp;r(r.S,"Math",{tanh:function(e){var t=a(e=+e),n=a(-e);return t==1/0?1:n==1/0?-1:(t-n)/(i(e)+i(-e))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var r=n(0),a=n(60),i=String.fromCharCode,o=String.fromCodePoint;r(r.S+r.F*(!!o&&1!=o.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,o=0;r>o;){if(t=+arguments[o++],a(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?i(t):i(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(0),a=n(29),i=n(16);r(r.S,"String",{raw:function(e){for(var t=a(e.raw),n=i(t.length),r=arguments.length,o=[],u=0;n>u;)o.push(String(t[u++])),u<r&&o.push(String(arguments[u]));return o.join("")}})},function(e,t,n){"use strict";n(74)("trim",function(e){return function(){return e(this,3)}})},function(e,t,n){"use strict";var r=n(146)(!0);n(147)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var r=n(0),a=n(146)(!1);r(r.P,"String",{codePointAt:function(e){return a(this,e)}})},function(e,t,n){"use strict";var r=n(0),a=n(16),i=n(149),o="".endsWith;r(r.P+r.F*n(150)("endsWith"),"String",{endsWith:function(e){var t=i(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=a(t.length),u=void 0===n?r:Math.min(a(n),r),s=String(e);return o?o.call(t,s,u):t.slice(u-s.length,u)===s}})},function(e,t,n){"use strict";var r=n(0),a=n(149);r(r.P+r.F*n(150)("includes"),"String",{includes:function(e){return!!~a(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(0);r(r.P,"String",{repeat:n(143)})},function(e,t,n){"use strict";var r=n(0),a=n(16),i=n(149),o="".startsWith;r(r.P+r.F*n(150)("startsWith"),"String",{startsWith:function(e){var t=i(this,e,"startsWith"),n=a(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return o?o.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(27)("anchor",function(e){return function(t){return e(this,"a","name",t)}})},function(e,t,n){"use strict";n(27)("big",function(e){return function(){return e(this,"big","","")}})},function(e,t,n){"use strict";n(27)("blink",function(e){return function(){return e(this,"blink","","")}})},function(e,t,n){"use strict";n(27)("bold",function(e){return function(){return e(this,"b","","")}})},function(e,t,n){"use strict";n(27)("fixed",function(e){return function(){return e(this,"tt","","")}})},function(e,t,n){"use strict";n(27)("fontcolor",function(e){return function(t){return e(this,"font","color",t)}})},function(e,t,n){"use strict";n(27)("fontsize",function(e){return function(t){return e(this,"font","size",t)}})},function(e,t,n){"use strict";n(27)("italics",function(e){return function(){return e(this,"i","","")}})},function(e,t,n){"use strict";n(27)("link",function(e){return function(t){return e(this,"a","href",t)}})},function(e,t,n){"use strict";n(27)("small",function(e){return function(){return e(this,"small","","")}})},function(e,t,n){"use strict";n(27)("strike",function(e){return function(){return e(this,"strike","","")}})},function(e,t,n){"use strict";n(27)("sub",function(e){return function(){return e(this,"sub","","")}})},function(e,t,n){"use strict";n(27)("sup",function(e){return function(){return e(this,"sup","","")}})},function(e,t,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(0),a=n(19),i=n(39);r(r.P+r.F*n(6)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=a(this),n=i(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(0),a=n(363);r(r.P+r.F*(Date.prototype.toISOString!==a),"Date",{toISOString:a})},function(e,t,n){"use strict";var r=n(6),a=Date.prototype.getTime,i=Date.prototype.toISOString,o=function(e){return e>9?e:"0"+e};e.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=i.call(new Date(-5e13-1))})||!r(function(){i.call(new Date(NaN))})?function(){if(!isFinite(a.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+o(e.getUTCMonth()+1)+"-"+o(e.getUTCDate())+"T"+o(e.getUTCHours())+":"+o(e.getUTCMinutes())+":"+o(e.getUTCSeconds())+"."+(n>99?n:"0"+o(n))+"Z"}:i},function(e,t,n){var r=Date.prototype,a=r.toString,i=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(26)(r,"toString",function(){var e=i.call(this);return e==e?a.call(this):"Invalid Date"})},function(e,t,n){var r=n(9)("toPrimitive"),a=Date.prototype;r in a||n(25)(a,r,n(366))},function(e,t,n){"use strict";var r=n(4),a=n(39);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return a(r(this),"number"!=e)}},function(e,t,n){var r=n(0);r(r.S,"Array",{isArray:n(108)})},function(e,t,n){"use strict";var r=n(33),a=n(0),i=n(19),o=n(211),u=n(151),s=n(16),l=n(152),c=n(153);a(a.S+a.F*!n(110)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,a,f,d=i(e),h="function"==typeof this?this:Array,_=arguments.length,p=_>1?arguments[1]:void 0,v=void 0!==p,E=0,g=c(d);if(v&&(p=r(p,_>2?arguments[2]:void 0,2)),void 0==g||h==Array&&u(g))for(n=new h(t=s(d.length));t>E;E++)l(n,E,v?p(d[E],E):d[E]);else for(f=g.call(d),n=new h;!(a=f.next()).done;E++)l(n,E,v?o(f,p,[a.value,E],!0):a.value);return n.length=E,n}})},function(e,t,n){"use strict";var r=n(0),a=n(152);r(r.S+r.F*n(6)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)a(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(0),a=n(29),i=[].join;r(r.P+r.F*(n(87)!=Object||!n(35)(i)),"Array",{join:function(e){return i.call(a(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(0),a=n(139),i=n(34),o=n(60),u=n(16),s=[].slice;r(r.P+r.F*n(6)(function(){a&&s.call(a)}),"Array",{slice:function(e,t){var n=u(this.length),r=i(this);if(t=void 0===t?n:t,"Array"==r)return s.call(this,e,t);for(var a=o(e,n),l=o(t,n),c=u(l-a),f=new Array(c),d=0;d<c;d++)f[d]="String"==r?this.charAt(a+d):this[a+d];return f}})},function(e,t,n){"use strict";var r=n(0),a=n(22),i=n(19),o=n(6),u=[].sort,s=[1,2,3];r(r.P+r.F*(o(function(){s.sort(void 0)})||!o(function(){s.sort(null)})||!n(35)(u)),"Array",{sort:function(e){return void 0===e?u.call(i(this)):u.call(i(this),a(e))}})},function(e,t,n){"use strict";var r=n(0),a=n(43)(0),i=n(35)([].forEach,!0);r(r.P+r.F*!i,"Array",{forEach:function(e){return a(this,e,arguments[1])}})},function(e,t,n){var r=n(7),a=n(108),i=n(9)("species");e.exports=function(e){var t;return a(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!a(t.prototype)||(t=void 0),r(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(0),a=n(43)(1);r(r.P+r.F*!n(35)([].map,!0),"Array",{map:function(e){return a(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),a=n(43)(2);r(r.P+r.F*!n(35)([].filter,!0),"Array",{filter:function(e){return a(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),a=n(43)(3);r(r.P+r.F*!n(35)([].some,!0),"Array",{some:function(e){return a(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),a=n(43)(4);r(r.P+r.F*!n(35)([].every,!0),"Array",{every:function(e){return a(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),a=n(212);r(r.P+r.F*!n(35)([].reduce,!0),"Array",{reduce:function(e){return a(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(0),a=n(212);r(r.P+r.F*!n(35)([].reduceRight,!0),"Array",{reduceRight:function(e){return a(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(0),a=n(106)(!1),i=[].indexOf,o=!!i&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(o||!n(35)(i)),"Array",{indexOf:function(e){return o?i.apply(this,arguments)||0:a(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),a=n(29),i=n(41),o=n(16),u=[].lastIndexOf,s=!!u&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(s||!n(35)(u)),"Array",{lastIndexOf:function(e){if(s)return u.apply(this,arguments)||0;var t=a(this),n=o(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,i(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(0);r(r.P,"Array",{copyWithin:n(213)}),n(51)("copyWithin")},function(e,t,n){var r=n(0);r(r.P,"Array",{fill:n(155)}),n(51)("fill")},function(e,t,n){"use strict";var r=n(0),a=n(43)(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),r(r.P+r.F*i,"Array",{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(51)("find")},function(e,t,n){"use strict";var r=n(0),a=n(43)(6),i="findIndex",o=!0;i in[]&&Array(1)[i](function(){o=!1}),r(r.P+r.F*o,"Array",{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(51)(i)},function(e,t,n){n(63)("Array")},function(e,t,n){var r=n(5),a=n(142),i=n(15).f,o=n(62).f,u=n(109),s=n(111),l=r.RegExp,c=l,f=l.prototype,d=/a/g,h=/a/g,_=new l(d)!==d;if(n(14)&&(!_||n(6)(function(){return h[n(9)("match")]=!1,l(d)!=d||l(h)==h||"/a/i"!=l(d,"i")}))){l=function(e,t){var n=this instanceof l,r=u(e),i=void 0===t;return!n&&r&&e.constructor===l&&i?e:a(_?new c(r&&!i?e.source:e,t):c((r=e instanceof l)?e.source:e,r&&i?s.call(e):t),n?this:f,l)};for(var p=function(e){e in l||i(l,e,{configurable:!0,get:function(){return c[e]},set:function(t){c[e]=t}})},v=o(c),E=0;v.length>E;)p(v[E++]);f.constructor=l,l.prototype=f,n(26)(r,"RegExp",l)}n(63)("RegExp")},function(e,t,n){"use strict";n(215);var r=n(4),a=n(111),i=n(14),o=/./.toString,u=function(e){n(26)(RegExp.prototype,"toString",e,!0)};n(6)(function(){return"/a/b"!=o.call({source:"a",flags:"b"})})?u(function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!i&&e instanceof RegExp?a.call(e):void 0)}):"toString"!=o.name&&u(function(){return o.call(this)})},function(e,t,n){n(112)("match",1,function(e,t,n){return[function(n){"use strict";var r=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){n(112)("replace",2,function(e,t,n){return[function(r,a){"use strict";var i=e(this),o=void 0==r?void 0:r[t];return void 0!==o?o.call(r,i,a):n.call(String(i),r,a)},n]})},function(e,t,n){n(112)("search",1,function(e,t,n){return[function(n){"use strict";var r=e(this),a=void 0==n?void 0:n[t];return void 0!==a?a.call(n,r):new RegExp(n)[t](String(r))},n]})},function(e,t,n){n(112)("split",2,function(e,t,r){"use strict";var a=n(109),i=r,o=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var u=void 0===/()??/.exec("")[1];r=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!a(e))return i.call(n,e,t);var r,s,l,c,f,d=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),_=0,p=void 0===t?4294967295:t>>>0,v=new RegExp(e.source,h+"g");for(u||(r=new RegExp("^"+v.source+"$(?!\\s)",h));(s=v.exec(n))&&!((l=s.index+s[0].length)>_&&(d.push(n.slice(_,s.index)),!u&&s.length>1&&s[0].replace(r,function(){for(f=1;f<arguments.length-2;f++)void 0===arguments[f]&&(s[f]=void 0)}),s.length>1&&s.index<n.length&&o.apply(d,s.slice(1)),c=s[0].length,_=l,d.length>=p));)v.lastIndex===s.index&&v.lastIndex++;return _===n.length?!c&&v.test("")||d.push(""):d.push(n.slice(_)),d.length>p?d.slice(0,p):d}}else"0".split(void 0,0).length&&(r=function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)});return[function(n,a){var i=e(this),o=void 0==n?void 0:n[t];return void 0!==o?o.call(n,i,a):r.call(String(i),n,a)},r]})},function(e,t,n){"use strict";var r,a,i,o,u=n(50),s=n(5),l=n(33),c=n(89),f=n(0),d=n(7),h=n(22),_=n(64),p=n(65),v=n(113),E=n(157).set,g=n(158)(),m=n(159),S=n(216),y=n(114),T=n(217),A=s.TypeError,C=s.process,D=C&&C.versions,P=D&&D.v8||"",R=s.Promise,w="process"==c(C),O=function(){},I=a=m.f,k=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[n(9)("species")]=function(e){e(O,O)};return(w||"function"==typeof PromiseRejectionEvent)&&e.then(O)instanceof t&&0!==P.indexOf("6.6")&&-1===y.indexOf("Chrome/66")}catch(e){}}(),N=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;g(function(){for(var r=e._v,a=1==e._s,i=0,o=function(t){var n,i,o,u=a?t.ok:t.fail,s=t.resolve,l=t.reject,c=t.domain;try{u?(a||(2==e._h&&U(e),e._h=1),!0===u?n=r:(c&&c.enter(),n=u(r),c&&(c.exit(),o=!0)),n===t.promise?l(A("Promise-chain cycle")):(i=N(n))?i.call(n,s,l):s(n)):l(r)}catch(e){c&&!o&&c.exit(),l(e)}};n.length>i;)o(n[i++]);e._c=[],e._n=!1,t&&!e._h&&b(e)})}},b=function(e){E.call(s,function(){var t,n,r,a=e._v,i=L(e);if(i&&(t=S(function(){w?C.emit("unhandledRejection",a,e):(n=s.onunhandledrejection)?n({promise:e,reason:a}):(r=s.console)&&r.error&&r.error("Unhandled promise rejection",a)}),e._h=w||L(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},U=function(e){E.call(s,function(){var t;w?C.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})})},x=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw A("Promise can't be resolved itself");(t=N(e))?g(function(){var r={_w:n,_d:!1};try{t.call(e,l(F,r,1),l(x,r,1))}catch(e){x.call(r,e)}}):(n._v=e,n._s=1,M(n,!1))}catch(e){x.call({_w:n,_d:!1},e)}}};k||(R=function(e){_(this,R,"Promise","_h"),h(e),r.call(this);try{e(l(F,this,1),l(x,this,1))}catch(e){x.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(66)(R.prototype,{then:function(e,t){var n=I(v(this,R));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=w?C.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=l(F,e,1),this.reject=l(x,e,1)},m.f=I=function(e){return e===R||e===o?new i(e):a(e)}),f(f.G+f.W+f.F*!k,{Promise:R}),n(73)(R,"Promise"),n(63)("Promise"),o=n(32).Promise,f(f.S+f.F*!k,"Promise",{reject:function(e){var t=I(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(u||!k),"Promise",{resolve:function(e){return T(u&&this===o?R:this,e)}}),f(f.S+f.F*!(k&&n(110)(function(e){R.all(e).catch(O)})),"Promise",{all:function(e){var t=this,n=I(t),r=n.resolve,a=n.reject,i=S(function(){var n=[],i=0,o=1;p(e,!1,function(e){var u=i++,s=!1;n.push(void 0),o++,t.resolve(e).then(function(e){s||(s=!0,n[u]=e,--o||r(n))},a)}),--o||r(n)});return i.e&&a(i.v),n.promise},race:function(e){var t=this,n=I(t),r=n.reject,a=S(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return a.e&&r(a.v),n.promise}})},function(e,t,n){"use strict";var r=n(222),a=n(76);n(115)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(a(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(0),a=n(116),i=n(160),o=n(4),u=n(60),s=n(16),l=n(7),c=n(5).ArrayBuffer,f=n(113),d=i.ArrayBuffer,h=i.DataView,_=a.ABV&&c.isView,p=d.prototype.slice,v=a.VIEW;r(r.G+r.W+r.F*(c!==d),{ArrayBuffer:d}),r(r.S+r.F*!a.CONSTR,"ArrayBuffer",{isView:function(e){return _&&_(e)||l(e)&&v in e}}),r(r.P+r.U+r.F*n(6)(function(){return!new d(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==p&&void 0===t)return p.call(o(this),e);for(var n=o(this).byteLength,r=u(e,n),a=u(void 0===t?n:t,n),i=new(f(this,d))(s(a-r)),l=new h(this),c=new h(i),_=0;r<a;)c.setUint8(_++,l.getUint8(r++));return i}}),n(63)("ArrayBuffer")},function(e,t,n){var r=n(0);r(r.G+r.W+r.F*!n(116).ABV,{DataView:n(160).DataView})},function(e,t,n){n(45)("Int8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(45)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(45)("Uint8",1,function(e){return function(t,n,r){return e(this,t,n,r)}},!0)},function(e,t,n){n(45)("Int16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(45)("Uint16",2,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(45)("Int32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(45)("Uint32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(45)("Float32",4,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){n(45)("Float64",8,function(e){return function(t,n,r){return e(this,t,n,r)}})},function(e,t,n){var r=n(0),a=n(22),i=n(4),o=(n(5).Reflect||{}).apply,u=Function.apply;r(r.S+r.F*!n(6)(function(){o(function(){})}),"Reflect",{apply:function(e,t,n){var r=a(e),s=i(n);return o?o(r,t,s):u.call(r,t,s)}})},function(e,t,n){var r=n(0),a=n(61),i=n(22),o=n(4),u=n(7),s=n(6),l=n(203),c=(n(5).Reflect||{}).construct,f=s(function(){function e(){}return!(c(function(){},[],e)instanceof e)}),d=!s(function(){c(function(){})});r(r.S+r.F*(f||d),"Reflect",{construct:function(e,t){i(e),o(t);var n=arguments.length<3?e:i(arguments[2]);if(d&&!f)return c(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(l.apply(e,r))}var s=n.prototype,h=a(u(s)?s:Object.prototype),_=Function.apply.call(e,h,t);return u(_)?_:h}})},function(e,t,n){var r=n(15),a=n(0),i=n(4),o=n(39);a(a.S+a.F*n(6)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){i(e),t=o(t,!0),i(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(0),a=n(30).f,i=n(4);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=a(i(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(0),a=n(4),i=function(e){this._t=a(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(148)(i,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),r(r.S,"Reflect",{enumerate:function(e){return new i(e)}})},function(e,t,n){var r=n(30),a=n(31),i=n(28),o=n(0),u=n(7),s=n(4);o(o.S,"Reflect",{get:function e(t,n){var o,l,c=arguments.length<3?t:arguments[2];return s(t)===c?t[n]:(o=r.f(t,n))?i(o,"value")?o.value:void 0!==o.get?o.get.call(c):void 0:u(l=a(t))?e(l,n,c):void 0}})},function(e,t,n){var r=n(30),a=n(0),i=n(4);a(a.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(i(e),t)}})},function(e,t,n){var r=n(0),a=n(31),i=n(4);r(r.S,"Reflect",{getPrototypeOf:function(e){return a(i(e))}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var r=n(0),a=n(4),i=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return a(e),!i||i(e)}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(224)})},function(e,t,n){var r=n(0),a=n(4),i=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){a(e);try{return i&&i(e),!0}catch(e){return!1}}})},function(e,t,n){var r=n(15),a=n(30),i=n(31),o=n(28),u=n(0),s=n(57),l=n(4),c=n(7);u(u.S,"Reflect",{set:function e(t,n,u){var f,d,h=arguments.length<4?t:arguments[3],_=a.f(l(t),n);if(!_){if(c(d=i(t)))return e(d,n,u,h);_=s(0)}if(o(_,"value")){if(!1===_.writable||!c(h))return!1;if(f=a.f(h,n)){if(f.get||f.set||!1===f.writable)return!1;f.value=u,r.f(h,n,f)}else r.f(h,n,s(0,u));return!0}return void 0!==_.set&&(_.set.call(h,u),!0)}})},function(e,t,n){var r=n(0),a=n(140);a&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){a.check(e,t);try{return a.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){"use strict";var r=n(0),a=n(106)(!0);r(r.P,"Array",{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),n(51)("includes")},function(e,t,n){"use strict";var r=n(0),a=n(225),i=n(19),o=n(16),u=n(22),s=n(154);r(r.P,"Array",{flatMap:function(e){var t,n,r=i(this);return u(e),t=o(r.length),n=s(r,0),a(n,r,r,t,0,1,e,arguments[1]),n}}),n(51)("flatMap")},function(e,t,n){"use strict";var r=n(0),a=n(225),i=n(19),o=n(16),u=n(41),s=n(154);r(r.P,"Array",{flatten:function(){var e=arguments[0],t=i(this),n=o(t.length),r=s(t,0);return a(r,t,t,n,0,void 0===e?1:u(e)),r}}),n(51)("flatten")},function(e,t,n){"use strict";var r=n(0),a=n(146)(!0);r(r.P,"String",{at:function(e){return a(this,e)}})},function(e,t,n){"use strict";var r=n(0),a=n(226),i=n(114);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(i),"String",{padStart:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";var r=n(0),a=n(226),i=n(114);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(i),"String",{padEnd:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";n(74)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},function(e,t,n){"use strict";n(74)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},function(e,t,n){"use strict";var r=n(0),a=n(40),i=n(16),o=n(109),u=n(111),s=RegExp.prototype,l=function(e,t){this._r=e,this._s=t};n(148)(l,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),r(r.P,"String",{matchAll:function(e){if(a(this),!o(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in s?String(e.flags):u.call(e),r=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=i(e.lastIndex),new l(r,t)}})},function(e,t,n){n(136)("asyncIterator")},function(e,t,n){n(136)("observable")},function(e,t,n){var r=n(0),a=n(224),i=n(29),o=n(30),u=n(152);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=i(e),s=o.f,l=a(r),c={},f=0;l.length>f;)void 0!==(n=s(r,t=l[f++]))&&u(c,t,n);return c}})},function(e,t,n){var r=n(0),a=n(227)(!1);r(r.S,"Object",{values:function(e){return a(e)}})},function(e,t,n){var r=n(0),a=n(227)(!0);r(r.S,"Object",{entries:function(e){return a(e)}})},function(e,t,n){"use strict";var r=n(0),a=n(19),i=n(22),o=n(15);n(14)&&r(r.P+n(117),"Object",{__defineGetter__:function(e,t){o.f(a(this),e,{get:i(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(0),a=n(19),i=n(22),o=n(15);n(14)&&r(r.P+n(117),"Object",{__defineSetter__:function(e,t){o.f(a(this),e,{set:i(t),enumerable:!0,configurable:!0})}})},function(e,t,n){"use strict";var r=n(0),a=n(19),i=n(39),o=n(31),u=n(30).f;n(14)&&r(r.P+n(117),"Object",{__lookupGetter__:function(e){var t,n=a(this),r=i(e,!0);do{if(t=u(n,r))return t.get}while(n=o(n))}})},function(e,t,n){"use strict";var r=n(0),a=n(19),i=n(39),o=n(31),u=n(30).f;n(14)&&r(r.P+n(117),"Object",{__lookupSetter__:function(e){var t,n=a(this),r=i(e,!0);do{if(t=u(n,r))return t.set}while(n=o(n))}})},function(e,t,n){var r=n(0);r(r.P+r.R,"Map",{toJSON:n(228)("Map")})},function(e,t,n){var r=n(0);r(r.P+r.R,"Set",{toJSON:n(228)("Set")})},function(e,t,n){n(118)("Map")},function(e,t,n){n(118)("Set")},function(e,t,n){n(118)("WeakMap")},function(e,t,n){n(118)("WeakSet")},function(e,t,n){n(119)("Map")},function(e,t,n){n(119)("Set")},function(e,t,n){n(119)("WeakMap")},function(e,t,n){n(119)("WeakSet")},function(e,t,n){var r=n(0);r(r.G,{global:n(5)})},function(e,t,n){var r=n(0);r(r.S,"System",{global:n(5)})},function(e,t,n){var r=n(0),a=n(34);r(r.S,"Error",{isError:function(e){return"Error"===a(e)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,n){var r=n(0),a=180/Math.PI;r(r.S,"Math",{degrees:function(e){return e*a}})},function(e,t,n){var r=n(0),a=n(230),i=n(210);r(r.S,"Math",{fscale:function(e,t,n,r,o){return i(a(e,t,n,r,o))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{iaddh:function(e,t,n,r){var a=e>>>0,i=n>>>0;return(t>>>0)+(r>>>0)+((a&i|(a|i)&~(a+i>>>0))>>>31)|0}})},function(e,t,n){var r=n(0);r(r.S,"Math",{isubh:function(e,t,n,r){var a=e>>>0,i=n>>>0;return(t>>>0)-(r>>>0)-((~a&i|~(a^i)&a-i>>>0)>>>31)|0}})},function(e,t,n){var r=n(0);r(r.S,"Math",{imulh:function(e,t){var n=+e,r=+t,a=65535&n,i=65535&r,o=n>>16,u=r>>16,s=(o*i>>>0)+(a*i>>>16);return o*u+(s>>16)+((a*u>>>0)+(65535&s)>>16)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,n){var r=n(0),a=Math.PI/180;r(r.S,"Math",{radians:function(e){return e*a}})},function(e,t,n){var r=n(0);r(r.S,"Math",{scale:n(230)})},function(e,t,n){var r=n(0);r(r.S,"Math",{umulh:function(e,t){var n=+e,r=+t,a=65535&n,i=65535&r,o=n>>>16,u=r>>>16,s=(o*i>>>0)+(a*i>>>16);return o*u+(s>>>16)+((a*u>>>0)+(65535&s)>>>16)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},function(e,t,n){"use strict";var r=n(0),a=n(32),i=n(5),o=n(113),u=n(217);r(r.P+r.R,"Promise",{finally:function(e){var t=o(this,a.Promise||i.Promise),n="function"==typeof e;return this.then(n?function(n){return u(t,e()).then(function(){return n})}:e,n?function(n){return u(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var r=n(0),a=n(159),i=n(216);r(r.S,"Promise",{try:function(e){var t=a.f(this),n=i(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){var r=n(46),a=n(4),i=r.key,o=r.set;r.exp({defineMetadata:function(e,t,n,r){o(e,t,a(n),i(r))}})},function(e,t,n){var r=n(46),a=n(4),i=r.key,o=r.map,u=r.store;r.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:i(arguments[2]),r=o(a(t),n,!1);if(void 0===r||!r.delete(e))return!1;if(r.size)return!0;var s=u.get(t);return s.delete(n),!!s.size||u.delete(t)}})},function(e,t,n){var r=n(46),a=n(4),i=n(31),o=r.has,u=r.get,s=r.key,l=function(e,t,n){if(o(e,t,n))return u(e,t,n);var r=i(t);return null!==r?l(e,r,n):void 0};r.exp({getMetadata:function(e,t){return l(e,a(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,n){var r=n(220),a=n(229),i=n(46),o=n(4),u=n(31),s=i.keys,l=i.key,c=function(e,t){var n=s(e,t),i=u(e);if(null===i)return n;var o=c(i,t);return o.length?n.length?a(new r(n.concat(o))):o:n};i.exp({getMetadataKeys:function(e){return c(o(e),arguments.length<2?void 0:l(arguments[1]))}})},function(e,t,n){var r=n(46),a=n(4),i=r.get,o=r.key;r.exp({getOwnMetadata:function(e,t){return i(e,a(t),arguments.length<3?void 0:o(arguments[2]))}})},function(e,t,n){var r=n(46),a=n(4),i=r.keys,o=r.key;r.exp({getOwnMetadataKeys:function(e){return i(a(e),arguments.length<2?void 0:o(arguments[1]))}})},function(e,t,n){var r=n(46),a=n(4),i=n(31),o=r.has,u=r.key,s=function(e,t,n){if(o(e,t,n))return!0;var r=i(t);return null!==r&&s(e,r,n)};r.exp({hasMetadata:function(e,t){return s(e,a(t),arguments.length<3?void 0:u(arguments[2]))}})},function(e,t,n){var r=n(46),a=n(4),i=r.has,o=r.key;r.exp({hasOwnMetadata:function(e,t){return i(e,a(t),arguments.length<3?void 0:o(arguments[2]))}})},function(e,t,n){var r=n(46),a=n(4),i=n(22),o=r.key,u=r.set;r.exp({metadata:function(e,t){return function(n,r){u(e,t,(void 0!==r?a:i)(n),o(r))}}})},function(e,t,n){var r=n(0),a=n(158)(),i=n(5).process,o="process"==n(34)(i);r(r.G,{asap:function(e){var t=o&&i.domain;a(t?t.bind(e):e)}})},function(e,t,n){"use strict";var r=n(0),a=n(5),i=n(32),o=n(158)(),u=n(9)("observable"),s=n(22),l=n(4),c=n(64),f=n(66),d=n(25),h=n(65),_=h.RETURN,p=function(e){return null==e?void 0:s(e)},v=function(e){var t=e._c;t&&(e._c=void 0,t())},E=function(e){return void 0===e._o},g=function(e){E(e)||(e._o=void 0,v(e))},m=function(e,t){l(e),this._c=void 0,this._o=e,e=new S(this);try{var n=t(e),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:s(n),this._c=n)}catch(t){return void e.error(t)}E(this)&&v(this)};m.prototype=f({},{unsubscribe:function(){g(this)}});var S=function(e){this._s=e};S.prototype=f({},{next:function(e){var t=this._s;if(!E(t)){var n=t._o;try{var r=p(n.next);if(r)return r.call(n,e)}catch(e){try{g(t)}finally{throw e}}}},error:function(e){var t=this._s;if(E(t))throw e;var n=t._o;t._o=void 0;try{var r=p(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{v(t)}finally{throw e}}return v(t),e},complete:function(e){var t=this._s;if(!E(t)){var n=t._o;t._o=void 0;try{var r=p(n.complete);e=r?r.call(n,e):void 0}catch(e){try{v(t)}finally{throw e}}return v(t),e}}});var y=function(e){c(this,y,"Observable","_f")._f=s(e)};f(y.prototype,{subscribe:function(e){return new m(e,this._f)},forEach:function(e){var t=this;return new(i.Promise||a.Promise)(function(n,r){s(e);var a=t.subscribe({next:function(t){try{return e(t)}catch(e){r(e),a.unsubscribe()}},error:r,complete:n})})}}),f(y,{from:function(e){var t="function"==typeof this?this:y,n=p(l(e)[u]);if(n){var r=l(n.call(e));return r.constructor===t?r:new t(function(e){return r.subscribe(e)})}return new t(function(t){var n=!1;return o(function(){if(!n){try{if(h(e,!1,function(e){if(t.next(e),n)return _})===_)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function(){for(var e=0,t=arguments.length,n=new Array(t);e<t;)n[e]=arguments[e++];return new("function"==typeof this?this:y)(function(e){var t=!1;return o(function(){if(!t){for(var r=0;r<n.length;++r)if(e.next(n[r]),t)return;e.complete()}}),function(){t=!0}})}}),d(y.prototype,u,function(){return this}),r(r.G,{Observable:y}),n(63)("Observable")},function(e,t,n){var r=n(5),a=n(0),i=n(114),o=[].slice,u=/MSIE .\./.test(i),s=function(e){return function(t,n){var r=arguments.length>2,a=!!r&&o.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,a)}:t,n)}};a(a.G+a.B+a.F*u,{setTimeout:s(r.setTimeout),setInterval:s(r.setInterval)})},function(e,t,n){var r=n(0),a=n(157);r(r.G+r.B,{setImmediate:a.set,clearImmediate:a.clear})},function(e,t,n){for(var r=n(156),a=n(59),i=n(26),o=n(5),u=n(25),s=n(75),l=n(9),c=l("iterator"),f=l("toStringTag"),d=s.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},_=a(h),p=0;p<_.length;p++){var v,E=_[p],g=h[E],m=o[E],S=m&&m.prototype;if(S&&(S[c]||u(S,c,d),S[f]||u(S,f,E),s[E]=d,g))for(v in r)S[v]||i(S,v,r[v],!0)}},function(e,t,n){(function(t){!function(t){"use strict";var n,r=Object.prototype,a=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag",l="object"==typeof e,c=t.regeneratorRuntime;if(c)l&&(e.exports=c);else{(c=t.regeneratorRuntime=l?e.exports:{}).wrap=S;var f="suspendedStart",d="suspendedYield",h="executing",_="completed",p={},v={};v[o]=function(){return this};var E=Object.getPrototypeOf,g=E&&E(E(k([])));g&&g!==r&&a.call(g,o)&&(v=g);var m=C.prototype=T.prototype=Object.create(v);A.prototype=m.constructor=C,C.constructor=A,C[s]=A.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===A||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(m),e},c.awrap=function(e){return{__await:e}},D(P.prototype),P.prototype[u]=function(){return this},c.AsyncIterator=P,c.async=function(e,t,n,r){var a=new P(S(e,t,n,r));return c.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},D(m),m[s]="Generator",m[o]=function(){return this},m.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},c.values=k,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,a){return u.type="throw",u.arg=e,t.next=r,a&&(t.method="next",t.arg=n),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],u=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;O(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),p}}}function S(e,t,n,r){var a=t&&t.prototype instanceof T?t:T,i=Object.create(a.prototype),o=new I(r||[]);return i._invoke=function(e,t,n){var r=f;return function(a,i){if(r===h)throw new Error("Generator is already running");if(r===_){if("throw"===a)throw i;return N()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var u=R(o,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=_,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var s=y(e,t,n);if("normal"===s.type){if(r=n.done?_:d,s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=_,n.method="throw",n.arg=s.arg)}}}(e,n,o),i}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function T(){}function A(){}function C(){}function D(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function P(e){function n(t,r,i,o){var u=y(e[t],e,r);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==typeof l&&a.call(l,"__await")?Promise.resolve(l.__await).then(function(e){n("next",e,i,o)},function(e){n("throw",e,i,o)}):Promise.resolve(l).then(function(e){s.value=e,i(s)},o)}o(u.arg)}var r;"object"==typeof t.process&&t.process.domain&&(n=t.process.domain.bind(n)),this._invoke=function(e,t){function a(){return new Promise(function(r,a){n(e,t,r,a)})}return r=r?r.then(a,a):a()}}function R(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,R(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var a=y(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function k(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(a.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}return{next:N}}function N(){return{value:n,done:!0}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,n(104))},function(e,t,n){n(482),e.exports=n(32).RegExp.escape},function(e,t,n){var r=n(0),a=n(483)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(e){return a(e)}})},function(e,t){e.exports=function(e,t){var n=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,n)}}},function(e,t,n){"use strict";var r=void 0,a=n(485),i=n(718),o=n(719),u=n(720),s=n(727),l=n(728),c=n(729),f=n(730),d=n(731),h=n(732),_={createService:u.create,updateNetworkType:u.updateNetworkType,enableDnaUpload:u.enableDnaUpload,disableDnaUpload:u.disableDnaUpload,enableDnaDownload:u.enableDnaDownload,disableDnaDownload:u.disableDnaDownload,resetDnaDownloadOnWifiEthernet:u.resetDnaDownloadOnWifiEthernet,enableDnaDownloadOnWifiEthernet:u.enableDnaDownloadOnWifiEthernet,disableDnaDownloadOnWifiEthernet:u.disableDnaDownloadOnWifiEthernet,resetDnaUploadOnWifiEthernet:u.resetDnaUploadOnWifiEthernet,enableDnaUploadOnWifiEthernet:u.enableDnaUploadOnWifiEthernet,disableDnaUploadOnWifiEthernet:u.disableDnaUploadOnWifiEthernet,resetDnaDownloadOnCellular:u.resetDnaDownloadOnCellular,enableDnaDownloadOnCellular:u.enableDnaDownloadOnCellular,disableDnaDownloadOnCellular:u.disableDnaDownloadOnCellular,resetDnaUploadOnCellular:u.resetDnaUploadOnCellular,enableDnaUploadOnCellular:u.enableDnaUploadOnCellular,disableDnaUploadOnCellular:u.disableDnaUploadOnCellular,peerPoolHigh:u.peerPoolHigh,updateMainManifest:f.updateMainManifest,updateMediaElement:f.updateMediaElement,updatePlaylistManifest:f.updatePlaylistManifest,getSegment:l.get,connectedToSignalingServer:c.onConnect,disconnectedToSignalingServer:c.onDisconnect,signalingDidComplete:c.onComplete,peerConnectionDisconnected:s.onDisconnect,peerConnectionOffered:s.onOffer,peerConnectionOnBufferAmountLow:s.onBufferAmountLow,peerConnectionReceivedData:s.onReceiveBinary,peerConnectionReceivedMessage:s.onReceiveMessage,httpRequestDataResponse:o.onBinaryResponse,hasherCallback:i.onHashCheck,trackerAskPeerFailure:d.trackerAskPeerFailure,trackerAskPeerResponse:d.trackerAskPeerResponse,trackerConnectionAttempt:d.trackerConnectionAttempt,trackerConnectionCreated:d.trackerConnectionCreated,trackerRequestAttempt:d.trackerRequestAttempt,trackerRequestFailure:d.trackerRequestFailure,getControlAnalytics:a.getControlAnalytics,getPublicAnalytics:a.getPublicAnalytics,getStatsAnalytics:a.getStatsAnalytics,getTrafficAnalytics:a.getTrafficAnalytics};e.exports=function(){var e=function(e){if(_.hasOwnProperty(e)){var t=_[e];_[e]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return t.call.apply(t,[r].concat(e))}catch(e){h.default.toSDK(e)}}}};for(var t in _)e(t);return _.version="3.8.0",_}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77);t.getPublicAnalytics=function(){return r.default.getInstance().getPublicAnalytics()},t.getStatsAnalytics=function(){return r.default.getInstance().getStatsAnalytics()},t.getTrafficAnalytics=function(){return r.default.getInstance().getTrafficAnalytics()},t.getControlAnalytics=function(){return r.default.getInstance().getControlAnalytics()}},function(e,t,n){n(487),e.exports=n(8).Object.freeze},function(e,t,n){var r=n(24),a=n(121).onFreeze;n(78)("freeze",function(e){return function(t){return e&&r(t)?e(a(t)):t}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(489),a=n(534),i=n(180);t.create=function(e,t){switch(e){case i.StreamType.DASH:return new r({ssaiEnabled:t});case i.StreamType.HLS:return new a({ssaiEnabled:t});default:throw new Error("Not implemented")}}},function(e,t,n){"use strict";(function(e){var r,a,i,o,u=c(n(92)),s=c(n(125)),l=c(n(54));function c(e){return e&&e.__esModule?e:{default:e}}o=function(e,t,n,r,a,i,o,c,f,d,h){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||(0,s.default)(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist/",n(n.s=20)}([function(t,n){t.exports=e},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=void 0,t=[],n=[],r=[],a=[];function i(e,t){for(var r in n){var a=n[r];if(a.context===e&&a.name===t)return a.instance}return null}function o(e,t,n){for(var r in n)if(n[r].name===e)return void(n[r].factory=t);n.push({name:e,factory:t})}function u(e,t){for(var n in t)if(t[n].name===e)return t[n].factory;return null}function s(e,t,n){for(var r in n)if(n[r].name===e)return void(n[r].factory=t)}function l(t,n,r,a){n.getClassName=function(){return t};var i=c(r)[t];if(i){var o=i.instance;if(!i.override)return o.apply({context:r,factory:e},a);for(var u in o=o.apply({context:r,factory:e,parent:n},a))n.hasOwnProperty(u)&&(n[u]=o[u])}return n}function c(e){var n=void 0;return t.forEach(function(t){t===e&&(n=t)}),n||(t.push(e),n=e),n}return e={extend:function(e,t,n,r){var a=c(r);!a[e]&&t&&(a[e]={instance:t,override:n})},getSingletonInstance:i,setSingletonInstance:function(e,t,r){for(var a in n){var i=n[a];if(i.context===e&&i.name===t)return void(n[a].instance=r)}n.push({name:t,context:e,instance:r})},getSingletonFactory:function(e){var t=u(e.__dashjs_factory_name,r);return t||(t=function(t){var r=void 0;return void 0===t&&(t={}),{getInstance:function(){return r||(r=i(t,e.__dashjs_factory_name)),r||(r=l(e.__dashjs_factory_name,e.apply({context:t},arguments),t,arguments),n.push({name:e.__dashjs_factory_name,context:t,instance:r})),r}}},o(e.__dashjs_factory_name,t,r)),t},getSingletonFactoryByName:function(e){return u(e,r)},updateSingletonFactory:function(e,t){s(e,t,r)},getClassFactory:function(e){var t=u(e.__dashjs_factory_name,a);return t||(t=function(t){return void 0===t&&(t={}),{create:function(){return l(e.__dashjs_factory_name,e.apply({context:t},arguments),t,arguments)}}},o(e.__dashjs_factory_name,t,a)),t},getClassFactoryByName:function(e){return u(e,a)},updateClassFactory:function(e,t){s(e,t,a)}}}();t.default=r,e.exports=t.default},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=new(function(){function e(){(0,a.default)(this,e),this.init()}return e.prototype.init=function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight"},e}());t.default=i,e.exports=t.default},function(e,t){e.exports=r},function(e,t,n){(function(t){var r=n(47),a=n(48),i=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,o=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,u=[["#","hash"],["?","query"],function(e){return e.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],s={hash:1,query:1};function c(e){var n,r=t&&t.location||{},a={},i=(0,l.default)(e=e||r);if("blob:"===e.protocol)a=new d(unescape(e.pathname),{});else if("string"===i)for(n in a=new d(e,{}),s)delete a[n];else if("object"===i){for(n in e)n in s||(a[n]=e[n]);void 0===a.slashes&&(a.slashes=o.test(e.href))}return a}function f(e){var t=i.exec(e);return{protocol:t[1]?t[1].toLowerCase():"",slashes:!!t[2],rest:t[3]}}function d(e,t,n){if(!(this instanceof d))return new d(e,t,n);var i,o,s,h,_,p,v=u.slice(),E=void 0===t?"undefined":(0,l.default)(t),g=this,m=0;for("object"!==E&&"string"!==E&&(n=t,t=null),n&&"function"!=typeof n&&(n=a.parse),t=c(t),i=!(o=f(e||"")).protocol&&!o.slashes,g.slashes=o.slashes||i&&t.slashes,g.protocol=o.protocol||t.protocol||"",e=o.rest,o.slashes||(v[3]=[/(.*)/,"pathname"]);m<v.length;m++)"function"!=typeof(h=v[m])?(s=h[0],p=h[1],s!=s?g[p]=e:"string"==typeof s?~(_=e.indexOf(s))&&("number"==typeof h[2]?(g[p]=e.slice(0,_),e=e.slice(_+h[2])):(g[p]=e.slice(_),e=e.slice(0,_))):(_=s.exec(e))&&(g[p]=_[1],e=e.slice(0,_.index)),g[p]=g[p]||i&&h[3]&&t[p]||"",h[4]&&(g[p]=g[p].toLowerCase())):e=h(e);n&&(g.query=n(g.query)),i&&t.slashes&&"/"!==g.pathname.charAt(0)&&(""!==g.pathname||""!==t.pathname)&&(g.pathname=function(e,t){for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),r=n.length,a=n[r-1],i=!1,o=0;r--;)"."===n[r]?n.splice(r,1):".."===n[r]?(n.splice(r,1),o++):o&&(0===r&&(i=!0),n.splice(r,1),o--);return i&&n.unshift(""),"."!==a&&".."!==a||n.push(""),n.join("/")}(g.pathname,t.pathname)),r(g.port,g.protocol)||(g.host=g.hostname,g.port=""),g.username=g.password="",g.auth&&(h=g.auth.split(":"),g.username=h[0]||"",g.password=h[1]||""),g.origin=g.protocol&&g.host&&"file:"!==g.protocol?g.protocol+"//"+g.host:"null",g.href=g.toString()}d.prototype={set:function(e,t,n){var i=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||a.parse)(t)),i[e]=t;break;case"port":i[e]=t,r(t,i.protocol)?t&&(i.host=i.hostname+":"+t):(i.host=i.hostname,i[e]="");break;case"hostname":i[e]=t,i.port&&(t+=":"+i.port),i.host=t;break;case"host":i[e]=t,/:\d+$/.test(t)?(t=t.split(":"),i.port=t.pop(),i.hostname=t.join(":")):(i.hostname=t,i.port="");break;case"protocol":i.protocol=t.toLowerCase(),i.slashes=!n;break;case"pathname":case"hash":if(t){var o="pathname"===e?"/":"#";i[e]=t.charAt(0)!==o?o+t:t}else i[e]=t;break;default:i[e]=t}for(var s=0;s<u.length;s++){var l=u[s];l[4]&&(i[l[1]]=i[l[1]].toLowerCase())}return i.origin=i.protocol&&i.host&&"file:"!==i.protocol?i.protocol+"//"+i.host:"null",i.href=i.toString(),i},toString:function(e){e&&"function"==typeof e||(e=a.stringify);var t,n=this,r=n.protocol;r&&":"!==r.charAt(r.length-1)&&(r+=":");var i=r+(n.slashes?"//":"");return n.username&&(i+=n.username,n.password&&(i+=":"+n.password),i+="@"),i+=n.host+n.pathname,(t="object"==(0,l.default)(n.query)?e(n.query):n.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(i+=n.hash),i}},d.extractProtocol=f,d.location=c,d.qs=a,e.exports=d}).call(t,n(46))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),a=i(n(17));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){var n=t.timeStamp,i=t.duration,o=t.trackView;(0,r.default)(this,e),this.timeStamp=n,this.trackView=new a.default(o),void 0!==i&&(this.duration=i)}return e.prototype.isEqual=function(e){if(!e)return!1;var t=e.timeStamp,n=e.trackView;return this.timeStamp===t&&this.trackView.isEqual(n)},e.prototype.isInTrack=function(e){return this.trackView.isEqual(e)},e.prototype.viewToString=function(){return this.trackView.viewToString()+"S"+this.timeStamp},e.prototype.getId=function(){return this.timeStamp},e}();t.default=o,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),a=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t,n){(0,r.default)(this,e),this.e=t,this.u=n}return(0,a.default)(e,[{key:"test",get:function(){return this.e}},{key:"converter",get:function(){return this.u}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(1))&&r.__esModule?r:{default:r},i=0;function o(){var e={};function t(t,n,r){var a=-1;return e[t]?(e[t].some(function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return a=t,!0}),a):a}return{on:function(n,r,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;if(!n)throw new Error("event type cannot be null or undefined");if(!r||"function"!=typeof r)throw new Error("listener must be a function: "+r);if(!(t(n,r,a)>=0)){e[n]=e[n]||[];var u={callback:r,scope:a,priority:o};e[n].some(function(t,r){if(t&&o>t.priority)return e[n].splice(r,0,u),!0})||e[n].push(u)}},off:function(n,r,a){if(n&&r&&e[n]){var i=t(n,r,a);i<0||(e[n][i]=null)}},trigger:function(t,n){if(t&&e[t]){if((n=n||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");n.type=t,e[t]=e[t].filter(function(e){return e}),e[t].forEach(function(e){return e&&e.callback.call(e.scope,n)})}},reset:function(){e={}}}}o.__dashjs_factory_name="EventBus";var u=a.default.getSingletonFactory(o);u.EVENT_PRIORITY_LOW=i,u.EVENT_PRIORITY_HIGH=5e3,a.default.updateSingletonFactory(o.__dashjs_factory_name,u),t.default=u,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(2)),i=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var u=new(function(e){function t(){return(0,r.default)(this,t),(0,a.default)(this,e.apply(this,arguments))}return(0,i.default)(t,e),t}(o(n(35)).default));t.default=u,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(1))&&r.__esModule?r:{default:r},i=n(6);function o(){var e=void 0,t=/^[a-z][a-z0-9+\-.]*:/i,n=/^https?:\/\//i,r=/^([a-z][a-z0-9+\-.]*:\/\/[^\/]+)\/?/i,a=function(e,t){try{return new i(e,t).toString()}catch(t){return e}},o=function(e,t){var n=u;if(!t)return e;if(!c(e))return e;f(e)&&(n=s),d(e)&&(n=l);var r=n(t),a="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return[r,e].join(a)};function u(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function s(e){var t=e.match(r);return t?t[1]:""}function l(e){var n=e.match(t);return n?n[0]:""}function c(e){return!t.test(e)}function f(e){return c(e)&&"/"===e.charAt(0)}function d(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y"),e=a}catch(e){}finally{e=e||o}}(),{parseBaseUrl:u,parseOrigin:s,parseScheme:l,isRelative:c,isPathAbsolute:f,isSchemeRelative:d,isHTTPURL:function(e){return n.test(e)},resolve:function(t,n){return e(t,n)}}}o.__dashjs_factory_name="URLUtils",t.default=a.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=new(function(){function e(){(0,a.default)(this,e),this.init()}return e.prototype.init=function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.FRAGMENTED_TEXT="fragmentedText",this.EMBEDDED_TEXT="embeddedText",this.MUXED="muxed",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.UTF8="utf-8",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma"},e}());t.default=i,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(5)),i=o(n(32));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n,a,o,u){var s=this;(0,r.default)(this,e),this.a=t||"",this.f=[],this.h=a||[],this.v=o||!1,this.b=u||!0,Array.isArray(n)&&n.forEach(function(e){s.f.push(new i.default(e))})}return(0,a.default)(e,[{key:"name",get:function(){return this.a}},{key:"isRoot",get:function(){return this.v}},{key:"isArray",get:function(){return this.b}},{key:"children",get:function(){return this.h}},{key:"properties",get:function(){return this.f}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(39));function i(e){return e&&e.__esModule?e:{default:e}}function o(){return{areEqual:function(e,t){return(0,a.default)(e,t)}}}o.__dashjs_factory_name="ObjectUtils",t.default=r.default.getSingletonFactory(o),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=function e(t,n,r,i){(0,a.default)(this,e),this.url=t||"",this.serviceLocation=n||t||"",this.dvb_priority=r||1,this.dvb_weight=i||1};i.DEFAULT_DVB_PRIORITY=1,i.DEFAULT_DVB_WEIGHT=1,t.default=i,e.exports=t.default},function(e,t){e.exports=a},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=function(){function e(t){var n=t.periodIdx,r=t.adaptationSetIdx,i=t.representationIdx,o=t.type,u=t.bitrate;(0,a.default)(this,e),this.periodIdx=n,this.adaptationSetIdx=r,this.representationIdx=i,this.type=o,this.bitrate=u}return e.makeIDString=function(e,t,n){return"P"+e+"A"+t+"R"+n},e.prototype.viewToString=function(){return e.makeIDString(this.periodIdx,this.adaptationSetIdx,this.representationIdx)},e.prototype.isEqual=function(e){return!!e&&this.periodIdx===e.periodIdx&&this.adaptationSetIdx===e.adaptationSetIdx&&this.representationIdx===e.representationIdx},e}();t.default=i,e.exports=t.default},function(e,t,n){function r(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}Object.defineProperty(t,"__esModule",{value:!0}),t.getSegmentNumberRegexp=function(e){var t=e;return t=(t=r(t)).split("\\$Number\\$").join("(\\d+)"),new RegExp(t)},t.getSegmentTimeRegexp=function(e){var t=e;return t=(t=r(t)).split("\\$Time\\$").join("(\\d+)"),new RegExp(t)},t.inlineRepresentationId=function(e,t){if(null===t||null===e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)},t.inlineBandwidth=function(e,t){if(null===t||null===e||-1===e.indexOf("$Bandwidth$"))return e;var n=t.toString();return e.split("$Bandwidth$").join(n)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(16)),a=o(n(0)),i=o(n(7));function o(e){return e&&e.__esModule?e:{default:e}}var u=n(6),s=function(){function e(t,n){if((0,a.default)(this,e),void 0===n.SegmentBase)throw new Error("SegmentBase not found in representation.");this.g=n.SegmentBase;var r=this.g.indexRange.split("-");r&&2===r.length&&!isNaN(r[1])?(this.w=Number(r[1])+1,this.g.indexRangeExact=!0):this.g.indexRangeExact=!1,this.y=t;var i=new u(n.resolvedBaseURL.url);this._=i.host+i.pathname}return e.prototype.getBaseUrl=function(){return this._},e.prototype.setIndexData=function(e){if(this.g.indexRangeExact){this.j=[],this.M=new r.default;for(var t=0;t<e.length;t++){var n=e[t],a=new i.default({timeStamp:n[1],duration:n[2],trackView:this.y});this.j.push(a),this.M.set(n[0]+this.w,a)}}},e.prototype.getSegmentList=function(e,t){return this.j.filter(function(n){return n.timeStamp>=e&&n.timeStamp<e+t})},e.prototype.getSegmentViewByUrl=function(e,t){if(!this.M)return null;var n=new u(e),r=n.host+n.pathname;if(this._!==r)return null;var a=[];if(t&&"string"==typeof t){var i=/bytes=(\d+)-?(\d+)?/i.exec(t);return i&&i.length>1?(a.push(Number(i[1])),3!==i.length||isNaN(i[2])||a.push(Number(i[2])+1),this.M.get(a[0])||null):null}return null},e}();t.default=s,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(0)),a=l(n(5)),i=l(n(21)),o=l(n(59)),u=l(n(60)),s=l(n(7));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,r.default)(this,e),this.N=new i.default,this.O=new o.default(this.N),this.onMediaMapCreated=function(){}}return e.prototype.updateManifest=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.N.parse(e,t,n);this.S?this.S.update(r):(this.S=new u.default(this.O),this.S.update(r),this.onMediaMapCreated(this.S))},e.prototype.setSegmentOffsetListForTrack=function(e,t){this.S&&this.S.setSegmentOffsetListForTrack(e,t)},(0,a.default)(e,[{key:"integrationVersion",get:function(){return"v5d1"}},{key:"SegmentView",get:function(){return s.default}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(0)),a=l(n(22)),i=l(n(34)),o=l(n(37)),u=l(n(49)),s=l(n(11));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,r.default)(this,e),this.C={},this.T={timelineConverter:(0,i.default)(this.C).getInstance(),baseURLController:(0,o.default)(this.C).getInstance(),errorHandler:{manifestError:function(e,t,n,r){}}},this.A=(0,u.default)().getInstance(this.T),this.T.baseURLController.setConfig({dashManifestModel:this.A}),this.x=(0,a.default)(this.C).create(this.T)}return e.prototype.parse=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.T.timelineConverter.initialize(),this.T.timelineConverter.setClientTimeOffset(n),this.T.baseURLController.reset();var r=this.x.parse(e);return this.R(r),this.I(r,t),this.F(r),this.D=this.A.getMpd(r),r},e.prototype.calcSegmentAvailabilityRange=function(e,t){var n=this.A.getRegularPeriods(this.D)[e.period.idx],r=this.A.getAdaptationsForPeriod(n)[e.adaptationSet.idx],a=this.A.getRepresentationsForAdaptation(r)[e.idx];return this.T.timelineConverter.calcSegmentAvailabilityRange(a,t)},e.prototype.R=function(e){e.hasOwnProperty("loadedTime")||(e.loadedTime=new Date)},e.prototype.I=function(e,t){var n=(0,s.default)(this.C).getInstance(),r=t;/^\/\//.test(t)&&(r="http:"+r);var a;a=e.hasOwnProperty("Location")?n.parseBaseUrl(e.Location_asArray[0]):n.parseBaseUrl(r),e.baseUri=a,e.url=r},e.prototype.F=function(e){this.T.baseURLController.initialize(e);for(var t=void 0,n=0;n<e.Period_asArray.length;n++){t=e.Period_asArray[n];for(var r=void 0,a=0;a<t.AdaptationSet_asArray.length;a++){r=t.AdaptationSet_asArray[a];for(var i=0;i<r.Representation_asArray.length;i++)r.Representation_asArray[i].resolvedBaseURL=this.T.baseURLController.resolve([n,a,i])}}},e}();t.default=c,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(1)),a=d(n(23)),i=d(n(25)),o=d(n(26)),u=d(n(28)),s=d(n(29)),l=d(n(30)),c=d(n(31)),f=d(n(33));function d(e){return e&&e.__esModule?e:{default:e}}function h(e){this.context;var t,n=e.errorHandler,r=void 0,d=void 0,h=void 0;return t={parse:function(e){var t=void 0;!function(){if(!n||!n.hasOwnProperty("manifestError"))throw new Error("Missing config parameter(s)")}();try{var r=window.performance.now();if(!(t=d.xml_str2json(e)))throw new Error("parser error");var a=window.performance.now();h.run(t);var i=window.performance.now();(a-r).toPrecision(3),(i-a).toPrecision(3),((i-r)/1e3).toPrecision(3)}catch(t){return n.manifestError("parsing the manifest failed","parse",e,t),null}return t},getMatchers:function(){return r},getIron:function(){return h}},r=[new u.default,new s.default,new l.default,new o.default],d=new i.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:r}),h=new a.default([new c.default,new f.default]),t}h.__dashjs_factory_name="DashParser",t.default=r.default.getClassFactory(h),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(24))&&r.__esModule?r:{default:r};t.default=function(e){var t,n,r;for(t=[],r=0,n=e.length;r<n;r+=1)e[r].isRoot?t.push("root"):t.push(e[r].name);var i=function(e,t){var n;if(null!==e&&null!==t)for(n in e)e.hasOwnProperty(n)&&(t.hasOwnProperty(n)||(t[n]=e[n]))},o=function(e,t,n){var r,o,u,s,l;if(null!==e&&0!==e.length)for(r=0,o=e.length;r<o;r+=1)u=e[r],t.hasOwnProperty(u.name)&&(n.hasOwnProperty(u.name)?u.merge&&(s=t[u.name],l=n[u.name],"object"===(void 0===s?"undefined":(0,a.default)(s))&&"object"===(void 0===l?"undefined":(0,a.default)(l))?i(s,l):null!=u.mergeFunction?n[u.name]=u.mergeFunction(s,l):n[u.name]=s+l):n[u.name]=t[u.name])},u=function e(t,n){var r,a,i,u,s,l,c,f=t;if(null!==f.children&&0!==f.children.length)for(r=0,a=f.children.length;r<a;r+=1)if(l=f.children[r],n.hasOwnProperty(l.name))if(l.isArray)for(i=0,u=(s=n[l.name+"_asArray"]).length;i<u;i+=1)c=s[i],o(f.properties,n,c),e(l,c);else c=n[l.name],o(f.properties,n,c),e(l,c)};return{run:function n(r){var i,o,s,l,c,f,d;if(null===r)return r;if("object"!==(void 0===r?"undefined":(0,a.default)(r)))return r;for(i=0,o=t.length;i<o;i+=1)"root"===t[i]&&(c=e[i],u(c,f=r));for(l in r)if(r.hasOwnProperty(l)&&"__children"!=l){if(-1!==(s=t.indexOf(l)))if((c=e[s]).isArray)for(i=0,o=(d=r[l+"_asArray"]).length;i<o;i+=1)f=d[i],u(c,f);else f=r[l],u(c,f);n(r[l])}return r}}},e.exports=t.default},function(e,t){e.exports=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){void 0===(e=e||{}).escapeMode&&(e.escapeMode=!0),void 0===e.attributePrefix&&(e.attributePrefix="_"),e.arrayAccessForm=e.arrayAccessForm||"none",e.emptyNodeForm=e.emptyNodeForm||"text",void 0===e.enableToStringFunc&&(e.enableToStringFunc=!0),e.arrayAccessFormPaths=e.arrayAccessFormPaths||[],void 0===e.skipEmptyTextNodesForObj&&(e.skipEmptyTextNodesForObj=!0),void 0===e.stripWhitespaces&&(e.stripWhitespaces=!0),e.datetimeAccessFormPaths=e.datetimeAccessFormPaths||[],void 0===e.useDoubleQuotes&&(e.useDoubleQuotes=!1),e.xmlElementsFilter=e.xmlElementsFilter||[],e.jsonPropertiesFilter=e.jsonPropertiesFilter||[],void 0===e.keepCData&&(e.keepCData=!1),void 0===e.ignoreRoot&&(e.ignoreRoot=!1);var t={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function n(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function r(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function a(e,t,n,r){for(var a=0;a<e.length;a++){var i=e[a];if("string"==typeof i){if(i==r)break}else if(i instanceof RegExp){if(i.test(r))break}else if("function"==typeof i&&i(t,n,r))break}return a!=e.length}function i(t,n,r){switch(e.arrayAccessForm){case"property":t[n]instanceof Array?t[n+"_asArray"]=t[n]:t[n+"_asArray"]=[t[n]]}!(t[n]instanceof Array)&&e.arrayAccessFormPaths.length>0&&a(e.arrayAccessFormPaths,t,n,r)&&(t[n]=[t[n]])}function o(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),r.length>1&&n.setMilliseconds(r[1]),t[6]&&t[7]){var a=60*t[6]+Number(t[7]);a=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*a:a),n.setMinutes(n.getMinutes()-a-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function u(n,r,i,o){return!(r==t.ELEMENT_NODE&&e.xmlElementsFilter.length>0)||a(e.xmlElementsFilter,n,i,o)}function s(r,l){if(r.nodeType==t.DOCUMENT_NODE){for(var c=new Object,f=r.childNodes,d=0;d<f.length;d++)(_=f[d]).nodeType==t.ELEMENT_NODE&&(e.ignoreRoot?c=s(_):(c={})[p=n(_)]=s(_));return c}if(r.nodeType==t.ELEMENT_NODE){(c=new Object).__cnt=0;var h=[];for(f=r.childNodes,d=0;d<f.length;d++){var _,p=n(_=f[d]);if(_.nodeType!=t.COMMENT_NODE){var v=l+"."+p;if(u(c,_.nodeType,p,v))if(c.__cnt++,null==c[p]){var E=s(_,v);("#text"!=p||/[^\s]/.test(E))&&((g={})[p]=E,h.push(g)),c[p]=E,i(c,p,v)}else{var g;null!=c[p]&&(c[p]instanceof Array||(c[p]=[c[p]],i(c,p,v))),E=s(_,v),("#text"!=p||/[^\s]/.test(E))&&((g={})[p]=E,h.push(g)),c[p][c[p].length]=E}}}c.__children=h;for(var m=n(r),S=0;S<r.attributes.length;S++){var y=r.attributes[S];c.__cnt++;for(var T=y.value,A=0,C=e.matchers.length;A<C;A++){var D=e.matchers[A];D.test(y,m)&&(T=D.converter(y.value))}c[e.attributePrefix+y.name]=T}var P=r.prefix;return null!=P&&""!=P&&(c.__cnt++,c.__prefix=P),null!=c["#text"]&&(c.__text=c["#text"],c.__text instanceof Array&&(c.__text=c.__text.join("\n")),e.stripWhitespaces&&(c.__text=c.__text.trim()),delete c["#text"],"property"==e.arrayAccessForm&&delete c["#text_asArray"],c.__text=function(t,n,r){if(e.datetimeAccessFormPaths.length>0){var i=r.split(".#")[0];return a(e.datetimeAccessFormPaths,t,n,i)?o(t):t}return t}(c.__text,p,l+"."+p)),null!=c["#cdata-section"]&&(c.__cdata=c["#cdata-section"],delete c["#cdata-section"],"property"==e.arrayAccessForm&&delete c["#cdata-section_asArray"]),0==c.__cnt&&"text"==e.emptyNodeForm?c="":1==c.__cnt&&null!=c.__text?c=c.__text:1!=c.__cnt||null==c.__cdata||e.keepCData?c.__cnt>1&&null!=c.__text&&e.skipEmptyTextNodesForObj&&(e.stripWhitespaces&&""==c.__text||""==c.__text.trim())&&delete c.__text:c=c.__cdata,delete c.__cnt,!e.enableToStringFunc||null==c.__text&&null==c.__cdata||(c.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),c}if(r.nodeType==t.TEXT_NODE||r.nodeType==t.CDATA_SECTION_NODE)return r.nodeValue}function l(t,n,a,i){var o="<"+(null!=t&&null!=t.__prefix?t.__prefix+":":"")+n;if(null!=a)for(var u=0;u<a.length;u++){var s=a[u],l=t[s];e.escapeMode&&(l=r(l)),o+=" "+s.substr(e.attributePrefix.length)+"=",e.useDoubleQuotes?o+='"'+l+'"':o+="'"+l+"'"}return o+(i?"/>":">")}function c(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function f(t,n){return"property"==e.arrayAccessForm&&(a="_asArray",-1!==(r=n.toString()).indexOf(a,r.length-a.length))||0==n.toString().indexOf(e.attributePrefix)||0==n.toString().indexOf("__")||t[n]instanceof Function;var r,a}function d(e){var t=0;if(e instanceof Object)for(var n in e)f(e,n)||t++;return t}function h(t,n,r){return 0==e.jsonPropertiesFilter.length||""==r||a(e.jsonPropertiesFilter,t,n,r)}function _(t){var n=[];if(t instanceof Object)for(var r in t)-1==r.toString().indexOf("__")&&0==r.toString().indexOf(e.attributePrefix)&&n.push(r);return n}function p(t){var n="";return t instanceof Object?n+=function(t){var n="";return null!=t.__cdata&&(n+="<![CDATA["+t.__cdata+"]]>"),null!=t.__text&&(e.escapeMode?n+=r(t.__text):n+=t.__text),n}(t):null!=t&&(e.escapeMode?n+=r(t):n+=t),n}function v(e,t){return""===e?t:e+"."+t}function E(e,t,n,r){var a="";if(0==e.length)a+=l(e,t,n,!0);else for(var i=0;i<e.length;i++)a+=l(e[i],t,_(e[i]),!1),a+=g(e[i],v(r,t)),a+=c(e[i],t);return a}function g(e,t){var n="";if(d(e)>0)for(var r in e)if(!f(e,r)&&(""==t||h(e,r,v(t,r)))){var a=e[r],i=_(a);null==a||void 0==a?n+=l(a,r,i,!0):a instanceof Object?a instanceof Array?n+=E(a,r,i,t):a instanceof Date?(n+=l(a,r,i,!1),n+=a.toISOString(),n+=c(a,r)):d(a)>0||null!=a.__text||null!=a.__cdata?(n+=l(a,r,i,!1),n+=g(a,v(t,r)),n+=c(a,r)):n+=l(a,r,i,!0):(n+=l(a,r,i,!1),n+=p(a),n+=c(a,r))}return n+p(e)}this.parseXmlString=function(e){var t;if(window.ActiveXObject||window,void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parseerror").length>0&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?o(e):e},this.xml2json=function(e){return s(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return g(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(27)),a=l(n(0)),i=l(n(2)),o=l(n(3)),u=l(n(8)),s=l(n(4));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,a.default)(this,t),(0,i.default)(this,e.call(this,function(e,t){var n,a=(n={},(0,r.default)(n,s.default.MPD,[s.default.ID,s.default.PROFILES]),(0,r.default)(n,s.default.PERIOD,[s.default.ID]),(0,r.default)(n,s.default.BASE_URL,[s.default.SERVICE_LOCATION,s.default.BYTE_RANGE]),(0,r.default)(n,s.default.SEGMENT_BASE,[s.default.INDEX_RANGE]),(0,r.default)(n,s.default.INITIALIZATION,[s.default.RANGE]),(0,r.default)(n,s.default.REPRESENTATION_INDEX,[s.default.RANGE]),(0,r.default)(n,s.default.SEGMENT_LIST,[s.default.INDEX_RANGE]),(0,r.default)(n,s.default.BITSTREAM_SWITCHING,[s.default.RANGE]),(0,r.default)(n,s.default.SEGMENT_URL,[s.default.MEDIA_RANGE,s.default.INDEX_RANGE]),(0,r.default)(n,s.default.SEGMENT_TEMPLATE,[s.default.INDEX_RANGE,s.default.MEDIA,s.default.INDEX,s.default.INITIALIZATION_MINUS,s.default.BITSTREAM_SWITCHING_MINUS]),(0,r.default)(n,s.default.ASSET_IDENTIFIER,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.EVENT_STREAM,[s.default.VALUE]),(0,r.default)(n,s.default.ADAPTATION_SET,[s.default.PROFILES,s.default.MIME_TYPE,s.default.SEGMENT_PROFILES,s.default.CODECS,s.default.CONTENT_TYPE]),(0,r.default)(n,s.default.FRAME_PACKING,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.AUDIO_CHANNEL_CONFIGURATION,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.CONTENT_PROTECTION,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.ESSENTIAL_PROPERTY,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.SUPPLEMENTAL_PROPERTY,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.INBAND_EVENT_STREAM,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.ACCESSIBILITY,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.ROLE,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.RATING,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.VIEWPOINT,[s.default.VALUE,s.default.ID]),(0,r.default)(n,s.default.CONTENT_COMPONENT,[s.default.CONTENT_TYPE]),(0,r.default)(n,s.default.REPRESENTATION,[s.default.ID,s.default.DEPENDENCY_ID,s.default.MEDIA_STREAM_STRUCTURE_ID]),(0,r.default)(n,s.default.SUBSET,[s.default.ID]),(0,r.default)(n,s.default.METRICS,[s.default.METRICS_MINUS]),(0,r.default)(n,s.default.REPORTING,[s.default.VALUE,s.default.ID]),n);if(a.hasOwnProperty(t)){var i=a[t];return void 0!==i&&i.indexOf(e.name)>=0}return!1},function(e){return String(e)}))}return(0,o.default)(t,e),t}(u.default);t.default=c,e.exports=t.default},function(e,t){e.exports=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(0)),a=l(n(2)),i=l(n(3)),o=l(n(8)),u=l(n(12)),s=l(n(4));function l(e){return e&&e.__esModule?e:{default:e}}var c=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,f=31536e3,d=2592e3,h=86400,_=3600,p=60,v=function(e){function t(){return(0,r.default)(this,t),(0,a.default)(this,e.call(this,function(e){for(var t=[s.default.MIN_BUFFER_TIME,s.default.MEDIA_PRESENTATION_DURATION,s.default.MINIMUM_UPDATE_PERIOD,s.default.TIMESHIFT_BUFFER_DEPTH,s.default.MAX_SEGMENT_DURATION,s.default.MAX_SUBSEGMENT_DURATION,u.default.SUGGESTED_PRESENTATION_DELAY,s.default.START,u.default.START_TIME,s.default.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return c.test(e.value);return!1},function(e){var t=c.exec(e),n=parseFloat(t[2]||0)*f+parseFloat(t[4]||0)*d+parseFloat(t[6]||0)*h+parseFloat(t[8]||0)*_+parseFloat(t[10]||0)*p+parseFloat(t[12]||0);return void 0!==t[1]&&(n=-n),n}))}return(0,i.default)(t,e),t}(o.default);t.default=v,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(2)),i=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var u=60,s=60,l=1e3,c=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,f=function(e){function t(){return(0,r.default)(this,t),(0,a.default)(this,e.call(this,function(e){return c.test(e.value)},function(e){var t=c.exec(e),n=void 0;if(n=Date.UTC(parseInt(t[1],10),parseInt(t[2],10)-1,parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10),t[6]&&parseInt(t[6],10)||0,t[7]&&parseFloat(t[7])*l||0),t[9]&&t[10]){var r=parseInt(t[9],10)*s+parseInt(t[10],10);n+=("+"===t[8]?-1:1)*r*u*l}return new Date(n)}))}return(0,i.default)(t,e),t}(o(n(8)).default);t.default=f,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(2)),i=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var u=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,s=function(e){function t(){return(0,r.default)(this,t),(0,a.default)(this,e.call(this,function(e){return u.test(e.value)},function(e){return parseFloat(e)}))}return(0,i.default)(t,e),t}(o(n(8)).default);t.default=s,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(0)),a=s(n(2)),i=s(n(3)),o=s(n(13)),u=s(n(4));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){(0,r.default)(this,t);var n=[u.default.PROFILES,u.default.WIDTH,u.default.HEIGHT,u.default.SAR,u.default.FRAMERATE,u.default.AUDIO_SAMPLING_RATE,u.default.MIME_TYPE,u.default.SEGMENT_PROFILES,u.default.CODECS,u.default.MAXIMUM_SAP_PERIOD,u.default.START_WITH_SAP,u.default.MAX_PLAYOUT_RATE,u.default.CODING_DEPENDENCY,u.default.SCAN_TYPE,u.default.FRAME_PACKING,u.default.AUDIO_CHANNEL_CONFIGURATION,u.default.CONTENT_PROTECTION,u.default.ESSENTIAL_PROPERTY,u.default.SUPPLEMENTAL_PROPERTY,u.default.INBAND_EVENT_STREAM];return(0,a.default)(this,e.call(this,u.default.ADAPTATION_SET,n,[new o.default(u.default.REPRESENTATION,n,[new o.default(u.default.SUB_REPRESENTATION,n)])]))}return(0,i.default)(t,e),t}(o.default);t.default=l,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),a=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t,n){var a;(0,r.default)(this,e),this.a=t,this.k=void 0!==n?n:(a=t)&&a.length&&a.charAt(0)===a.charAt(0).toUpperCase()}return(0,a.default)(e,[{key:"name",get:function(){return this.a}},{key:"merge",get:function(){return this.k}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(0)),a=s(n(2)),i=s(n(3)),o=s(n(13)),u=s(n(4));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){(0,r.default)(this,t);var n=[u.default.SEGMENT_BASE,u.default.SEGMENT_TEMPLATE,u.default.SEGMENT_LIST];return(0,a.default)(this,e.call(this,u.default.PERIOD,n,[new o.default(u.default.ADAPTATION_SET,n,[new o.default(u.default.REPRESENTATION,n)])]))}return(0,i.default)(t,e),t}(o.default);t.default=l,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(9)),a=o(n(10)),i=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}function u(){var e=this.context,t=(0,r.default)(e).getInstance(),n=void 0,i=void 0,o=void 0;function u(e){n=e}function s(e,t,r,a){return a?r&&t.timeShiftBufferDepth!=Number.POSITIVE_INFINITY?new Date(t.availabilityStartTime.getTime()+1e3*(e+t.timeShiftBufferDepth)):t.availabilityEndTime:r?new Date(t.availabilityStartTime.getTime()+1e3*(e-n)):t.availabilityStartTime}function l(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*n)/1e3}function c(e){i||void 0!==e.offset&&(u(e.offset/1e3),i=!0)}function f(){n=0,i=!1,o=NaN}return{initialize:function(){f(),t.on(a.default.TIME_SYNCHRONIZATION_COMPLETED,c,this)},isTimeSyncCompleted:function(){return i},setTimeSyncCompleted:function(e){i=e},getClientTimeOffset:function(){return n},setClientTimeOffset:u,getExpectedLiveEdge:function(){return o},setExpectedLiveEdge:function(e){o=e},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return s.call(this,e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return s.call(this,e,t,n,!0)},calcPresentationTimeFromWallTime:l,calcPresentationTimeFromMediaTime:function(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)},calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcSegmentAvailabilityRange:function(e,t){var n=e.adaptation.period,r={start:n.start,end:n.start+n.duration};if(!t)return r;if(!i&&e.segmentAvailabilityRange)return e.segmentAvailabilityRange;var a=e.segmentDuration||(e.segments&&e.segments.length?e.segments[e.segments.length-1].duration:0),o=l(new Date,n),u=n.start+n.duration;return r.start=Math.max(o-n.mpd.timeShiftBufferDepth,n.start),r.end=o>=u&&o-a<u?u-a:o-a,r},calcWallTimeForSegment:function(e,t){var n=void 0,r=void 0,a=void 0;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,a=new Date(e.availabilityStartTime.getTime()+1e3*r)),a},calcMSETimeOffset:function(e){var t=e.presentationTimeOffset;return e.adaptation.period.start-t},reset:function(){t.off(a.default.TIME_SYNCHRONIZATION_COMPLETED,c,this),f()}}}u.__dashjs_factory_name="TimelineConverter",t.default=i.default.getSingletonFactory(u),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(2)),i=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){(0,r.default)(this,t);var n=(0,a.default)(this,e.call(this));return n.BUFFERING_COMPLETED="bufferingCompleted",n.BUFFER_CLEARED="bufferCleared",n.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",n.BYTES_APPENDED="bytesAppended",n.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",n.CURRENT_TRACK_CHANGED="currentTrackChanged",n.DATA_UPDATE_COMPLETED="dataUpdateCompleted",n.DATA_UPDATE_STARTED="dataUpdateStarted",n.INITIALIZATION_LOADED="initializationLoaded",n.INIT_FRAGMENT_LOADED="initFragmentLoaded",n.INIT_REQUESTED="initRequested",n.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",n.LIVE_EDGE_SEARCH_COMPLETED="liveEdgeSearchCompleted",n.LOADING_COMPLETED="loadingCompleted",n.LOADING_PROGRESS="loadingProgress",n.LOADING_ABANDONED="loadingAborted",n.MANIFEST_UPDATED="manifestUpdated",n.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",n.QUOTA_EXCEEDED="quotaExceeded",n.REPRESENTATION_UPDATED="representationUpdated",n.SEGMENTS_LOADED="segmentsLoaded",n.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",n.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",n.SOURCEBUFFER_APPEND_COMPLETED="sourceBufferAppendCompleted",n.SOURCEBUFFER_REMOVE_COMPLETED="sourceBufferRemoveCompleted",n.STREAMS_COMPOSED="streamsComposed",n.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",n.STREAM_COMPLETED="streamCompleted",n.TIMED_TEXT_REQUESTED="timedTextRequested",n.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",n.URL_RESOLUTION_FAILED="urlResolutionFailed",n.VIDEO_CHUNK_RECEIVED="videoChunkReceived",n.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",n.XLINK_ELEMENT_LOADED="xlinkElementLoaded",n.XLINK_READY="xlinkReady",n}return(0,i.default)(t,e),t}(o(n(36)).default);t.default=u,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=function(){function e(){(0,a.default)(this,e)}return e.prototype.extend=function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var a in e)!e.hasOwnProperty(a)||this[a]&&!n||r&&-1===e[a].indexOf("public_")||(this[a]=e[a])}},e}();t.default=i,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(38)),a=c(n(42)),i=c(n(11)),o=c(n(15)),u=c(n(1)),s=c(n(9)),l=c(n(10));function c(e){return e&&e.__esModule?e:{default:e}}function f(){var e,t=void 0,n=this.context,u=(0,s.default)(n).getInstance(),c=(0,i.default)(n).getInstance(),f=void 0,d=void 0;return e={reset:function(){f.reset(),d.reset()},initialize:function(e){var n;f.setConfig({dashManifestModel:t}),d.setConfig({dashManifestModel:t}),n=e,f.update(n),d.chooseSelectorFromManifest(n)},resolve:function(e){var t=f.getForPath(e).reduce(function(e,t){var n=d.select(t);return n?(c.isRelative(n.url)?e.url=c.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e):new o.default},new o.default);if(!c.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(f=e.baseURLTreeModel),e.baseURLSelector&&(d=e.baseURLSelector),e.dashManifestModel&&(t=e.dashManifestModel)}},f=(0,r.default)(n).create(),d=(0,a.default)(n).create(),u.on(l.default.SERVICE_LOCATION_BLACKLIST_CHANGED,function(e){f.invalidateSelectedIndexes(e.entry)},e),e}f.__dashjs_factory_name="BaseURLController",t.default=u.default.getSingletonFactory(f),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(14)),i=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var u=NaN,s=function e(t,n){(0,r.default)(this,e),this.data={baseUrls:t||null,selectedIdx:n||u},this.children=[]};function l(){var e,t=void 0,n=void 0,r=this.context,i=(0,a.default)(r).getInstance();function o(e,t,r){var a=n.getBaseURLsFromElement(r);e[t]?i.areEqual(a,e[t].data.baseUrls)||(e[t].data.baseUrls=a,e[t].data.selectedIdx=u):e[t]=new s(a)}function l(){t=new s}return e={reset:l,update:function(e){!function(e){var r=n.getBaseURLsFromElement(e);i.areEqual(r,t.data.baseUrls)||(t.data.baseUrls=r,t.data.selectedIdx=u),e.Period_asArray&&e.Period_asArray.forEach(function(e,r){o(t.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,a){o(t.children[r].children,a,e),e.Representation_asArray&&e.Representation_asArray.sort(n.getRepresentationSortFunction()).forEach(function(e,n){o(t.children[r].children[a].children,n,e)})})})}(e)},getForPath:function(e){var n=t,r=[n.data];return e.forEach(function(e){(n=n.children[e])&&r.push(n.data)}),r.filter(function(e){return e.baseUrls.length})},invalidateSelectedIndexes:function(e){!function e(n,r){var a=r||t;n(a.data),a.children&&a.children.forEach(function(t){return e(n,t)})}(function(t){isNaN(t.selectedIdx)||e===t.baseUrls[t.selectedIdx].serviceLocation&&(t.selectedIdx=u)})},setConfig:function(e){e.dashManifestModel&&(n=e.dashManifestModel)}},l(),e}l.__dashjs_factory_name="BaseURLTreeModel",t.default=i.default.getClassFactory(l),e.exports=t.default},function(e,t,n){var r=Array.prototype.slice,a=n(40),i=n(41),o=e.exports=function(e,t,n){return n||(n={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||"object"!=(void 0===e?"undefined":(0,l.default)(e))&&"object"!=(void 0===t?"undefined":(0,l.default)(t))?n.strict?e===t:e==t:function(e,t,n){var c,f;if(u(e)||u(t))return!1;if(e.prototype!==t.prototype)return!1;if(i(e))return!!i(t)&&(e=r.call(e),t=r.call(t),o(e,t,n));if(s(e)){if(!s(t))return!1;if(e.length!==t.length)return!1;for(c=0;c<e.length;c++)if(e[c]!==t[c])return!1;return!0}try{var d=a(e),h=a(t)}catch(e){return!1}if(d.length!=h.length)return!1;for(d.sort(),h.sort(),c=d.length-1;c>=0;c--)if(d[c]!=h[c])return!1;for(c=d.length-1;c>=0;c--)if(f=d[c],!o(e[f],t[f],n))return!1;return(void 0===e?"undefined":(0,l.default)(e))==(void 0===t?"undefined":(0,l.default)(t))}(e,t,n))};function u(e){return null===e||void 0===e}function s(e){return!(!e||"object"!=(void 0===e?"undefined":(0,l.default)(e))||"number"!=typeof e.length||"function"!=typeof e.copy||"function"!=typeof e.slice||e.length>0&&"number"!=typeof e[0])}},function(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}(e.exports="function"==typeof u.default?u.default:n).shim=n},function(e,t){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function r(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function a(e){return e&&"object"==(void 0===e?"undefined":(0,l.default)(e))&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}(t=e.exports=n?r:a).supported=r,t.unsupported=a},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(9)),a=l(n(10)),i=l(n(43)),o=l(n(44)),u=l(n(45)),s=l(n(1));function l(e){return e&&e.__esModule?e:{default:e}}var c=1,f="Failed to resolve a valid URL";function d(){var e,t=this.context,n=(0,r.default)(t).getInstance(),s=void 0,l=void 0,d=void 0,h=void 0,_=void 0;return e={chooseSelectorFromManifest:function(e){!function(){if(!s||!s.hasOwnProperty("getIsDVB"))throw new Error("Missing config parameter(s)")}(),_=s.getIsDVB(e)?h:d},select:function(e){var t=e.baseUrls,r=e.selectedIdx;if(!isNaN(r))return t[r];var i=_.select(t);if(i)return e.selectedIdx=t.indexOf(i),i;n.trigger(a.default.URL_RESOLUTION_FAILED,{error:new Error(c,f)})},reset:function(){l.reset()},setConfig:function(e){e.selector&&(_=e.selector),e.dashManifestModel&&(s=e.dashManifestModel)}},l=(0,i.default)(t).create({updateEventName:a.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:a.default.SERVICE_LOCATION_BLACKLIST_ADD}),d=(0,u.default)(t).create({blacklistController:l}),h=(0,o.default)(t).create({blacklistController:l}),_=d,e}d.__dashjs_factory_name="BaseURLSelector";var h=s.default.getClassFactory(d);h.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=c,h.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE=f,s.default.updateClassFactory(d.__dashjs_factory_name,h),t.default=h,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(9));function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=[],n=(0,a.default)(this.context).getInstance(),r=e.updateEventName,i=e.addBlacklistEventName;function o(e){-1===t.indexOf(e)&&(t.push(e),n.trigger(r,{entry:e}))}function u(e){o(e.entry)}return function(){i&&n.on(i,u,this)}(),{add:o,contains:function(e){return!!(t.length&&e&&e.length)&&-1!==t.indexOf(e)},reset:function(){t=[]}}}o.__dashjs_factory_name="BlackListController",t.default=r.default.getClassFactory(o),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(1))&&r.__esModule?r:{default:r};function i(e){var t=e.blacklistController;return{select:function(e){return e&&function(e){var t=0,n=[],r=0,a=void 0,i=void 0;if((i=e.sort(function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n}).filter(function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority})).length)return i.length>1&&(i.forEach(function(e){t+=e.dvb_weight,n.push(t)}),a=Math.floor(Math.random()*(t-1)),n.every(function(e,t){return r=t,!(a<e)})),i[r]}((n=[],e.filter(function(e){return!t.contains(e.serviceLocation)||(e.dvb_priority&&n.push(e.dvb_priority),!1)}).filter(function(e){return!n.length||!e.dvb_priority||-1===n.indexOf(e.dvb_priority)})));var n}}}i.__dashjs_factory_name="DVBSelector",t.default=a.default.getClassFactory(i),e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(1))&&r.__esModule?r:{default:r};function i(e){var t=e.blacklistController;return{select:function(e){var n=0,r=void 0;return e&&e.some(function(e,r){return n=r,!t.contains(e.serviceLocation)})&&(r=e[n]),r}}}i.__dashjs_factory_name="BasicSelector",t.default=a.default.getClassFactory(i),e.exports=t.default},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==("undefined"==typeof window?"undefined":(0,l.default)(window))&&(n=window)}e.exports=n},function(e,t,n){e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,n){var r=Object.prototype.hasOwnProperty;function a(e){return decodeURIComponent(e.replace(/\+/g," "))}t.stringify=function(e,t){t=t||"";var n=[];for(var a in"string"!=typeof t&&(t="?"),e)r.call(e,a)&&n.push(encodeURIComponent(a)+"="+encodeURIComponent(e[a]));return n.length?t+n.join("&"):""},t.parse=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);){var i=a(t[1]),o=a(t[2]);i in r||(r[i]=o)}return r}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=g(n(50)),a=g(n(51)),i=g(n(12)),o=g(n(4)),u=g(n(52)),s=g(n(53)),l=g(n(54)),c=g(n(55)),f=g(n(56)),d=g(n(57)),h=g(n(15)),_=g(n(58)),p=g(n(14)),v=g(n(11)),E=g(n(1));function g(e){return e&&e.__esModule?e:{default:e}}function m(e){var t=this.context,n=(0,v.default)(t).getInstance(),E=e.mediaController,g=e.timelineConverter,m=e.adapter,S=a.default||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function y(e,t){var n=void 0,r=void 0,a=void 0,u=void 0,s=void 0,l=void 0,c=!1,f=!1;if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.hasOwnProperty("ContentComponent_asArray")&&(u=e.ContentComponent_asArray),s=t!==i.default.TEXT?new RegExp(t):new RegExp("(vtt|ttml)"),e.Representation_asArray&&e.Representation_asArray.length&&e.Representation_asArray.length>0&&e.Representation_asArray[0].hasOwnProperty(o.default.CODECS)&&(0===(l=e.Representation_asArray[0].codecs).search(i.default.STPP)||0===l.search(i.default.WVTT)))return t===i.default.FRAGMENTED_TEXT;if(u){if(u.length>1)return t===i.default.MUXED;u[0]&&u[0].contentType===t&&(c=!0,f=!0)}if(e.hasOwnProperty(o.default.MIME_TYPE)&&(c=s.test(e.mimeType),f=!0),!f)for(n=0,r=e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0;!f&&n<r;)(a=e.Representation_asArray[n]).hasOwnProperty(o.default.MIME_TYPE)&&(c=s.test(a.mimeType),f=!0),n++;return c}function T(e){return y(e,i.default.AUDIO)}function A(e){return y(e,i.default.VIDEO)}function C(e){return y(e,i.default.FRAGMENTED_TEXT)}function D(e){return y(e,i.default.MUXED)}function P(e){return"text/vtt"===e||"application/ttml+xml"===e}function R(e){return e&&e.hasOwnProperty(o.default.ROLE_ASARRAY)?e.Role_asArray:[]}function w(e){return R(e).filter(function(e){return e.value===o.default.MAIN})[0]}function O(e){return e&&void 0!==e.Representation_asArray&&null!==e.Representation_asArray&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth}),e}function I(e,t,n){var r,a=e&&e.Period_asArray&&S(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[],i=void 0,o=[];for(i=0,r=a.length;i<r;i++)y(a[i],n)&&o.push(O(a[i]));return o}function k(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===o.default.DYNAMIC),t}function N(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=l.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty(o.default.ID)&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n}function M(e,t){var n=[],r=void 0;if(!e)return n;for(r=0;r<e.length;r++){var a=new _.default;if(a.timescale=1,a.representation=t,!e[r].hasOwnProperty(i.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");a.schemeIdUri=e[r].schemeIdUri,e[r].hasOwnProperty(o.default.TIMESCALE)&&(a.timescale=e[r].timescale),e[r].hasOwnProperty(o.default.VALUE)&&(a.value=e[r].value),n.push(a)}return n}return{getIsTypeOf:y,getIsAudio:T,getIsVideo:A,getIsText:function(e){return y(e,i.default.TEXT)},getIsMuxed:D,getIsTextTrack:P,getIsFragmentedText:C,getIsMain:w,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(o.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(o.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:R,getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(o.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(o.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,n){var r=t&&t.Period_asArray&&S(n)&&t.Period_asArray[n]?t.Period_asArray[n].AdaptationSet_asArray:null;return r&&S(e)?r[e]:null},getIndexForAdaptation:function(e,n,r){var a=n&&n.Period_asArray&&S(r)&&n.Period_asArray[r]?n.Period_asArray[r].AdaptationSet_asArray:[],i=a.length;if(e)for(var o=0;o<i;o++)if((0,p.default)(t).getInstance().areEqual(a[o],e))return o;return-1},getAdaptationForId:function(e,t,n){var r,a=t&&t.Period_asArray&&S(n)&&t.Period_asArray[n]?t.Period_asArray[n].AdaptationSet_asArray:[],i=void 0;for(i=0,r=a.length;i<r;i++)if(a[i].hasOwnProperty(o.default.ID)&&a[i].id===e)return a[i];return null},getAdaptationsForType:I,getAdaptationForType:function(e,t,n,r){var a=I(e,t,n);if(!a||0===a.length)return null;if(a.length>1&&r){for(var i=E.getCurrentTrackFor(n,r),o=m.getAllMediaInfoForType(r,n),u=0,s=a.length;u<s;u++)if(i&&E.isTracksEqual(i,o[u]))return a[u];for(var l=0,c=a.length;l<c;l++)if(w(a[l]))return a[l]}return a[0]},getCodec:function(e,t){if(e&&e.Representation_asArray&&e.Representation_asArray.length>0){var n=S(t)&&t>=0&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];return n.mimeType+';codecs="'+n.codecs+'"'}return null},getMimeType:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length>0?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(o.default.CENC_DEFAULT_KID)?e[o.default.CENC_DEFAULT_KID]:null},getContentProtectionData:function(e){return e&&e.hasOwnProperty(o.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:k,getIsDVB:function(e){return function(e,t){var n=!1;return e&&e.profiles&&e.profiles.length>0&&(n=-1!==e.profiles.indexOf("urn:dvb:dash:profile:dvb-dash:2014")),n}(e)},getDuration:function(e){return e&&e.hasOwnProperty(o.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:r.default||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(o.default.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getRepresentationCount:function(e){return e&&e.Representation_asArray&&e.Representation_asArray.length?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){if(!e||!e.Representation_asArray||!e.Representation_asArray.length)return null;var t=O(e).Representation_asArray,n=t.length,r=[],a=0;for(a=0;a<n;a++)r.push({bandwidth:t[a].bandwidth,width:t[a].width||0,height:t[a].height||0,scanType:t[a].scanType||null});return r},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&t.Representation_asArray.length>0&&S(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t=[],n=void 0,r=void 0,a=void 0,i=void 0,s=void 0,l=void 0,c=void 0;if(e&&e.period&&S(e.period.index)){var f=e.period.mpd.manifest.Period_asArray[e.period.index];f&&f.AdaptationSet_asArray&&S(e.index)&&(i=O(f.AdaptationSet_asArray[e.index]))}for(l=0;i&&l<i.Representation_asArray.length;l++)s=i.Representation_asArray[l],(n=new u.default).index=l,n.adaptation=e,s.hasOwnProperty(o.default.ID)&&(n.id=s.id),s.hasOwnProperty(o.default.CODECS)&&(n.codecs=s.codecs),s.hasOwnProperty(o.default.CODEC_PRIVATE_DATA)&&(n.codecPrivateData=s.codecPrivateData),s.hasOwnProperty(o.default.BANDWITH)&&(n.bandwidth=s.bandwidth),s.hasOwnProperty(o.default.WIDTH)&&(n.width=s.width),s.hasOwnProperty(o.default.HEIGHT)&&(n.height=s.height),s.hasOwnProperty(o.default.SCAN_TYPE)&&(n.scanType=s.scanType),s.hasOwnProperty(o.default.MAX_PLAYOUT_RATE)&&(n.maxPlayoutRate=s.maxPlayoutRate),s.hasOwnProperty(o.default.SEGMENT_BASE)?(a=s.SegmentBase,n.segmentInfoType=o.default.SEGMENT_BASE):s.hasOwnProperty(o.default.SEGMENT_LIST)?(a=s.SegmentList).hasOwnProperty(o.default.SEGMENT_TIMELINE)?(n.segmentInfoType=o.default.SEGMENT_TIMELINE,(!(c=a.SegmentTimeline.S_asArray[a.SegmentTimeline.S_asArray.length-1]).hasOwnProperty("r")||c.r>=0)&&(n.useCalculatedLiveEdgeTime=!0)):(n.segmentInfoType=o.default.SEGMENT_LIST,n.useCalculatedLiveEdgeTime=!0):s.hasOwnProperty(o.default.SEGMENT_TEMPLATE)?((a=s.SegmentTemplate).hasOwnProperty(o.default.SEGMENT_TIMELINE)?(n.segmentInfoType=o.default.SEGMENT_TIMELINE,(!(c=a.SegmentTimeline.S_asArray[a.SegmentTimeline.S_asArray.length-1]).hasOwnProperty("r")||c.r>=0)&&(n.useCalculatedLiveEdgeTime=!0)):n.segmentInfoType=o.default.SEGMENT_TEMPLATE,a.hasOwnProperty(o.default.INITIALIZATION_MINUS)&&(n.initialization=a.initialization.split("$Bandwidth$").join(s.bandwidth).split("$RepresentationID$").join(s.id))):n.segmentInfoType=o.default.BASE_URL,a&&(a.hasOwnProperty(o.default.INITIALIZATION)?(r=a.Initialization).hasOwnProperty(o.default.SOURCE_URL)?n.initialization=r.sourceURL:r.hasOwnProperty(o.default.RANGE)&&(n.range=r.range):s.hasOwnProperty(o.default.MIME_TYPE)&&P(s.mimeType)&&(n.range=0),a.hasOwnProperty(o.default.TIMESCALE)&&(n.timescale=a.timescale),a.hasOwnProperty(o.default.DURATION)&&(n.segmentDuration=a.duration/n.timescale),a.hasOwnProperty(o.default.START_NUMBER)&&(n.startNumber=a.startNumber),a.hasOwnProperty(o.default.INDEX_RANGE)&&(n.indexRange=a.indexRange),a.hasOwnProperty(o.default.PRESENTATION_TIME_OFFSET)&&(n.presentationTimeOffset=a.presentationTimeOffset/n.timescale)),n.MSETimeOffset=g.calcMSETimeOffset(n),n.path=[e.period.index,e.index,l],t.push(n);return t},getAdaptationsForPeriod:function(e){var t=e&&S(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,n=[],r=void 0,a=void 0,u=void 0;if(t&&t.AdaptationSet_asArray)for(u=0;u<t.AdaptationSet_asArray.length;u++)a=t.AdaptationSet_asArray[u],r=new s.default,a.hasOwnProperty(o.default.ID)&&(r.id=a.id),r.index=u,r.period=e,D(a)?r.type=i.default.MUXED:T(a)?r.type=i.default.AUDIO:A(a)?r.type=i.default.VIDEO:C(a)?r.type=i.default.FRAGMENTED_TEXT:r.type=i.default.TEXT,n.push(r);return n},getRegularPeriods:function(e){var t,n=!!e&&k(e.manifest),r=[],a=null,i=null,u=null,s=null,c=void 0;for(c=0,t=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;c<t;c++)(i=e.manifest.Period_asArray[c]).hasOwnProperty(o.default.START)?(s=new l.default).start=i.start:null!==a&&i.hasOwnProperty(o.default.DURATION)&&null!==u?((s=new l.default).start=u.start+u.duration,s.duration=i.duration):0!==c||n||((s=new l.default).start=0),null!==u&&isNaN(u.duration)&&(u.duration=s.start-u.start),null!==s&&(s.id=N(i,c)),null!==s&&i.hasOwnProperty(o.default.DURATION)&&(s.duration=i.duration),null!==s&&(s.index=c,s.mpd=e,r.push(s),a=i,u=s),i=null,s=null;return 0===r.length?r:(null!==u&&isNaN(u.duration)&&(u.duration=function(e){var t=k(e.mpd.manifest),n=void 0;if(e.mpd.manifest.mediaPresentationDuration)n=e.mpd.manifest.mediaPresentationDuration;else if(e.duration)n=e.duration;else{if(!t)throw new Error("Must have @mediaPresentationDuratio on MPD or an explicit @duration on the last period.");n=Number.POSITIVE_INFINITY}return n}(u)-u.start),r)},getMpd:function(e){var t=new c.default;return e&&(t.manifest=e,e.hasOwnProperty(o.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):t.availabilityStartTime=new Date(e.loadedTime.getTime()),e.hasOwnProperty(o.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(o.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(o.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(i.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(o.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(o.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration)),t},getEventsForPeriod:function(e){var t=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,n=t?t.Period_asArray:null,r=n&&e&&S(e.index)?n[e.index].EventStream_asArray:null,a=[],u=void 0,s=void 0;if(r)for(u=0;u<r.length;u++){var l=new _.default;if(l.period=e,l.timescale=1,!r[u].hasOwnProperty(i.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(l.schemeIdUri=r[u].schemeIdUri,r[u].hasOwnProperty(o.default.TIMESCALE)&&(l.timescale=r[u].timescale),r[u].hasOwnProperty(o.default.VALUE)&&(l.value=r[u].value),s=0;s<r[u].Event_asArray.length;s++){var c=new d.default;c.presentationTime=0,c.eventStream=l,r[u].Event_asArray[s].hasOwnProperty(o.default.PRESENTATION_TIME)&&(c.presentationTime=r[u].Event_asArray[s].presentationTime),r[u].Event_asArray[s].hasOwnProperty(o.default.DURATION)&&(c.duration=r[u].Event_asArray[s].duration),r[u].Event_asArray[s].hasOwnProperty(o.default.ID)&&(c.id=r[u].Event_asArray[s].id),a.push(c)}}return a},getEventStreamForAdaptationSet:function(e,t){var n=void 0,r=void 0,a=void 0;return e&&e.Period_asArray&&t&&t.period&&S(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&S(t.index)&&(a=r.AdaptationSet_asArray[t.index])&&(n=a.InbandEventStream_asArray),M(n,null)},getEventStreamForRepresentation:function(e,t){var n=void 0,r=void 0,a=void 0,i=void 0;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&S(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&S(t.adaptation.index)&&(a=r.AdaptationSet_asArray[t.adaptation.index])&&a.Representation_asArray&&S(t.index)&&(i=a.Representation_asArray[t.index])&&(n=i.InbandEventStream_asArray),M(n,t)},getUTCTimingSources:function(e){var t=k(e),n=!!e&&e.hasOwnProperty(o.default.AVAILABILITY_START_TIME),r=e?e.UTCTiming_asArray:null,a=[];return(t||n)&&r&&r.forEach(function(e){var t=new f.default;e.hasOwnProperty(i.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(o.default.VALUE)&&(t.value=e.value.toString(),a.push(t)))}),a},getBaseURLsFromElement:function(e){var t=[],r=!1;return(e.BaseURL_asArray||[e.baseUri]).some(function(a){if(a){var i=new h.default,u=a.__text||a;return n.isRelative(u)&&(r=!0,e.baseUri&&(u=n.resolve(u,e.baseUri))),i.url=u,a.hasOwnProperty(o.default.SERVICE_LOCATION)&&a.serviceLocation.length?i.serviceLocation=a.serviceLocation:i.serviceLocation=u,a.hasOwnProperty(o.default.DVB_PRIORITY)&&(i.dvb_priority=a[o.default.DVB_PRIORITY]),a.hasOwnProperty(o.default.DVB_WEIGHT)&&(i.dvb_weight=a[o.default.DVB_WEIGHT]),t.push(i),r}}),t},getRepresentationSortFunction:function(){return function(e,t){return e.bandwidth-t.bandwidth}},getLocation:function(e){if(e&&e.hasOwnProperty(i.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location}}}m.__dashjs_factory_name="DashManifestModel",t.default=E.default.getSingletonFactory(m),e.exports=t.default},function(e,t){e.exports=c},function(e,t){e.exports=f},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),a=i(n(4));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.segmentAvailabilityRange=null,this.availableSegmentsNumber=0,this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN}return e.hasInitialization=function(e){return null!==e.initialization||(e.segmentInfoType!==a.default.BASE_URL||e.segmentInfoType!==a.default.SEGMENT_BASE)&&null!==e.range},e.hasSegments=function(e){return e.segmentInfoType!==a.default.BASE_URL&&e.segmentInfoType!==a.default.SEGMENT_BASE&&!e.indexRange},e}();t.default=o,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r};t.default=function e(){(0,a.default)(this,e),this.period=null,this.index=-1,this.type=null},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=function e(){(0,a.default)(this,e),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null};i.DEFAULT_ID="defaultId",t.default=i,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r};t.default=function e(){(0,a.default)(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r};t.default=function e(){(0,a.default)(this,e),this.schemeIdUri="",this.value=""},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r};t.default=function e(){(0,a.default)(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,a=(r=n(0))&&r.__esModule?r:{default:r};t.default=function e(){(0,a.default)(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri=""},e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),a=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){(0,r.default)(this,e),this.x=t}return e.prototype.calcSegmentAvailabilityRange=function(e){return this.x.calcSegmentAvailabilityRange(e,this.P)},(0,a.default)(e,[{key:"isLive",set:function(e){this.P=e}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(61)),a=d(n(62)),i=d(n(16)),o=d(n(0)),u=d(n(5)),s=d(n(17)),l=d(n(63)),c=d(n(19)),f=n(68);function d(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,o.default)(this,e),this.O=t}return e.prototype.update=function(e){this.L=e,this.O.isLive=this.isLive(),this.U()},e.prototype.U=function(){var e=this;this.B=[],this.q=new i.default,this.L.Period_asArray.forEach(function(t,n){t.id=(0,f.getPeriodId)(t,n),t.start=(0,f.getPeriodStart)(t,n,e.isLive()),t.idx=n,t.AdaptationSet_asArray.forEach(function(r,a){r.idx=a,r.Representation_asArray.forEach(function(i,o){var u=(0,f.getRepresentationType)(r,i);if(u){i.type=u,i.adaptationSet=r,i.period=t,i.idx=o;var c=new s.default({periodIdx:n,adaptationSetIdx:a,representationIdx:o,type:u,bitrate:i.bandwidth});e.B.push(c);var d=l.default.create(e.O,c,i);e.q.set(c,d)}})})})},e.prototype.getTrackList=function(){return this.B},e.prototype.getTrackViewByIdentifier=function(e){for(var t=0;t<this.L.Period_asArray.length;t++)for(var n=this.L.Period_asArray[t],r=0;r<n.AdaptationSet_asArray.length;r++)for(var a=n.AdaptationSet_asArray[r],i=0;i<a.Representation_asArray.length;i++){var o=a.Representation_asArray[i];if((void 0!==e.periodId&&e.periodId===n.id||!isNaN(e.periodStart)&&e.periodStart===n.start)&&e.representationId===o.id)return new s.default({periodIdx:t,adaptationSetIdx:r,representationIdx:i,type:o.type,bitrate:o.bandwidth})}return null},e.prototype.getSegmentList=function(e,t,n){var i=!0,o=!1,u=void 0;try{for(var s,l=(0,a.default)(this.q);!(i=(s=l.next()).done);i=!0){var c=(0,r.default)(s.value,2),f=c[0],d=c[1];if(f.isEqual(e))return d.getSegmentList(t,n)}}catch(e){o=!0,u=e}finally{try{!i&&l.return&&l.return()}finally{if(o)throw u}}return[]},e.prototype.getSegmentViewByUrl=function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,u=(0,a.default)(this.q.values());!(n=(o=u.next()).done);n=!0){var s=o.value.getSegmentViewByUrl(e,t);if(s)return s}}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}return null},e.prototype.setSegmentOffsetListForTrack=function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,u=(0,a.default)(this.q.values());!(n=(o=u.next()).done);n=!0){var s=o.value;if(s.getBaseUrl()===e&&s instanceof c.default)return void s.setIndexData(t)}}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}},e.prototype.getSegmentTime=function(e){return e.timeStamp},e.prototype.getSegmentDuration=function(e){return e.duration||0},e.prototype.getTrackBitrate=function(e){return e.bitrate},e.prototype.isLive=function(){return"dynamic"===this.L.type},(0,u.default)(e,[{key:"manifestUrl",get:function(){return this.L.url}}]),e}();t.default=h,e.exports=t.default},function(e,t){e.exports=d},function(e,t){e.exports=h},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(0)),a=l(n(4)),i=l(n(64)),o=l(n(66)),u=l(n(67)),s=l(n(19));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,r.default)(this,e)}return e.create=function(e,t,n){if(n.hasOwnProperty(a.default.SEGMENT_BASE))return new s.default(t,n);if(n.hasOwnProperty(a.default.SEGMENT_LIST)&&void 0!==n.SegmentList){if(n.SegmentList.hasOwnProperty(a.default.SEGMENT_TIMELINE))throw new Error("SegmentList with SegmentTimeLine manifest is not supported.");return new i.default(t,n)}if(n.hasOwnProperty(a.default.SEGMENT_TEMPLATE)&&void 0!==n.SegmentTemplate)return n.SegmentTemplate.hasOwnProperty(a.default.SEGMENT_TIMELINE)?new u.default(t,n):new o.default(t,n,e);throw new Error("BaseUrl manifest is not supported.")},e}();t.default=c,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(7)),i=n(65);function o(e){return e&&e.__esModule?e:{default:e}}var u=n(6),s=function(){function e(t,n){if((0,r.default)(this,e),this.y=t,void 0===n.SegmentList)throw new Error("SegmentList not found in representation.");this.$=n.SegmentList,this.z=this.$.timescale?this.$.duration/this.$.timescale:this.$.duration,this.V=isNaN(this.$.startNumber)?1:this.$.startNumber;var a=new u(n.resolvedBaseURL.url);this._=a.host+a.pathname}return e.prototype.getBaseUrl=function(){return this._},e.prototype.getSegmentList=function(e,t){for(var n=[],r=e+t,i=void 0,o=0;o<this.$.SegmentURL_asArray.length;o++)if(e<=(i=(this.V-1+o)*this.z)&&i<=r){var u=new a.default({timeStamp:i,duration:this.z,trackView:this.y});n.push(u)}else if(i>r)return n;return n},e.prototype.getSegmentViewByUrl=function(e){for(var t=new u(e),n=t.host+t.pathname,r=void 0,o=0;o<this.$.SegmentURL_asArray.length;o++)if(r=this.$.SegmentURL_asArray[o],n===((0,i.isRelative)(r.media)?this._+r.media:r.media)){var s=(this.V-1+o)*this.z;return new a.default({timeStamp:s,duration:this.z,trackView:this.y})}return null},e}();t.default=s,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=/^[a-z][a-z0-9+\-.]*:/i;t.isRelative=function(e){return!r.test(e)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(7)),i=n(18);function o(e){return e&&e.__esModule?e:{default:e}}var u=n(6),s=function(){function e(t,n,a){if((0,r.default)(this,e),this.y=t,this.O=a,void 0===n.SegmentTemplate)throw new Error("SegmentTemplate not found in representation.");this.W=n,this.Z=n.SegmentTemplate,this.z=this.Z.timescale?this.Z.duration/this.Z.timescale:this.Z.duration,this.V=isNaN(this.Z.startNumber)?1:this.Z.startNumber;var o=new u(this.Z.media,n.resolvedBaseURL.url),s=o.host+o.pathname;s=(0,i.inlineRepresentationId)(s,n.id),s=(0,i.inlineBandwidth)(s,n.bandwidth),this.H=(0,i.getSegmentNumberRegexp)(s)}return e.prototype.getBaseUrl=function(){return null},e.prototype.getSegmentList=function(e,t){for(var n=this.O.calcSegmentAvailabilityRange(this.W),r=Math.floor(n.start/this.z),i=r+Math.ceil((n.end-n.start)/this.z)-1,o=[],u=e+t,s=void 0,l=void 0,c=r;c<=i;c++)if(e<=(s=this.W.period.start+c*this.z)&&s<=u)l=new a.default({timeStamp:s,duration:this.z,trackView:this.y}),o.push(l);else if(s>u)return o;return o},e.prototype.getSegmentViewByUrl=function(e){var t=e.match(this.H);if(!t||2!==t.length)return null;var n=(Number(t[1])-this.V)*this.z;return new a.default({timeStamp:n,duration:this.z,trackView:this.y})},e}();t.default=s,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(7)),i=n(18);function o(e){return e&&e.__esModule?e:{default:e}}var u=n(6),s=function(){function e(t,n){if((0,r.default)(this,e),this.y=t,void 0===n.SegmentTemplate)throw new Error("SegmentTemplate not found in representation.");if(void 0===n.SegmentTemplate.SegmentTimeline)throw new Error("SegmentTimeline not found in representation.SegmentTemplate.");this.Z=n.SegmentTemplate,this.V=isNaN(this.Z.startNumber)?1:this.Z.startNumber;var a=new u(this.Z.media,n.resolvedBaseURL.url),o=a.host+a.pathname;o=(0,i.inlineRepresentationId)(o,n.id),o=(0,i.inlineBandwidth)(o,n.bandwidth),this.X=(0,i.getSegmentTimeRegexp)(o),this.H=(0,i.getSegmentNumberRegexp)(o)}return e.prototype.getBaseUrl=function(){return null},e.prototype.getSegmentList=function(e,t){var n=this,r=[],i=e+t;return this.K(function(t,o){if(e<=t&&t<=i){var u=new a.default({timeStamp:t,duration:o,trackView:n.y});r.push(u)}else if(t>i)return r}),r},e.prototype.getSegmentViewByUrl=function(e){var t=e.match(this.X),n=e.match(this.H);return t&&2===t.length?this.Y(Number(t[1])):n&&2===n.length?this.G(Number(n[1])):null},e.prototype.Y=function(e){var t=this,n=this.Z.timescale?e/this.Z.timescale:e,r=null;return this.K(function(e,i){n===e&&(r=new a.default({timeStamp:e,duration:i,trackView:t.y}))}),null===r&&(r=new a.default({timeStamp:n,duration:0,trackView:this.y})),r},e.prototype.G=function(e){var t=this,n=null,r=e-this.V;return this.K(function(e,i,o){o===r&&(n=new a.default({timeStamp:e,duration:i,trackView:t.y}))}),n},e.prototype.K=function(e){for(var t=void 0,n=void 0,r=void 0,a=0,i=0,o=-1,u=this.Z.timescale,s=this.Z.SegmentTimeline.S_asArray,l=0;l<s.length;l++){n=0,(t=s[l]).hasOwnProperty("r")&&(n=Number(t.r)),t.hasOwnProperty("t")&&(i=(a=Number(t.t))/u),r=t.d/u;for(var c=0;c<=n;c++){if(o++,void 0===i)throw new Error("Invalid timestamp.");if(e(i,r,o))return;i=(a+=t.d)/u}}},e}();t.default=s,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.getPeriodId=function(e,t){var n="defaultId_"+t;return e.hasOwnProperty("id")&&e.id.length>0&&"__proto__"!==e.id&&(n=e.id),n},t.getPeriodStart=function(e,t,n){if(t>0)throw new Error("Multi-period manifests are not supported yet.");if(e.hasOwnProperty("start"))return e.start;if(0!==t||n)throw new Error("@start attribute is missing for Period.");return 0},t.getRepresentationType=function(e,t){var n=void 0,r=e.mimeType||t.mimeType;return r&&(0===r.indexOf("video")?n="video":0===r.indexOf("audio")&&(n="audio")),n}}])},"object"==(0,l.default)(t)&&"object"==(0,l.default)(e)?e.exports=o(n(1),n(11),n(12),n(2),n(20),n(54),n(250),n(82),n(179),n(83),n(17)):(a=[n(1),n(11),n(12),n(2),n(20),n(54),n(250),n(82),n(179),n(83),n(17)],void 0===(i="function"==typeof(r=o)?r.apply(t,a):r)||(e.exports=i))}).call(this,n(164)(e))},function(e,t,n){n(491),e.exports=n(8).Object.keys},function(e,t,n){var r=n(79),a=n(93);n(78)("keys",function(){return function(e){return a(r(e))}})},function(e,t,n){var r=n(69),a=n(124),i=n(493);e.exports=function(e){return function(t,n,o){var u,s=r(t),l=a(s.length),c=i(o,l);if(e&&n!=n){for(;l>c;)if((u=s[c++])!=u)return!0}else for(;l>c;c++)if((e||c in s)&&s[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var r=n(166),a=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?a(e+t,0):i(e,t)}},function(e,t,n){n(495);var r=n(8).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(10);r(r.S+r.F*!n(37),"Object",{defineProperty:n(36).f})},function(e,t,n){e.exports={default:n(497),__esModule:!0}},function(e,t,n){n(70),n(81),e.exports=n(171).f("iterator")},function(e,t,n){var r=n(166),a=n(123);e.exports=function(e){return function(t,n){var i,o,u=String(a(t)),s=r(n),l=u.length;return s<0||s>=l?e?"":void 0:(i=u.charCodeAt(s))<55296||i>56319||s+1===l||(o=u.charCodeAt(s+1))<56320||o>57343?e?u.charAt(s):i:e?u.slice(s,s+2):o-56320+(i-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(126),a=n(91),i=n(96),o={};n(53)(o,n(23)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(o,{next:a(1,n)}),i(e,t+" Iterator")}},function(e,t,n){"use strict";var r=n(501),a=n(238),i=n(80),o=n(69);e.exports=n(170)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,a(1)):a(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t,n){e.exports={default:n(503),__esModule:!0}},function(e,t,n){n(504),n(128),n(506),n(507),e.exports=n(8).Symbol},function(e,t,n){"use strict";var r=n(21),a=n(67),i=n(37),o=n(10),u=n(234),s=n(121).KEY,l=n(52),c=n(168),f=n(96),d=n(122),h=n(23),_=n(171),p=n(172),v=n(505),E=n(239),g=n(44),m=n(24),S=n(69),y=n(163),T=n(91),A=n(126),C=n(240),D=n(174),P=n(36),R=n(93),w=D.f,O=P.f,I=C.f,k=r.Symbol,N=r.JSON,M=N&&N.stringify,b=h("_hidden"),L=h("toPrimitive"),U={}.propertyIsEnumerable,x=c("symbol-registry"),F=c("symbols"),B=c("op-symbols"),H=Object.prototype,G="function"==typeof k,j=r.QObject,V=!j||!j.prototype||!j.prototype.findChild,q=i&&l(function(){return 7!=A(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=w(H,t);r&&delete H[t],O(e,t,n),r&&e!==H&&O(H,t,r)}:O,W=function(e){var t=F[e]=A(k.prototype);return t._k=e,t},K=G&&"symbol"==typeof k.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof k},Y=function(e,t,n){return e===H&&Y(B,t,n),g(e),t=y(t,!0),g(n),a(F,t)?(n.enumerable?(a(e,b)&&e[b][t]&&(e[b][t]=!1),n=A(n,{enumerable:T(0,!1)})):(a(e,b)||O(e,b,T(1,{})),e[b][t]=!0),q(e,t,n)):O(e,t,n)},X=function(e,t){g(e);for(var n,r=v(t=S(t)),a=0,i=r.length;i>a;)Y(e,n=r[a++],t[n]);return e},z=function(e){var t=U.call(this,e=y(e,!0));return!(this===H&&a(F,e)&&!a(B,e))&&(!(t||!a(this,e)||!a(F,e)||a(this,b)&&this[b][e])||t)},Q=function(e,t){if(e=S(e),t=y(t,!0),e!==H||!a(F,t)||a(B,t)){var n=w(e,t);return!n||!a(F,t)||a(e,b)&&e[b][t]||(n.enumerable=!0),n}},Z=function(e){for(var t,n=I(S(e)),r=[],i=0;n.length>i;)a(F,t=n[i++])||t==b||t==s||r.push(t);return r},$=function(e){for(var t,n=e===H,r=I(n?B:S(e)),i=[],o=0;r.length>o;)!a(F,t=r[o++])||n&&!a(H,t)||i.push(F[t]);return i};G||(u((k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(n){this===H&&t.call(B,n),a(this,b)&&a(this[b],e)&&(this[b][e]=!1),q(this,e,T(1,n))};return i&&V&&q(H,e,{configurable:!0,set:t}),W(e)}).prototype,"toString",function(){return this._k}),D.f=Q,P.f=Y,n(241).f=C.f=Z,n(127).f=z,n(173).f=$,i&&!n(95)&&u(H,"propertyIsEnumerable",z,!0),_.f=function(e){return W(h(e))}),o(o.G+o.W+o.F*!G,{Symbol:k});for(var J="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;J.length>ee;)h(J[ee++]);for(var te=R(h.store),ne=0;te.length>ne;)p(te[ne++]);o(o.S+o.F*!G,"Symbol",{for:function(e){return a(x,e+="")?x[e]:x[e]=k(e)},keyFor:function(e){if(!K(e))throw TypeError(e+" is not a symbol!");for(var t in x)if(x[t]===e)return t},useSetter:function(){V=!0},useSimple:function(){V=!1}}),o(o.S+o.F*!G,"Object",{create:function(e,t){return void 0===t?A(e):X(A(e),t)},defineProperty:Y,defineProperties:X,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:$}),N&&o(o.S+o.F*(!G||l(function(){var e=k();return"[null]"!=M([e])||"{}"!=M({a:e})||"{}"!=M(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],a=1;arguments.length>a;)r.push(arguments[a++]);if(n=t=r[1],(m(t)||void 0!==e)&&!K(e))return E(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!K(t))return t}),r[1]=t,M.apply(N,r)}}),k.prototype[L]||n(53)(k.prototype,L,k.prototype.valueOf),f(k,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(e,t,n){var r=n(93),a=n(173),i=n(127);e.exports=function(e){var t=r(e),n=a.f;if(n)for(var o,u=n(e),s=i.f,l=0;u.length>l;)s.call(e,o=u[l++])&&t.push(o);return t}},function(e,t,n){n(172)("asyncIterator")},function(e,t,n){n(172)("observable")},function(e,t,n){e.exports={default:n(509),__esModule:!0}},function(e,t,n){n(510),e.exports=n(8).Object.setPrototypeOf},function(e,t,n){var r=n(10);r(r.S,"Object",{setPrototypeOf:n(511).set})},function(e,t,n){var r=n(24),a=n(44),i=function(e,t){if(a(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(47)(Function.call,n(174).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return i(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:i}},function(e,t,n){e.exports={default:n(513),__esModule:!0}},function(e,t,n){n(514);var r=n(8).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){var r=n(10);r(r.S,"Object",{create:n(126)})},function(e,t,n){n(128),n(70),n(81),n(516),n(520),n(522),n(523),e.exports=n(8).Map},function(e,t,n){"use strict";var r=n(242),a=n(178);e.exports=n(246)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(a(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(a(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){var r=n(47),a=n(165),i=n(79),o=n(124),u=n(518);e.exports=function(e,t){var n=1==e,s=2==e,l=3==e,c=4==e,f=6==e,d=5==e||f,h=t||u;return function(t,u,_){for(var p,v,E=i(t),g=a(E),m=r(u,_,3),S=o(g.length),y=0,T=n?h(t,S):s?h(t,0):void 0;S>y;y++)if((d||y in g)&&(v=m(p=g[y],y,E),e))if(n)T[y]=v;else if(v)switch(e){case 3:return!0;case 5:return p;case 6:return y;case 2:T.push(p)}else if(c)return!1;return f?-1:l||c?c:T}}},function(e,t,n){var r=n(519);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(24),a=n(239),i=n(23)("species");e.exports=function(e){var t;return a(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!a(t.prototype)||(t=void 0),r(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var r=n(10);r(r.P+r.R,"Map",{toJSON:n(247)("Map")})},function(e,t,n){var r=n(97);e.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},function(e,t,n){n(248)("Map")},function(e,t,n){n(249)("Map")},function(e,t,n){n(525),e.exports=9007199254740991},function(e,t,n){var r=n(10);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){n(527),e.exports=n(8).Number.isInteger},function(e,t,n){var r=n(10);r(r.S,"Number",{isInteger:n(528)})},function(e,t,n){var r=n(24),a=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&a(e)===e}},function(e,t,n){e.exports={default:n(530),__esModule:!0}},function(e,t,n){n(81),n(70),e.exports=n(531)},function(e,t,n){var r=n(129),a=n(23)("iterator"),i=n(80);e.exports=n(8).isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||i.hasOwnProperty(r(t))}},function(e,t,n){n(81),n(70),e.exports=n(533)},function(e,t,n){var r=n(44),a=n(177);e.exports=n(8).getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return r(t.call(e))}},function(e,t,n){"use strict";(function(e){var r,a,i,o,u=c(n(92)),s=c(n(125)),l=c(n(54));function c(e){return e&&e.__esModule?e:{default:e}}o=function(e,t,n,r,a,i,o){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||(0,s.default)(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.isAbsolute=function(e){return!!e&&(0===e.indexOf("http")||0===e.indexOf("//"))},t.removeTrailingSlash=function(e){return e.replace(/\/\?/,"?")},t.forgeTrackUrlKey=function(e,t){return o(e,!!t&&!!t.includeQueryInTrackKey)},t.forgeSegmentUrlKey=function(e,t){var n=o(e,!1);return t?function(e,t){var n=e,r=[];if("string"==typeof t){var a=/bytes=(\d+)-?(\d+)?/i.exec(t);a&&a.length>1&&(r.push(Number(a[1])),3!==a.length||isNaN(a[2])||r.push(Number(a[2])+1))}else t instanceof Array&&(r=t.slice());return r&&r.length>0&&(n=n+"?rangeStart="+r[0],2===r.length&&(n=n+"&rangeEnd="+r[1])),n}(n,t):n};var r=i(n(11)),a=i(n(12));function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=new r.default((0,a.default)(e));return""+n.host+n.pathname+(t?n.query:"")}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),a=i(n(4));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){(0,r.default)(this,e),this.sn=t.sn,this.trackView=new a.default(t.trackView),this.time=t.time,this.duration=t.duration,void 0!==t.urlHash&&(this.urlHash=t.urlHash.toString(36))}return e.prototype.isEqual=function(e){if(!e)return!1;var t=e.urlHash,n=e.sn,r=e.trackView;return void 0===this.urlHash?this.sn===n&&this.trackView.isEqual(r):this.urlHash===t&&this.trackView.isEqual(r)},e.prototype.isInTrack=function(e){return this.trackView.isEqual(e)},e.prototype.viewToString=function(){return void 0===this.urlHash?this.trackView.viewToString()+"S"+this.sn:this.trackView.viewToString()+"S"+this.sn+"H"+this.urlHash},e.prototype.getId=function(){return this.sn},e}();t.default=o,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(0)),a=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){(0,r.default)(this,e),this.level=t.level,this.urlId=t.urlId,this.bitrate=t.bitrate}return e.prototype.viewToString=function(){return"L"+this.level+"U"+this.urlId},e.prototype.isEqual=function(e){return!!e&&e.level===this.level&&e.urlId===this.urlId},(0,a.default)(e,[{key:"type",get:function(){return"video"}}]),e}();t.default=o,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(0)),a=s(n(1)),i=s(n(6)),o=s(n(13)),u=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){},c=function(){function e(t){(0,r.default)(this,e),this.onLevelLoaded=l,this.onMediaMapCreated=l,this.r=t||{},this.t=new i.default,this.t.onLevelLoaded=this.e.bind(this),this.t.onManifestLoaded=this.u.bind(this),this.a=!1}return e.prototype.updateManifest=function(e,t){this.t.update(e,t)},e.prototype.e=function(e){var t=e.level,n=e.id,r=e.details;this.f.levels&&t>=0&&t<this.f.levels.length&&(this.h.updateLevel(t,n,r),this.a||(this.onMediaMapCreated(this.h),this.a=!0),this.onLevelLoaded(e))},e.prototype.u=function(e){this.f=e,this.h=new o.default(this.f,this.r)},(0,a.default)(e,[{key:"integrationVersion",get:function(){return"v5h1"}},{key:"SegmentView",get:function(){return u.default}}]),e}();t.default=c,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(0)),a=o(n(1)),i=o(n(7));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,r.default)(this,e),this.v=new i.default}return e.prototype.update=function(e,t){var n=e.toString("utf8");this.v.load(n,t)},(0,a.default)(e,[{key:"onManifestLoaded",set:function(e){this.v.onManifestLoaded=e}},{key:"onLevelLoaded",set:function(e){this.v.onLevelLoaded=e}},{key:"onError",set:function(e){this.v.onError=e}}]),e}();t.default=u,e.exports=t.default},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(0)),a=s(n(1)),i=s(n(8)),o=s(n(9)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2));function s(e){return e&&e.__esModule?e:{default:e}}var l=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,c=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),f=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,d=function(){};function h(e,t){var n=t.split("@",2);if(1===n.length){var r=e.lastByteRangeEndOffset;e.byteRange[0]=r||0}else e.byteRange[0]=parseInt(n[1],10);e.byteRange[1]=parseInt(n[0],10)+e.byteRange[0]}var _=function(){function e(){(0,r.default)(this,e),this.byteRange=[],this.tagList=[]}return(0,a.default)(e,[{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}}]),e}(),p=function(){function e(){(0,r.default)(this,e),this.levels=[],this.onManifestLoaded=d,this.onLevelLoaded=d,this.onError=d}return e.prototype.resolve=function(e,t){return i.default.buildAbsoluteURL(u.removeTrailingSlash(t),e,{alwaysNormalize:!0})},e.prototype.parseMasterPlaylist=function(e,t){var n=[];l.lastIndex=0;for(var r=l.exec(e);r;){var a={},i=new o.default(r[1]);a.attrs=i,a.url=this.resolve(r[2],t);var u=i.decimalResolution("RESOLUTION");u&&(a.width=u.width,a.height=u.height),a.bitrate=i.decimalInteger("AVERAGE-BANDWIDTH")||i.decimalInteger("BANDWIDTH"),a.name=i.NAME,n.push(a),r=l.exec(e)}return n},e.prototype.parseLevelPlaylist=function(e,t,n,r){var a={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},i=0,s=0,l=0,d=null,p=new _,v=void 0;c.lastIndex=0;for(var E=c.exec(e);E;){var g=E[1];if(g){p.duration=parseFloat(g);var m=(" "+E[2]).slice(1);p.title=m||null,p.tagList.push(m?["INF",g,m]:["INF",g])}else if(E[3]){if(!isNaN(p.duration)){var S=i++;p.type=r,p.start=s,p.sn=S,p.level=n,p.cc=l,p.baseurl=t,p.relurl=(" "+E[3]).slice(1),p.url=u.isAbsolute(p.relurl)?p.relurl:this.resolve(p.relurl,p.baseurl),a.fragments.push(p),d=p,s+=p.duration,p=new _}}else if(E[4]){if(d){var y=d.byteRangeEndOffset;y&&(p.lastByteRangeEndOffset=y)}h(p,(" "+E[4]).slice(1))}else if(E[5])p.rawProgramDateTime=(" "+E[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),void 0===a.programDateTime&&(a.programDateTime=new Date(new Date(Date.parse(E[5]))-1e3*s));else{for(E=E[0].match(f),v=1;v<E.length&&void 0===E[v];v++);var T=(" "+E[v+1]).slice(1),A=(" "+E[v+2]).slice(1);switch(E[v]){case"#":p.tagList.push(A?[T,A]:[T]);break;case"PLAYLIST-TYPE":a.type=T.toUpperCase();break;case"MEDIA-SEQUENCE":a.startSN=parseInt(T,10),i=a.startSN;break;case"TARGETDURATION":a.targetduration=parseFloat(T);break;case"VERSION":a.version=parseInt(T,10);break;case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"DIS":l++,p.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":l=parseInt(T,10);break;case"START":var C=new o.default(T).decimalFloatingPoint("TIME-OFFSET");isNaN(C)||(a.startTimeOffset=C);break;case"MAP":var D=new o.default(T);p.relurl=D.URI,h(p,D.BYTERANGE),p.baseurl=t,p.level=n,p.type=r,p.sn="initSegment",a.initSegment=p,p=new _}}E=c.exec(e)}return(p=d)&&!p.relurl&&(a.fragments.pop(),s-=p.duration),a.totalduration=s,a.averagetargetduration=s/a.fragments.length,a.endSN=i-1,a.startCC=a.fragments[0]?a.fragments[0].cc:0,a.endCC=l,a},e.prototype.b=function(e){var t=[],n={};return e.forEach(function(e){var r=n[e.bitrate];void 0===r?(e.url=[e.url],n[e.bitrate]=e,t.push(e)):r.url.push(e.url)}),t.sort(function(e,t){return e.bitrate-t.bitrate}),t},e.prototype.load=function(e,t){var n=-1,r=-1;this.levels.every(function(e,a){return!((r=e.url.indexOf(t))>=0&&(n=a,1))});var a=0===this.levels.length||n>=0;if(0===e.indexOf("#EXTM3U"))if(e.indexOf("#EXTINF:")>0){if(a){var i=this.parseLevelPlaylist(e,t,n,"main");if(0===this.levels.length){n=0,r=0;var o=this.b([{bitrate:0,url:t}]);this.levels=o,this.onManifestLoaded({levels:o,url:t})}i.targetduration?this.onLevelLoaded({details:i,level:n,id:r}):this.onError(new Error("invalid targetduration"))}}else{var u=this.parseMasterPlaylist(e,t),s=this.b(u);s.length?(this.levels=s,this.onManifestLoaded({levels:s,url:t})):this.onError(new Error("no level found in manifest"))}else this.onError(new Error("no EXTM3U delimiter"))},e}();t.default=p,e.exports=t.default},function(e,t,n){var r,a,i,o,u;r=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,a=/^([^\/;?#]*)(.*)$/,i=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,u={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=u.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=u.normalizePath(r.path),u.buildURLFromParts(r)}var i=u.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return n.alwaysNormalize?(i.path=u.normalizePath(i.path),u.buildURLFromParts(i)):t;var o=u.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var s=a.exec(o.path);o.netLoc=s[1],o.path=s[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(l.netLoc=o.netLoc,"/"!==i.path[0]))if(i.path){var c=o.path,f=c.substring(0,c.lastIndexOf("/")+1)+i.path;l.path=u.normalizePath(f)}else l.path=o.path,i.params||(l.params=o.params,i.query||(l.query=o.query));return null===l.path&&(l.path=n.alwaysNormalize?u.normalizePath(i.path):i.path),u.buildURLFromParts(l)},parseURL:function(e){var t=r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(i,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=u},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(10)),a=i(n(0));function i(e){return e&&e.__esModule?e:{default:e}}var o=/^(\d+)x(\d+)$/,u=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,s=function(){function e(t){(0,a.default)(this,e);var n="string"==typeof t?e.parseAttrList(t):t;for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r])}return e.prototype.decimalInteger=function(e){var t=parseInt(this[e],10);return t>r.default?1/0:t},e.prototype.hexadecimalInteger=function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var n=new Uint8Array(t.length/2),r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(2*r,2*r+2),16);return n}return null},e.prototype.hexadecimalIntegerAsNumber=function(e){var t=parseInt(this[e],16);return t>r.default?1/0:t},e.prototype.decimalFloatingPoint=function(e){return parseFloat(this[e])},e.prototype.enumeratedString=function(e){return this[e]},e.prototype.decimalResolution=function(e){var t=o.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},e.parseAttrList=function(e){var t,n={};for(u.lastIndex=0;null!==(t=u.exec(e));){var r=t[2];0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1&&(r=r.slice(1,-1)),n[t[1]]=r}return n},e}();t.default=s,e.exports=t.default},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){var r=new RegExp("%[a-f0-9]{2}","gi"),a=new RegExp("(%[a-f0-9]{2})+","gi");function i(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],i(n),i(r))}function o(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(r),n=1;n<t.length;n++)t=(e=i(t,n).join("")).match(r);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+(void 0===e?"undefined":(0,l.default)(e))+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=a.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=o(n[0]);r!==n[0]&&(t[n[0]]=r)}n=a.exec(e)}t["%C2"]="�";for(var i=(0,u.default)(t),s=0;s<i.length;s++){var l=i[s];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(14)),a=d(n(15)),i=d(n(16)),o=d(n(0)),u=d(n(1)),s=d(n(3)),l=d(n(4)),c=n(17),f=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(2));function d(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,n){(0,o.default)(this,e),this.y=!1,this.f=t,this.r=n,this.w(),this.g()}return e.prototype.T=function(e){for(var t=new i.default,n=e.levels,r=0,a=0,o=n.length;a<o;a++)for(var u=n[a],s=0,l=u.url.length;s<l;s++){var c=u.url[s];t.add(f.forgeTrackUrlKey(c,{includeQueryInTrackKey:!1})),r++}return r!==t.size},e.prototype.g=function(){this.I=[],this.N=new a.default,this.y=this.T(this.f);for(var e=0;e<this.f.levels.length;e++){for(var t=this.f.levels[e],n=0;n<t.url.length;n++){var r=t.url[n],i=new l.default({level:e,urlId:n,bitrate:t.bitrate});this.I.push(i),this.N.set(f.forgeTrackUrlKey(r,{includeQueryInTrackKey:this.y}),i)}this.updateLevel(e,0)}},e.prototype.w=function(){this.R=new a.default,this.X=new a.default},e.prototype.S=function(e,t){var n=e.fragments,r=t.fragments;if(0===n.length||0===r.length)return!1;var a=t.startSN-e.startSN;if(a>=0&&a<n.length){for(var i=n[a].start-r[0].start,o=0;o<r.length;o++)r[o].start+=i;return!0}return!1},e.prototype.j=function(e,t){if(!t.live)return t;if(0===t.fragments.length)return e||t;if(e&&this.S(e,t))return t;var n=!0,a=!1,i=void 0;try{for(var o,u=(0,r.default)(this.f.levels);!(n=(o=u.next()).done);n=!0){var s=o.value;if(s.details&&s.details!==e&&s.details.fragments.length>0&&this.S(s.details,t))return t}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}var l=null,c=0,f=!0,d=!1,h=void 0;try{for(var _,p=(0,r.default)(this.f.levels);!(f=(_=p.next()).done);f=!0){var v=_.value;if(v.details&&v.details.fragments.length>0){var E;E=t.startSN>v.details.startSN?t.startSN-(v.details.startSN+v.details.fragments.length-1):v.details.startSN-(t.startSN+t.fragments.length-1),(!l||E<c)&&(l=v.details,c=E)}}}catch(e){d=!0,h=e}finally{try{!f&&p.return&&p.return()}finally{if(d)throw h}}if(!l)return t;var g=t.fragments,m=l.fragments,S=void 0;if(t.startSN>l.startSN){var y=m[m.length-1],T=t.startSN-(l.startSN+m.length-1);S=y.start+T*y.duration-g[0].start}else{var A=l.fragments[0],C=t.startSN+g.length-1-l.startSN;S=A.start+C*A.duration-g[g.length-1].start}for(var D=0;D<g.length;D++)g[D].start+=S;return t},e.prototype.updateLevel=function(e,t,n){if(e>this.f.levels.length)throw new Error("level does not exist");var r=this.f.levels[e];if(n&&n!==r.details&&(r.details=this.j(r.details,n)),r.details){var i=r.details.fragments,o=this.getTrackViewByUrl(r.url[t]);if(!o)throw new Error("trackView not found");for(var u=[],l=new a.default,d=0;d<i.length;d++){var h=i[d],_=f.forgeSegmentUrlKey(h.url,h.byteRange),p={sn:h.sn,trackView:o,time:h.start,duration:h.duration,urlHash:void 0};this.r.ssaiEnabled&&(p.urlHash=(0,c.hashBytes)(_,_.length));var v=new s.default(p);u.push(v),l.set(_,v)}var E=o.viewToString();this.R.set(E,u),this.X.set(E,l)}},e.prototype.getTrackViewByIdentifier=function(e){return this.getTrackViewByUrl(e.levelUrl)},e.prototype.getTrackViewByUrl=function(e){var t=f.forgeTrackUrlKey(e,{includeQueryInTrackKey:this.y});return this.N.has(t)?this.N.get(t):null},e.prototype.getSegmentViewByUrl=function(e,t){var n=f.forgeSegmentUrlKey(e,t),a=!0,i=!1,o=void 0;try{for(var u,s=(0,r.default)(this.X.values());!(a=(u=s.next()).done);a=!0){var l=u.value;if(l.has(n))return l.get(n)}}catch(e){i=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}return null},e.prototype.getSegmentList=function(e,t,n){if(e.level>this.f.levels.length)throw new Error("getSegmentList: level does not exist");var r=[],a=e.viewToString(),i=this.R.get(a);if(i)for(var o=0;o<i.length;o++){var u=i[o];t<=u.time&&u.time<=t+n&&r.push(u)}return r},e.prototype.getTrackList=function(){return this.I},e.prototype.getSegmentTime=function(e){if(void 0===e.time)throw new Error("getSegmentTime: segmentView.time is undefined");return e.time},e.prototype.getSegmentDuration=function(e){if(void 0===e.duration)throw new Error("getSegmentDuration: segmentView.duration is undefined");return e.duration},e.prototype.getTrackBitrate=function(e){return e.bitrate||0},e.prototype.getStreamInfo=function(){if(0===this.I.length)return{};var e=void 0,t=!0,n=!1,a=void 0;try{for(var i,o=(0,r.default)(this.I);!(t=(i=o.next()).done);t=!0){var u=i.value.viewToString();if(void 0!==(e=this.R.get(u))&&e.length>0)break}}catch(e){n=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw a}}if(void 0===e||0===e.length)return{};var s=0,l=0,c=!0,f=!1,d=void 0;try{for(var h,_=(0,r.default)(e);!(c=(h=_.next()).done);c=!0){var p=h.value;void 0!==p.duration&&(s+=p.duration,l+=1)}}catch(e){f=!0,d=e}finally{try{!c&&_.return&&_.return()}finally{if(f)throw d}}var v=l?s/l:0,E=this.f.levels.length;return{segmentDuration:v,playListLength:e.length,trackCount:E}},e.prototype.isLive=function(){if(this.f.levels){var e=!0,t=!1,n=void 0;try{for(var a,i=(0,r.default)(this.f.levels);!(e=(a=i.next()).done);e=!0){var o=a.value;if(o.details)return!!o.details.live}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}}return!1},(0,u.default)(e,[{key:"manifestUrl",get:function(){return this.f.url}}]),e}();t.default=h,e.exports=t.default},function(e,t){e.exports=a},function(e,t){e.exports=i},function(e,t){e.exports=o},function(e,t,n){function r(e,t){var n=65535&t;return((t-n)*e|0)+(n*e|0)|0}Object.defineProperty(t,"__esModule",{value:!0}),t.hashBytes=function(e,t,n){for(var a=3432918353,i=461845907,o=n,u=-4&t,s=0;s<u;s+=4){var l=255&e[s]|(255&e[s+1])<<8|(255&e[s+2])<<16|(255&e[s+3])<<24;o=5*(o=(524287&(o^=l=r(l=(131071&(l=r(l,a)))<<15|l>>>17,i)))<<13|o>>>19)+3864292196|0}switch(l=0,t%4){case 3:l=(255&e[u+2])<<16;case 2:l|=(255&e[u+1])<<8;case 1:o^=l=r(l=(131071&(l=r(l|=255&e[u],a)))<<15|l>>>17,i)}return o^=t,o=r(o^=o>>>16,2246822507),(o=r(o^=o>>>13,3266489909))^o>>>16}}])},"object"==(0,l.default)(t)&&"object"==(0,l.default)(e)?e.exports=o(n(1),n(2),n(82),n(251),n(17),n(20),n(84)):(a=[n(1),n(2),n(82),n(251),n(17),n(20),n(84)],void 0===(i="function"==typeof(r=o)?r.apply(t,a):r)||(e.exports=i))}).call(this,n(164)(e))},function(e,t,n){"use strict";e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},function(e,t,n){"use strict";var r,a=Object.prototype.hasOwnProperty;function i(e){return decodeURIComponent(e.replace(/\+/g," "))}t.stringify=function(e,t){t=t||"";var n,i,o=[];for(i in"string"!=typeof t&&(t="?"),e)a.call(e,i)&&((n=e[i])||null!==n&&n!==r&&!isNaN(n)||(n=""),o.push(encodeURIComponent(i)+"="+encodeURIComponent(n)));return o.length?t+o.join("&"):""},t.parse=function(e){for(var t,n=/([^=?&]+)=?([^&]*)/g,r={};t=n.exec(e);){var a=i(t[1]),o=i(t[2]);a in r||(r[a]=o)}return r}},function(e,t,n){n(128),n(70),n(81),n(538),n(539),n(540),n(541),e.exports=n(8).Set},function(e,t,n){"use strict";var r=n(242),a=n(178);e.exports=n(246)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return r.def(a(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){var r=n(10);r(r.P+r.R,"Set",{toJSON:n(247)("Set")})},function(e,t,n){n(248)("Set")},function(e,t,n){n(249)("Set")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(543),a=function(){function e(){this.currentTime=0,this.duration=0,this.buffered=new r.default("")}return e.prototype.updateBuffered=function(e){this.buffered=new r.default(e)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=",",a="-",i=function(){function e(e){var t=e?e.split(r):[];this.ranges=t.reduce(function(e,t){var n=t.split(a),r=n[0],i=n[1];return r&&i&&e.push({end:parseFloat(i),start:parseFloat(r)}),e},[])}return e.prototype.start=function(t){if(t<0||t>=this.ranges.length)throw new ReferenceError(e.INDEX_ERROR);return this.ranges[t].start},e.prototype.end=function(t){if(t<0||t>=this.ranges.length)throw new ReferenceError(e.INDEX_ERROR);return this.ranges[t].end},Object.defineProperty(e.prototype,"length",{get:function(){return this.ranges.length},enumerable:!0,configurable:!0}),e.INDEX_ERROR="INDEX_SIZE_ERR",e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(545),a=n(711),i=n(712),o=n(713),u=n(180),s=n(714),l=function(){function e(e,t){this.platform=e,this.platformVersion=t}return e.newBuilder=function(t,n){return new e(t,n)},e.prototype.setMediaMap=function(e){return this.mediaMap=e,this},e.prototype.setAdapter=function(e){return this.adapter=e,this},e.prototype.setTrackerFactory=function(e){return this.trackerFactory=e,this},e.prototype.setEventEmitter=function(e){return this.eventEmitter=e,this},e.prototype.setPlayerInterface=function(e){return this.playerInterface=e,this},e.prototype.build=function(e){return new r.default({streamrootKey:e.streamrootKey,contentId:s.isEmpty(e.contentId)?e.manifestUrl.host+e.manifestUrl.pathname:e.contentId,siteId:e.siteId,streamType:u.toPeerAgentStreamType(e.streamType),peerAgentCounter:e.peerAgentCounter,backendUrls:e.backendUrls,propertyParameters:e.propertyParameters,networkType:e.networkType,interfaces:{environment:new a.default(this.platform),errorFunnel:new i.default,mediaMap:this.mediaMap,playerInterface:this.playerInterface,externalEventBus:this.eventEmitter,trackerFactory:this.trackerFactory,SegmentViewClass:this.adapter.SegmentView,qosAnalytics:new o.default},versions:{integrationVersion:this.adapter.integrationVersion,wrapperVersion:"P3.8.0",streamrooterVersion:"S"+this.platformVersion,mediaEngineTag:"UNKNOWN"},injectedConf:e.paConfig})},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=U(n(55)),a=U(n(549)),i=U(n(550)),o=U(n(557)),u=U(n(558)),s=U(n(559)),l=(U(n(561)),U(n(566)),U(n(567)),U(n(568))),c=U(n(601)),f=U(n(189)),d=U(n(612)),h=n(614),_=U(n(618)),p=n(619),v=U(n(624)),E=U(n(625)),g=U(n(626)),m=U(n(651)),S=n(71),y=U(n(684)),T=U(n(686)),A=U(n(687)),C=U(n(688)),D=U(n(689)),P=U(n(690)),R=U(n(693)),w=U(n(694)),O=U(n(3)),I=U(n(68)),k=U(n(695)),N=U(n(700)),M=U(n(710)),b=U(n(103)),L=U(n(161));function U(e){return e&&e.__esModule?e:{default:e}}var x=function e(t){var n=this,S=t.interfaces,I=S.playerInterface,L=S.mediaMap,U=S.SegmentViewClass,x=new T.default,F=new m.default(t,x),B=new N.default(F),H=new M.default(F),G=void 0,j=void 0,V=void 0,q=void 0,W=void 0,K=void 0,Y=void 0,X=void 0,z=void 0,Q=void 0,Z=void 0,$=void 0,J=void 0,ee=void 0,te=void 0;$=new o.default(I),J=new P.default($,F),Q=new v.default(F),K=new C.default,V=new l.default(I,K,U,Q,F),B.attachPeerPool(V),q=new c.default(F),Z=new s.default(x,F),L.isLive()||(0,R.default)(F),te=new d.default(F,L),W=new f.default(V,Q,F,te),F.uploadQueueFactory.registerP2PCache(W),Y=(0,h.createGarbageCollector)(F,W),new _.default(Q,W,F),X=new E.default(L,F),z=(0,p.createScheduler)(L,W,X,F),ee=new k.default(F,V),K.init(W,z),G=new i.default(W,z,F),(0,D.default)(F),j=new a.default(z,W,Q,X,F),this.getSegment=function(e,t,n){return J.updateWithSegmentView(n),z.updateTrackEdge(n),g.default.getSegment(this,e,t,n,F)},this.getP2PData=function(e){return W.getPartialSegment(e)||new u.default(e,W,Q,F)},this.getAnalytics=function(e){return B.calculatePayload(e)},this.onPlaybackError=function(e){F.mediaStats.playbackErrorCount++,F.conf.ENABLE_PLAYBACK_ERROR_LOGGING&&"string"==typeof e&&""!==e&&(e=e.substring(0,125),F.errorFunnel.notifyError(new Error("Playback error: "+e)))},this.dispose=function(){F.dispose(),B.dispose(),H.dispose(),j.dispose(),G.dispose(),ee.dispose(),te.dispose(),W.dispose(),Y.dispose(),z.dispose(),B.detachPeerPool(V),V.dispose(),q.dispose(),Z.dispose(),$.removeAllExternalEventListener(),I&&(0,r.default)(I,new w.default)},this.setMediaElement=function(e){n.mediaElement=e},this.detachMediaElement=function(){n.mediaElement=null},this.setBackendUrlsAndConnect=function(e){F.setBackendUrls(e)},this.sendAnalytics=function(e,t){F.analyticsEventBus.emit(e,t)},Object.defineProperty(this,"AnalyticsEnum",{get:function(){return b.default}}),Object.defineProperty(this,"mediaElement",{get:function(){return x.mediaElement},set:function(e){if(e){var t=x.mediaElement!==e;x.mediaElement=e,F.mediaStats.mediaElementSet++,t&&F.mediaStats.mediaElementChanged++,F.eventBus.emit(O.default.SRModule.MEDIA_ELEMENT_ATTACHED,{changed:t})}else F.eventBus.emit(O.default.SRModule.MEDIA_ELEMENT_DETACHED)}}),Object.defineProperty(this,"nextSegmentPrebuffered",{get:function(){return F.moduleState.nextSegmentPrebuffered}}),Object.defineProperty(this,"version",{get:function(){return e.version}}),Object.defineProperty(this,"stats",{get:function(){return y.default.get(V,F,void 0,x)}}),Object.defineProperty(this,"networkType",{get:function(){return F.dnaTransferStatus.networkType},set:function(e){F.dnaTransferStatus.networkType=e}}),Object.defineProperty(this,"transferStatus",{get:function(){return F.dnaTransferStatus.effectiveStatus}}),Object.defineProperty(this,"dnaDownloadAllowed",{get:function(){return F.dnaTransferStatus.downloadAllowed},set:function(e){F.dnaTransferStatus.downloadAllowed=e}}),Object.defineProperty(this,"dnaUploadAllowed",{get:function(){return F.dnaTransferStatus.uploadAllowed},set:function(e){F.dnaTransferStatus.uploadAllowed=e}}),Object.defineProperty(this,"dnaDownloadOnWifiEthernetAllowed",{get:function(){return F.dnaTransferStatus.downloadOnWifiEthernetAllowed},set:function(e){F.dnaTransferStatus.downloadOnWifiEthernetAllowed=e}}),Object.defineProperty(this,"dnaUploadOnWifiEthernetAllowed",{get:function(){return F.dnaTransferStatus.uploadOnWifiEthernetAllowed},set:function(e){F.dnaTransferStatus.uploadOnWifiEthernetAllowed=e}}),Object.defineProperty(this,"dnaDownloadOnCellularAllowed",{get:function(){return F.dnaTransferStatus.downloadOnCellularAllowed},set:function(e){F.dnaTransferStatus.downloadOnCellularAllowed=e}}),Object.defineProperty(this,"dnaUploadOnCellularAllowed",{get:function(){return F.dnaTransferStatus.uploadOnCellularAllowed},set:function(e){F.dnaTransferStatus.uploadOnCellularAllowed=e}}),Object.defineProperty(this,"maxCacheSize",{get:function(){return L.isLive()?F.conf.LIVE.P2P_CACHE_MAX_SIZE:F.conf.P2P_CACHE_MAX_SIZE},set:function(e){F.conf.P2P_CACHE_MAX_SIZE=e,F.conf.LIVE.P2P_CACHE_MAX_SIZE=e,F.eventBus.emit(O.default.P2PCache.CACHE_GC_NEEDED)}}),Object.defineProperty(this,"maxCacheDuration",{get:function(){return L.isLive()?F.conf.LIVE.P2P_CACHE_MAX_DURATION:F.conf.P2P_CACHE_MAX_DURATION},set:function(e){F.conf.P2P_CACHE_MAX_DURATION=e,F.conf.LIVE.P2P_CACHE_MAX_DURATION=e,F.eventBus.emit(O.default.P2PCache.CACHE_GC_NEEDED)}}),Object.defineProperty(this,"PublicAPI",{get:function(){return A.default.get(n)}})};Object.defineProperty(x,"StreamTypes",{get:function(){return S.StreamTypes}}),Object.defineProperty(x,"Events",{get:function(){return I.default}}),Object.defineProperty(x,"NetworkTypes",{get:function(){return L.default}}),Object.defineProperty(x,"version",{get:function(){return"5.7.0"}}),t.default=x},function(e,t,n){n(547),e.exports=n(8).Object.assign},function(e,t,n){var r=n(10);r(r.S+r.F,"Object",{assign:n(548)})},function(e,t,n){"use strict";var r=n(93),a=n(173),i=n(127),o=n(79),u=n(165),s=Object.assign;e.exports=!s||n(52)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=s({},e)[n]||Object.keys(s({},t)).join("")!=r})?function(e,t){for(var n=o(e),s=arguments.length,l=1,c=a.f,f=i.f;s>l;)for(var d,h=u(arguments[l++]),_=c?r(h).concat(c(h)):r(h),p=_.length,v=0;p>v;)f.call(h,d=_[v++])&&(n[d]=h[d]);return n}:s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n,a,o,u){var s=this;(0,r.default)(this,e),this._onHasSegment=function(e,t,n){var r=n.pushed;try{s._segmentInfoMap.addSegmentInfo(t)}catch(e){return void s._sharedState.errorFunnel.notifyError(e)}if(r&&s._sharedState.moduleState.isLive()&&s._scheduler.isSegmentInAcceptableRange(t.segmentView)&&s._distributedSegmentList.insert(t.segmentView),s._scheduler.isSegmentRequested(t.segmentView)){var a=s._p2pCache.getOrCreateSegmentHandler(t.segmentView);a&&(a.chunkManager.setSegmentSize(t.size),e.isBannedSeeder()&&!s._sharedState.conf.ENABLE_FILTER_BANNED_SEEDERS||a.seeders.add(e))}},this._onPeerOpen=function(){var e=s._scheduler.getCachedSegmentListToDownload();s._sharedState.eventBus.emit("segmentInfo",e)},this._onPeerDestroyed=function(e){var t=e.remotePeer;s._p2pCache.removePeer(t)},this._scheduler=t,this._p2pCache=n,this._segmentInfoMap=a,this._distributedSegmentList=o,this._sharedState=u,u.eventBus.on(i.default.Peer.HAS_SEGMENT,this._onHasSegment),u.eventBus.on(i.default.PeerPool.PEER_OPEN,this._onPeerOpen),u.eventBus.on(i.default.PeerPool.PEER_DESTROYED,this._onPeerDestroyed)}return(0,a.default)(e,[{key:"dispose",value:function(){this._sharedState.eventBus.removeListener(i.default.Peer.HAS_SEGMENT,this._onHasSegment),this._sharedState.eventBus.removeListener(i.default.PeerPool.PEER_OPEN,this._onPeerOpen),this._sharedState.eventBus.removeListener(i.default.PeerPool.PEER_DESTROYED,this._onPeerDestroyed)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=n(18),o=s(n(556)),u=s(n(85));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n,a){(0,r.default)(this,e),this._p2pCache=t,this._scheduler=n,this._sharedState=a,this._timer=(0,i.createInterval)(this._scheduleChunkDownloads.bind(this),this._sharedState.conf.CHUNK_BATCHING_INTERVAL),this._lastTime=Date.now()}return(0,a.default)(e,[{key:"dispose",value:function(){this._timer&&this._timer.clear()}},{key:"_scheduleChunkRequestsForSegment",value:function(e,t,n,r){for(var a=this._sharedState.conf.ENABLE_FILTER_BANNED_SEEDERS?t.seeders.allNotBanned():t.seeders.all(),i=a.length,o=0;o<i;o++){for(var u=a[o],s=n.getOrCreate(u);s.getCapacityOf(r)>0&&t.hasChunksToDownload;){var l=t.chunkManager.getNextChunks(s.getCapacityOf(r));s.setCapacityOf(r,s.getCapacityOf(r)-l.size),u.requestChunks(e,l.encoded,r,t.chunkManager)}if(!t.hasChunksToDownload)break}}},{key:"_scheduleChunkDownloads",value:function(){this._sharedState.efficiencyStats.chunkSchedulingCount++;var e=Date.now()-this._lastTime;if(this._sharedState.conf.CHUNK_BATCHING_TIMER_GUARD_RATIO&&e<this._sharedState.conf.CHUNK_BATCHING_INTERVAL*this._sharedState.conf.CHUNK_BATCHING_TIMER_GUARD_RATIO)this._sharedState.efficiencyStats.chunkSchedulingSkipped++;else{this._lastTime=Date.now();for(var t=new o.default(this._sharedState.conf.CHUNK_BATCHING_INTERVAL),n=this._scheduler.getSegmentListToDownload(),r=n.length,a=0;a<r;a++){var i=n[a],s=this._p2pCache.getOrCreateSegmentHandler(i);s&&this._sharedState.dnaTransferStatus.effectiveDownloadAllowed&&s.hasChunksToDownload&&!this._sharedState.isP2PDownloadBlocked&&(this._scheduleChunkRequestsForSegment(i,s,t,u.default.SAFE),this._sharedState.conf.SCHEDULE_UNSAFE_ON_SECOND_SEGMENT&&0===a&&this._sharedState.moduleState.rangeRequestStatus.canDoRR||this._scheduleChunkRequestsForSegment(i,s,t,u.default.UNSAFE))}}}}]),e}();t.default=l},function(e,t,n){var r,a,i=n(254),o=n(255),u=0,s=0;e.exports=function(e,t,n){var l=t&&n||0,c=t||[],f=(e=e||{}).node||r,d=void 0!==e.clockseq?e.clockseq:a;if(null==f||null==d){var h=i();null==f&&(f=r=[1|h[0],h[1],h[2],h[3],h[4],h[5]]),null==d&&(d=a=16383&(h[6]<<8|h[7]))}var _=void 0!==e.msecs?e.msecs:(new Date).getTime(),p=void 0!==e.nsecs?e.nsecs:s+1,v=_-u+(p-s)/1e4;if(v<0&&void 0===e.clockseq&&(d=d+1&16383),(v<0||_>u)&&void 0===e.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=_,s=p,a=d;var E=(1e4*(268435455&(_+=122192928e5))+p)%4294967296;c[l++]=E>>>24&255,c[l++]=E>>>16&255,c[l++]=E>>>8&255,c[l++]=255&E;var g=_/4294967296*1e4&268435455;c[l++]=g>>>8&255,c[l++]=255&g,c[l++]=g>>>24&15|16,c[l++]=g>>>16&255,c[l++]=d>>>8|128,c[l++]=255&d;for(var m=0;m<6;++m)c[l+m]=f[m];return t||o(c)}},function(e,t,n){var r=n(254),a=n(255);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var u=0;u<16;++u)t[i+u]=o[u];return t||a(o)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(13)),a=s(n(1)),i=s(n(2)),o=s(n(11)),u=s(n(12));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n,i){(0,a.default)(this,t);var u=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i));return u._isRepeatable?u.taskId_=setInterval(e,n):u.taskId_=setTimeout(e,n),u}return(0,u.default)(t,e),(0,i.default)(t,[{key:"clear",value:function(){this._isRepeatable?clearInterval(this.taskId_):clearTimeout(this.taskId_)}}]),t}(n(253).AbstractTimer);t.default=l},function(e,t,n){n(555),e.exports=n(8).Object.getPrototypeOf},function(e,t,n){var r=n(79),a=n(237);n(78)("getPrototypeOf",function(){return function(e){return a(r(e))}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(20)),a=o(n(1)),i=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,a.default)(this,e),this._collection=new r.default,this._computationInterval=t}return(0,i.default)(e,[{key:"getOrCreate",value:function(e){var t=e.getId(),n=this._collection.get(t);return n||(n=e.getChunksQuantityForInterval(this._computationInterval),this._collection.set(t,n)),n}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(17)),a=o(n(1)),i=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,a.default)(this,e),this._playerInterface=t,this._mediaEventListenerList=[]}return(0,i.default)(e,[{key:"addMediaEventListener",value:function(e,t){this._mediaEventListenerList.push({eventName:e,fn:t}),this._playerInterface.on(e,t)}},{key:"removeAllExternalEventListener",value:function(){var e=!0,t=!1,n=void 0;try{for(var a,i=(0,r.default)(this._mediaEventListenerList);!(e=(a=i.next()).done);e=!0){var o=a.value;this._playerInterface.removeListener(o.eventName,o.fn)}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this._mediaEventListenerList.length=0}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(13)),a=c(n(1)),i=c(n(2)),o=c(n(11)),u=c(n(12)),s=c(n(256)),l=c(n(181));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,n,i,u){(0,a.default)(this,t);var s=u.eventBus,c=u.segmentHasher,f=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this)),d=e;return f.getFullSegment=function(e,t){s.emit("CDNSegmentDownloaded",d),u.transferStats.cdnDownloaded+=e.byteLength,t(e,d),function(e){c.calculateHash(e,function(e,t){var r=new l.default(d,e.byteLength,t,!0);i.addSegmentInfo(r),n.resetSegmentHandler(d),n.fillSegment(d,e)})}(e)},f}return(0,u.default)(t,e),(0,i.default)(t,[{key:"isComplete",value:function(){return!1}},{key:"isLocked",value:function(){return!1}},{key:"getUpdatedRange",value:function(e){return e}},{key:"p2pSpeed",get:function(){return 0}},{key:"p2pAmount",get:function(){return 0}},{key:"byteLength",get:function(){return null}}]),t}(s.default);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=n(18),o=s(n(560)),u=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n){(0,r.default)(this,e),this._mediaElementPlaceholder=t,this._sharedState=n,this._bufferCheck(),this._bufferCheckInterval=(0,i.createInterval)(this._bufferCheck.bind(this),this._sharedState.conf.BUFFER_CHECK_INTERVAL)}return(0,a.default)(e,[{key:"_bufferCheck",value:function(){this._bufferedAmount=o.default.getBufferedAmount(this._mediaElementPlaceholder),this._sharedState.bufferStats.bufferedAmount=this._bufferedAmount,this._sharedState.eventBus.emit(u.default.BufferedAmountObserver.BUFFER_CHECK,this._bufferedAmount)}},{key:"dispose",value:function(){this._bufferCheckInterval.clear()}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=.3;t.default={getBufferedAmount:function(e){if(!e.mediaElement)return 0;for(var t=e.mediaElement.buffered,n=e.mediaElement.currentTime,a=n,i=0;i<t.length;i++)t.start(i)<a+r&&t.end(i)>a&&(a=t.end(i));return a-n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(1)),a=h(n(2)),i=h(n(3)),o=h(n(562)),u=h(n(563)),s=h(n(564)),l=h(n(565)),c=h(n(183)),f=n(18),d=n(56);function h(e){return e&&e.__esModule?e:{default:e}}var _=function(){function e(t,n,a){(0,r.default)(this,e),this._peerCount=0,this._bufferTarget=0,this._bufferedAmount=0,this._randomBufferLevel=null,this._reachedLiveEdge=!1,this._bufferTargetState=s.default.INIT,this._bufferStatus=l.default.ZERO,this._lastLowToModerateBufferTimestamp=null,this._droppedUnderLow=!1,this._reboundCount=0,this._netLowTargetChange=0,this._uncompleteSegmentRequestedWhileLowCount=0,this._targetGapSamplerTimeout=null,this._allowBufferTargetAdjust=!1,this._sharedState=a,this._playerInterface=t,this._mediaElementPlaceholder=n,this._bufferStateMachine=new u.default(a.eventBus),this._onLiveEdgeChangedCallback=this._onLiveEdgeChanged.bind(this),this._onUncompleteSegmentRequestedCallback=this._onUncompleteSegmentRequested.bind(this),this._onPeerCountChangedCallback=this._onPeerCountChanged.bind(this),this._onBufferCheckCallback=this._bufferCheck.bind(this),this._onConfigUpdatedCallback=this._resetDynamicBufferLevels.bind(this),this._sharedState.eventBus.on(i.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,this._onLiveEdgeChangedCallback),this._sharedState.eventBus.on(i.default.SRModuleInterface.UNCOMPLETE_SEGMENT_REQUESTED,this._onUncompleteSegmentRequestedCallback),this._sharedState.eventBus.on(i.default.PeerPool.PEER_OPEN,this._onPeerCountChangedCallback),this._sharedState.eventBus.on(i.default.PeerPool.PEER_DESTROYED,this._onPeerCountChangedCallback),this._sharedState.eventBus.on(i.default.BufferedAmountObserver.BUFFER_CHECK,this._onBufferCheckCallback),this._sharedState.eventBus.on(i.default.Config.CONFIG_UPDATED,this._onConfigUpdatedCallback),this._currentLowerBufferTarget=this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._uploadCapacityCalculator=new o.default(this._sharedState),this._sampleTargetGap(0)}return(0,a.default)(e,[{key:"_sampleTargetGap",value:function(e){this._sharedState.bufferStats.sampledHighLowBufferTargetGap=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget;var t=Math.round(Math.random()*this._sharedState.conf.LIVE.BUFFER_TARGET_GAP_SAMPLE_INTERVAL);this._targetGapSamplerTimeout=(0,f.createTimeout)(this._sampleTargetGap.bind(this,this._sharedState.conf.LIVE.BUFFER_TARGET_GAP_SAMPLE_INTERVAL-t),e+t)}},{key:"_onUncompleteSegmentRequested",value:function(){this._isLowBufferTarget()&&(this._uncompleteSegmentRequestedWhileLowCount++,this._uncompleteSegmentRequestedWhileLowCount>=this._sharedState.conf.LIVE.UNCOMPLETE_REQUESTS_COUNT_FOR_HIGHER_TARGET&&(this._sharedState.eventBus.emit(i.default.BufferManager.LOW_BUFFER,this._bufferedAmount),this._setHighTarget()))}},{key:"_onLiveEdgeChanged",value:function(e){this._reachedLiveEdge=e}},{key:"_onPeerCountChanged",value:function(e){var t=e.peerCount;this._peerCount=t}},{key:"_bufferCheck",value:function(e){this._bufferedAmount=e,this._sharedState.superSeederMode===c.default.FORCED?(this._bufferStateMachine.gotoTopSeeder(),this._setHighTarget()):0===this._peerCount?(this._bufferStateMachine.gotoNoPeer(),this._setHighTarget()):this._uploadCapacityCalculator.uploadCapacityEMWA>=this._sharedState.conf.LIVE.UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING&&this._sharedState.superSeederMode!==c.default.FORBIDDEN?(this._bufferStateMachine.gotoTopSeeder(),this._setHighTarget()):null!==this._mediaElementPlaceholder.mediaElement?(this._bufferStateMachine.gotoDynamic(),this._dynamicBufferCheck()):(this._bufferStateMachine.gotoRandom(),this._setRandomTarget());var t=void 0;t=this._reachedLiveEdge||this._bufferedAmount>this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET?l.default.HIGH:this._bufferedAmount>this._currentLowerBufferTarget?l.default.MODERATE:this._bufferedAmount>this._sharedState.conf.LIVE.CRITICAL_LOWER_TARGET_RATIO*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET?l.default.LOW:this._bufferedAmount>this._sharedState.conf.BUFFER_ZERO_THRESHOLD?l.default.CRITICALLY_LOW:l.default.ZERO,this._sharedState.bufferStats.setLowerTargetAboveLiveEdge(this._bufferedAmount<this._currentLowerBufferTarget&&this._reachedLiveEdge),t>=l.default.MODERATE&&(this._allowBufferTargetAdjust=!0),this._bufferStatus!==t&&(this._bufferStatusChanged(this._bufferStatus,t),this._bufferStatus=t)}},{key:"_bufferStatusChanged",value:function(e,t){if(this._sharedState.conf.LIVE.ENABLE_DYNAMIC_LOWER_TARGET){if(e>l.default.ZERO&&t===l.default.CRITICALLY_LOW&&this._adjustLowerTarget((this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET)*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET_INCREASE_STEP),e<=l.default.LOW&&t>=l.default.MODERATE&&(this._lastLowToModerateBufferTimestamp=Date.now()),e>=l.default.MODERATE&&t<=l.default.LOW&&(this._droppedUnderLow=!0),t>=l.default.HIGH){if(null!=this._lastLowToModerateBufferTimestamp){var n=(Date.now()-this._lastLowToModerateBufferTimestamp)/1e3;this._lastLowToModerateBufferTimestamp=null;var r=(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget)*this._sharedState.conf.LIVE.FAST_BUFFER_FILL_FRACTION;(n<=r||0===r)&&this._adjustLowerTarget(-(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET)*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET_DECREASE_STEP)}this._droppedUnderLow&&this._reboundCount++}this._reboundCount>0&&(this._sharedState.bufferStats.lowerBufferTargetNetChangePerRebound=this._netLowTargetChange/this._reboundCount)}}},{key:"_resetDynamicBufferLevels",value:function(){var e=this._isLowBufferTarget();this._currentLowerBufferTarget=this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._droppedUnderLow=!1,e&&this._setLowTarget()}},{key:"_adjustLowerTarget",value:function(e){if(this._allowBufferTargetAdjust){var t=this._currentLowerBufferTarget,n=this._isLowBufferTarget();this._currentLowerBufferTarget=(0,d.clamp)(this._currentLowerBufferTarget+e,this._sharedState.conf.LIVE.CRITICAL_LOWER_TARGET_RATIO*this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET,this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET),this._netLowTargetChange+=Math.abs(t-this._currentLowerBufferTarget),n&&this._setLowTarget(),this._allowBufferTargetAdjust=!1}}},{key:"_dynamicBufferCheck",value:function(){this._isHighBufferTarget()?(this._bufferedAmount>=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET||this._reachedLiveEdge)&&(this._sharedState.eventBus.emit(i.default.BufferManager.HIGH_BUFFER,this._bufferedAmount),this._setLowTarget()):this._isLowBufferTarget()||this._setHighTarget()}},{key:"_bufferTargetStateChanged",value:function(e){e!==this._bufferTargetState&&(this._bufferTargetState===s.default.LOW&&e===s.default.HIGH?this._sharedState.p2pDownloadBlocker.block(this._sharedState.conf.LIVE.LOW_TARGET_P2P_DL_BLOCK_DURATION,"liveLowToHighBlock"):this._bufferTargetState===s.default.HIGH&&e===s.default.LOW&&(this._sharedState.p2pDownloadBlocker.unblock("liveLowToHighBlock"),this._sharedState.p2pDownloadBlocker.unblock("liveInitBlock"),this._sharedState.p2pUploadBlocker.unblock("liveInitBlock")),this._bufferTargetState=e)}},{key:"_setRandomTarget",value:function(){this._bufferTargetStateChanged(s.default.RANDOM),this._bufferTarget=this._getRandomBufferLevel(),this._playerInterface.setBufferTarget(this._bufferTarget)}},{key:"_setHighTarget",value:function(){this._bufferTargetStateChanged(s.default.HIGH),this._bufferTarget=this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET,this._playerInterface.setBufferTarget(this._bufferTarget)}},{key:"_setLowTarget",value:function(){this._bufferTargetStateChanged(s.default.LOW),this._bufferTarget=this._currentLowerBufferTarget,this._playerInterface.setBufferTarget(this._bufferTarget),this._uncompleteSegmentRequestedWhileLowCount=0}},{key:"_isLowBufferTarget",value:function(){return this._bufferTarget===this._currentLowerBufferTarget}},{key:"_isHighBufferTarget",value:function(){return this._bufferTarget===this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET}},{key:"_getRandomBufferLevel",value:function(){return this._randomBufferLevel=this._randomBufferLevel||Math.floor(Math.random()*(this._sharedState.conf.LIVE.HIGHER_BUFFER_TARGET-this._currentLowerBufferTarget+1))+this._currentLowerBufferTarget,this._randomBufferLevel}},{key:"dispose",value:function(){this._uploadCapacityCalculator.dispose(),this._targetGapSamplerTimeout&&this._targetGapSamplerTimeout.clear(),this._sharedState.eventBus.removeListener(i.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,this._onLiveEdgeChangedCallback),this._sharedState.eventBus.removeListener(i.default.SRModuleInterface.UNCOMPLETE_SEGMENT_REQUESTED,this._onUncompleteSegmentRequestedCallback),this._sharedState.eventBus.removeListener(i.default.PeerPool.PEER_OPEN,this._onPeerCountChangedCallback),this._sharedState.eventBus.removeListener(i.default.PeerPool.PEER_DESTROYED,this._onPeerCountChangedCallback),this._sharedState.eventBus.removeListener(i.default.BufferedAmountObserver.BUFFER_CHECK,this._onBufferCheckCallback),this._sharedState.eventBus.removeListener(i.default.Config.CONFIG_UPDATED,this._onConfigUpdatedCallback)}},{key:"bufferTarget",get:function(){return this._bufferTarget}},{key:"bufferedAmount",get:function(){return this._bufferedAmount}},{key:"mediaElementPlaceholder",set:function(e){this._mediaElementPlaceholder=e}},{key:"reachedLiveEdge",get:function(){return this._reachedLiveEdge}}]),e}();t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=n(38),o=n(18),u=s(n(98));function s(e){return e&&e.__esModule?e:{default:e}}var l=1e3,c=function(){function e(t){(0,r.default)(this,e),this._uploadSpeedDelta=new i.Delta,this._uploadSpeedTimestampDelta=new i.Delta(Date.now()),this._sharedState=t,this._uploadCapacityEMWA=new u.default(0,this._sharedState.conf.LIVE.BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT),this._uploadSpeedInterval=(0,o.createInterval)(this._refreshUploadSpeed.bind(this),l)}return(0,a.default)(e,[{key:"_refreshUploadSpeed",value:function(){var e=this._sharedState.transferStats.p2pUploaded,t=8*this._uploadSpeedDelta.calcDelta(e)/this._uploadSpeedTimestampDelta.calcDelta(Date.now());t>0&&this._uploadCapacityEMWA.update(t)}},{key:"dispose",value:function(){this._uploadSpeedInterval.clear()}},{key:"uploadCapacityEMWA",get:function(){return this._uploadCapacityEMWA.value}}]),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),a=u(n(2)),i=u(n(3)),o=u(n(182));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,r.default)(this,e),this._ee=t,this.gotoIdle()}return(0,a.default)(e,[{key:"_setState",value:function(e){this._state!==e&&(this._prevState=this._state,this._state=e,this._prevState&&this._ee.emit(i.default.BufferManager.STATE_CHANGED,this._prevState,this._state))}},{key:"gotoIdle",value:function(){this._setState(o.default.IDLE)}},{key:"gotoNoPeer",value:function(){this._setState(o.default.NO_PEER)}},{key:"gotoRandom",value:function(){this._setState(o.default.RANDOM)}},{key:"gotoDynamic",value:function(){this._setState(o.default.DYNAMIC)}},{key:"gotoTopSeeder",value:function(){this._setState(o.default.TOP_SEEDER)}},{key:"getState",value:function(){return this._state}},{key:"isIdle",value:function(){return this._state===o.default.IDLE}},{key:"isNoPeer",value:function(){return this._state===o.default.NO_PEER}},{key:"isRandom",value:function(){return this._state===o.default.RANDOM}},{key:"isDynamic",value:function(){return this._state===o.default.DYNAMIC}},{key:"isTopSeeder",value:function(){return this._state===o.default.TOP_SEEDER}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={LOW:"target_low",HIGH:"target_high",RANDOM:"target_random",INIT:"target_init"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={ZERO:0,CRITICALLY_LOW:1,LOW:2,MODERATE:3,HIGH:4}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),a=u(n(2)),i=u(n(3)),o=n(71);function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n){(0,r.default)(this,e),this._reachedLiveEdge=!1,this._playerInterface=t,this._sharedState=n,this._onVideoSegmentListUpdateCallback=this._onVideoSegmentListUpdate.bind(this),this._onBufferCheckCallback=this._onBufferCheck.bind(this),this._sharedState.eventBus.on(i.default.Scheduler.UPDATE_VIDEO_SEGMENT_LIST_MISSING_FROM_ME,this._onVideoSegmentListUpdateCallback),this._sharedState.eventBus.on(i.default.BufferedAmountObserver.BUFFER_CHECK,this._onBufferCheckCallback)}return(0,a.default)(e,[{key:"_onVideoSegmentListUpdate",value:function(e){var t=e.count;if(this._sharedState.moduleState.streamType!==o.StreamTypes.SMOOTH){var n=this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK||this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME?0===t:t<=1;this._updateReachedLiveEdgeState(n)}}},{key:"_onBufferCheck",value:function(e){if(this._sharedState.moduleState.streamType===o.StreamTypes.SMOOTH){var t=this._playerInterface.getLatency();t&&e+this._sharedState.conf.SMOOTH_TOLERANCE_FOR_REACHED_LIVE_EDGE>=t?this._updateReachedLiveEdgeState(!0):this._updateReachedLiveEdgeState(!1)}}},{key:"_updateReachedLiveEdgeState",value:function(e){e!==this._reachedLiveEdge&&(this._reachedLiveEdge=e,this._sharedState.eventBus.emit(i.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,e))}},{key:"dispose",value:function(){this._sharedState.eventBus.removeListener(i.default.Scheduler.UPDATE_VIDEO_SEGMENT_LIST_MISSING_FROM_ME,this._onVideoSegmentListUpdateCallback),this._sharedState.eventBus.removeListener(i.default.BufferedAmountObserver.BUFFER_CHECK,this._onBufferCheckCallback)}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),a=u(n(2)),i=u(n(3)),o=u(n(182));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n){(0,r.default)(this,e),this._playerInterface=t,this._sharedState=n,this._playerInterface.setBufferTarget(this._getRandomBufferLevel()),this._sharedState.eventBus.emit(i.default.BufferManager.STATE_CHANGED,"",o.default.STATIC)}return(0,a.default)(e,[{key:"dispose",value:function(){}},{key:"_getRandomBufferLevel",value:function(){return Math.floor(Math.random()*(this._sharedState.conf.LIVE.HIGHER_STATIC_BUFFER_TARGET-this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET+1))+this._sharedState.conf.LIVE.LOWER_BUFFER_TARGET}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=m(n(48)),a=m(n(86)),i=m(n(17)),o=m(n(99)),u=m(n(258)),s=m(n(184)),l=n(18),c=m(n(579)),f=m(n(592)),d=m(n(3)),h=m(n(265)),_=m(n(597)),p=m(n(598)),v=m(n(600)),E=m(n(266)),g=m(n(264));function m(e){return e&&e.__esModule?e:{default:e}}var S="removed",y="disconnected",T="offer_declined",A="timed_out";t.default=function(e,t,n,m,C){var D=C.conf,P=C.status,R=C.peerStats,w=void 0,O=null,I=!1,k=void 0,N=null,M=void 0,b=!1,L=0,U=o.default,x=[],F=new _.default(e,t,C),B=m,H=this,G=C.eventBus,j=C.statsProvider,V=new s.default,q=function(){return x.map(function(e){return e.getHistoricalMeanRtt()}).filter(function(e){return e.count>0}).map(function(e){return e.mean})},W=function(){var e=Date.now();return x.map(function(t){var n=t.getCreationTimestamp(),r=n>C.lastStatPayloadTimestamp?n:C.lastStatPayloadTimestamp;return e-r}).reduce(function(e,t){return e+t},0)/1e3},K=function(){I=!0,X()},Y=function(){I=!1,X()},X=function(e){if(V.clear(O),O=null,!I){var t=e-(Date.now()-U);t>0?(O=(0,l.createTimeout)(ie,t),V.register(O)):ie()}},z=function(e){e.isVideo&&O&&X(D.ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL)},Q=function(){Ee()&&H.makeRoom();var e=0,t=0,n=!0,r=!1,a=void 0;try{for(var o,u=(0,i.default)(x);!(n=(o=u.next()).done);n=!0){var s=o.value;s.locked()&&e++,s.isLooser()&&t++}}catch(e){r=!0,a=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw a}}R.locked.updateMetric(e),R.loosers.updateMetric(t),R.limit=D.PEER_POOL_LIMIT;var l=0,c=!0,f=!1,h=void 0;try{for(var _,p=(0,i.default)(x);!(c=(_=p.next()).done);c=!0)_.value.isOnSameTrack()&&l++}catch(e){f=!0,h=e}finally{try{!c&&p.return&&p.return()}finally{if(f)throw h}}G.emit(d.default.PeerPool.PEER_STATS_UPDATE,{peerCount:x.length,sameTrackPeerCount:l})},Z=function(){for(var e=0,t=0,n=0;n<x.length;n++){var r=x[n];e+=r.getDlSpeed(),t+=r.getUpSpeed()}P.setDlSpeed(e),P.setUpSpeed(t),P.computeMaxAndAvgSpeed()},$=function(){null!==N&&N.dispose(),N=new f.default(P.getMyPeerId(),this,n,C),M=new p.default(N,C),k=new v.default(this,N,C),w=M.onPeersFromTracker.bind(M),b&&ee()},J=function(){O&&(V.clear(O),O=null)},ee=function(){if(P.getConnected()&&P.getConnectedToSignalingServer()){var e=Date.now()-U,t=Date.now()-C.moduleState.currentTracks.lastSwitchTimestamp<e?D.ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL:D.ASK_PEERS_INTERVAL;X(t),b=!0}},te=function(e){ae(e),G.emit(d.default.PeerPool.PEER_DESTROYED,{remotePeer:e,peerCount:x.length})},ne=function(e){return u.default.withoutAll(x,e)>0&&(e.isConnected()&&e.close(),!0)},re=function(e){ne(e)&&(k.addSecondOrderExclusion(e.getId(),D.PEER_REMOVED_EXCLUSION_RANK,D.PEER_REMOVED_EXCLUSION_DURATION,S),e.isOnSameTrack()?R.droppedSameTrack++:R.droppedOtherTrack++)},ae=function(e){ne(e)&&k.addSecondOrderExclusion(e.getId(),D.PEER_DISCONNECTED_EXCLUSION_RANK,D.PEER_DISCONNECTED_EXCLUSION_DURATION,y)},ie=function e(){U=Date.now();var t=k.exclusionList;R.exclusionSize=k.secondOrderExclusions.size,F.askPeers(t,w),O=(0,l.createTimeout)(e,D.ASK_PEERS_INTERVAL),V.register(O)},oe=function(){for(var e=[],t=0,n=x.length;t<n;t++)e.push(x[t].getUploadCapacity());var r=h.default.median(e);return r?Math.max(r,D.MIN_PEER_UPLOAD_CAPACITY):D.DEFAULT_PEER_UPLOAD_CAPACITY},ue=function(){for(var e=0,t=0,n=x.length;t<n;t++)e+=x[t].getUploadCapacity();R.peerPoolUploadCapacity.updateMetric(e)},se=function(){return x.length>0?x[Math.floor(Math.random()*x.length)].getUploadCapacity():0},le=function(){var e=x.filter(function(e){return e.getChunkRequestedCount()>=50});return e.length>0?e[Math.floor(Math.random()*e.length)]:null},ce=function(){var e=le();return e&&e.sampleResponseTime()||0},fe=function(){var e=le();return e&&e.sampleResponseDurationPerChunk()||0},de=function(){var e=le();return e&&e.sampleLastChunkDelayFromTimeout()||0},he=function(){++L>D.MAX_PEER_CONNECTION_FAILURES&&(pe(),ve())},_e=function(){L=0},pe=function(){G.emit(d.default.Tracker.TRACKER_DISCONNECTION_REQUEST,!0)},ve=function(){G.emit(d.default.Signaling.SIGNALING_DISCONNECTION_REQUEST,!0)},Ee=function(){return x.length-D.PEER_POOL_LIMIT>0},ge=function(e,t,n){var r=e.getUpSpeedEMA()/t+e.getUsefulDlSpeedEMA()/n;return r},me=function(){if(x.length>0){var e="noTrack";C.moduleState.currentTracks.video&&(e=C.moduleState.currentTracks.video.viewToString());var t=g.default.encode("heartbeat",{videoTrack:e});PeerConnectorInteractor.broadcastMessage((0,a.default)(t))}};H.getPeerArray=function(){return x},H.lockedCount=function(){var e=0,t=!0,n=!1,r=void 0;try{for(var a,o=(0,i.default)(x);!(t=(a=o.next()).done);t=!0)a.value.locked()&&e++}catch(e){n=!0,r=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw r}}return e},H.openSlotsCount=function(){return Math.max(D.PEER_POOL_LIMIT-H.lockedCount(),0)},H.makeRoom=function(){var e=function(){var e=[],t=[],n=1,r=1,a=!0,o=!1,u=void 0;try{for(var s,l=(0,i.default)(x);!(a=(s=l.next()).done);a=!0){var c=s.value;c.locked()||(c.isLooser()?e.push(c):t.push(c)),n=Math.max(n,c.getUpSpeedEMA()),r=Math.max(r,c.getUsefulDlSpeedEMA())}}catch(e){o=!0,u=e}finally{try{!a&&l.return&&l.return()}finally{if(o)throw u}}return{loosers:e,unlocked:t,maxUpSpeed:n,maxDownSpeed:r}}(),t=e.loosers,n=e.unlocked,r=e.maxUpSpeed,a=e.maxDownSpeed;for(t.sort(function(e,t){return t.getUpSpeedEMA()-e.getUpSpeedEMA()});t.length>0&&Ee();){var o=t.pop();re(o)}if(Ee())for(n.sort(function(e,t){return ge(t,r,a)-ge(e,r,a)});n.length>0&&Ee();){var u=n.pop();re(u)}},H.getPeerCount=function(){return x.length},H.getPendingConnectionDebugInfos=function(){return N?N.getPendingConnectionDebugInfos():[]},H.requestHasSegment=function(e){if(x.length>0){var t=g.default.encode("requestHasSegment",{segmentView:e});PeerConnectorInteractor.broadcastMessage((0,a.default)(t))}},H.addPeerConnection=function(e,t,r){var a=oe(),i=new c.default(e,n,t,C,a);x.push(i),r?R.openedMatch++:R.openedOffer++,G.emit(d.default.PeerPool.PEER_OPEN,{remotePeer:i,peerCount:x.length}),_e()},this.offerDeclined=function(e){k.addSecondOrderExclusion(e,D.OFFER_DECLINED_EXCLUSION_RANK,D.OFFER_DECLINED_EXCLUSION_DURATION,T),R.denied++},this.connectionAttemptTimeout=function(e){k.addSecondOrderExclusion(e,D.PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK,D.PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION,A),he()},H.broadcastSegmentInfo=function(e){if(x.length>0){var t=B.getSegmentInfo(e);if(t){var n=g.default.encode("hasSegment",{segmentInfo:t,pushed:!0});PeerConnectorInteractor.broadcastMessage((0,a.default)(n))}}},H.dispose=function(){P.getEE().removeListener(d.default.Tracker.READY,$),P.getEE().removeListener(d.default.Tracker.DISCONNECTED,J),P.getEE().removeListener(d.default.Signaling.READY,ee),P.getEE().removeListener(d.default.Signaling.DISCONNECTED,J),null!==N&&N.dispose(),M&&M.dispose(),V.clearAll(),(0,r.default)(x).forEach(function(e){e.isConnected()&&e.close()}),F.dispose()},function(){var e=(0,l.createInterval)(Z,D.SPEED_MONITOR_INTERVAL),t=(0,l.createInterval)(ue,D.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL),n=(0,l.createInterval)(Q,D.PEER_POOL_MAINTENANCE_INTERVAL),r=(0,l.createInterval)(me,D.SEND_HEARTBEAT_INTERVAL);V.register(e),V.register(t),V.register(n),V.register(r),G.on(d.default.Peer.PEER_DISCONNECTED,te),G.on(d.default.Metrics.TRACK_SWITCH,z,this),G.on(d.default.PeerPool.STOP_ASKING_PEERS,K),G.on(d.default.PeerPool.START_ASKING_PEERS,Y),P.getEE().on(d.default.Tracker.READY,$,H),P.getEE().on(d.default.Tracker.DISCONNECTED,J,H),P.getEE().on(d.default.Signaling.READY,ee,H),P.getEE().on(d.default.Signaling.DISCONNECTED,J,H),j.registerProvider(E.default.PeerStats.SAMPLED_PUC,se),j.registerProvider(E.default.PeerStats.SAMPLED_LIVE_CONNECTION_RTT,q),j.registerProvider(E.default.PeerStats.TOTAL_CONNECTION_DURATION,W),j.registerProvider(E.default.PeerStats.SAMPLED_RESPONSE_TIME,ce),j.registerProvider(E.default.PeerStats.SAMPLED_RESPONSE_DURATION_PER_CHUNK,fe),j.registerProvider(E.default.PeerStats.SAMPLED_LAST_CHUNK_DELAY_FROM_TIMEOUT,de)}()}},function(e,t,n){n(70),n(570),e.exports=n(8).Array.from},function(e,t,n){"use strict";var r=n(47),a=n(10),i=n(79),o=n(243),u=n(244),s=n(124),l=n(571),c=n(177);a(a.S+a.F*!n(257)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,a,f,d=i(e),h="function"==typeof this?this:Array,_=arguments.length,p=_>1?arguments[1]:void 0,v=void 0!==p,E=0,g=c(d);if(v&&(p=r(p,_>2?arguments[2]:void 0,2)),void 0==g||h==Array&&u(g))for(n=new h(t=s(d.length));t>E;E++)l(n,E,v?p(d[E],E):d[E]);else for(f=g.call(d),n=new h;!(a=f.next()).done;E++)l(n,E,v?o(f,p,[a.value,E],!0):a.value);return n.length=E,n}})},function(e,t,n){"use strict";var r=n(36),a=n(91);e.exports=function(e,t,n){t in e?r.f(e,t,a(0,n)):e[t]=n}},function(e,t,n){var r=n(8),a=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return a.stringify.apply(a,arguments)}},function(e,t,n){n(574),e.exports=-9007199254740991},function(e,t,n){var r=n(10);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){e.exports={default:n(576),__esModule:!0}},function(e,t,n){n(577),e.exports=n(8).Object.is},function(e,t,n){var r=n(10);r(r.S,"Object",{is:n(578)})},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=A(n(55)),a=A(n(17)),i=A(n(99)),o=A(n(20)),u=n(18),s=A(n(181)),l=n(38),c=n(580),f=A(n(586)),d=A(n(587)),h=A(n(3)),_=A(n(588)),p=A(n(589)),v=A(n(85)),E=A(n(98)),g=A(n(185)),m=A(n(590)),S=A(n(591)),y=A(n(186)),T=A(n(187));function A(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n,A,C){var D,P=A,R=A.conf,w=A.peerStats,O=new l.Delta,I=new l.Delta,k=new l.Delta,N=new l.Delta(Date.now()),M=A.eventBus,b=e,L=w,U=A.uploadQueueFactory.create(n),x=this,F=E.default.fromHalfLife(0,R.PEER_UPLOAD_SPEED_EMA_HALF_LIFE,R.PEER_SPEED_MONITOR_INTERVAL),B=E.default.fromHalfLife(0,R.PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE,R.PEER_SPEED_MONITOR_INTERVAL),H=Math.max(R.BLOCK_SEEDER_SCHEDULING_WINDOW,R.PEER_TIMEOUT_RATIO_WINDOW),G=new g.default(H),j=new g.default(H),V=Date.now(),q=new m.default,W=n.stats,K=A.moduleState.isLive()?A.conf.LIVE.CHUNK_UP_TIMEOUT:A.conf.CHUNK_UP_TIMEOUT,Y=0,X=0,z=!1,Q=void 0,Z=0,$=0,J=void 0,ee=0,te=0,ne=0,re=0,ae=!1,ie=!1,oe=void 0,ue=!1,se=0,le=new o.default,ce=new o.default,fe=i.default,de=new o.default,he=new y.default(20),_e=new y.default(20),pe=new y.default(20),ve=function(){var e=N.calcDelta(Date.now()),t=O.calcDelta(Y),r=I.calcDelta(X),a=k.calcDelta(U.dataUploaded);Z=8*t/e,$=8*a/e;var i=8*r/e;ae?B.update(i):i>0&&(B.update(i,1),ae=!0),ie?F.update($):$>0&&(F.update($,1),ie=!0),G.push(ee),j.push(te);var o=n.getRtt();o>0&&(q.addSample(o),W.updateRtt(o)),W.updateUploadCapacity(x.getUploadCapacity())},Ee=function(){var e="noTrack";P.moduleState.currentTracks.video&&(e=P.moduleState.currentTracks.video.viewToString()),n.sendMessage("heartbeat",{videoTrack:e})},ge=function(e){n.sendMessage("requestHasSegment",{segmentView:e})},me=function(e){return e.requestId+65536*e.chunkIndex},Se=function(){W.updateSameTrack(De())},ye=function(){return W.timeSpentOnSameTrack},Te=function(e,n){var r=void 0;switch(e){case"heartbeat":Q=n.videoTrack,Se();break;case"requestHasSegment":M.emit("segmentRequested",x,new t(n.segmentView));break;case"hasSegment":(r=new t(n.segmentInfo.segmentView)).fromPeer=!0;var i=new s.default(r,n.segmentInfo.size,n.segmentInfo.hash),o=!!n.pushed;M.emit("hasSegment",x,i,{pushed:o});break;case"requestChunks":if(!A.dnaTransferStatus.effectiveUploadAllowed)return;r=new t(n.segmentView);var u=n.requestId,l=f.default.decode(n.ids),c=n.safe?v.default.SAFE:v.default.UNSAFE,d=!0,h=!1,_=void 0;try{for(var E,g=(0,a.default)(l);!(d=(E=g.next()).done);d=!0){var m=E.value;A.efficiencyStats.receivedChunkRequestCount++,W.receivedChunkRequestCount++,U.push(new p.default(u,r,m,K,c))}}catch(e){h=!0,_=e}finally{try{!d&&g.return&&g.return()}finally{if(h)throw _}}break;case"info":var S=W.remoteInfo,y=n.info;S.platform=y.platform,S.property=y.property,S.uaName=y.uaName,S.uaOs=y.uaOs;break;default:return void P.errorFunnel.notifyError(new Error("Invalid message "+e+" sent by peerConnection"))}ue||(L.active++,ue=!0)},Ae=function(e,t,n){var r=me({requestId:n,chunkIndex:t}),a=de.get(n);if(a){if(!a.responseTimestamp){a.responseTimestamp=Date.now();var i=a.responseTimestamp-a.requestTimestamp;he.addSample(i)}if(a.chunksReceived++,a.chunksReceived===a.chunksExpected){var o=Date.now(),u=(o-a.responseTimestamp)/a.chunksReceived;if(_e.addSample(u),a.timeoutTimestamp){var s=o-a.timeoutTimestamp;pe.addSample(s)}de.delete(n)}}W.dataDownloaded+=e.byteLength;var l=le.get(r);l?(ee++,Y+=e.byteLength,W.sentChunkRequestAnsweredCount++,l.dataDownloaded(e),X+=e.byteLength,le.delete(r)):(re++,P.conf.PEER_IGNORE_LATE_CHUNKS_IN_DATA_DOWNLOADED||(Y+=e.byteLength),(l=ce.get(r))?(ne++,A.efficiencyStats.gracedChunksCount++,l.dataDownloaded(e),ce.delete(r)):(A.efficiencyStats.expiredGraceChunksCount++,A.transferStats.multipleDlM+=e.byteLength,e.destroy())),Ce()},Ce=function(){z||(L.transfer++,z=!0)},De=function(){return!Q||!A.moduleState.currentTracks.video||A.moduleState.currentTracks.video.viewToString()===Q},Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R.PEER_TIMEOUT_RATIO_WINDOW,t=G.subDelta(e),n=j.subDelta(e);return t>0?n/t:0},Re=function(e){for(var t=0;t<e.length;t++)ge(e[t])};x.getRtt=n.getRtt.bind(n),x.requestHasSegment=ge,x.heartBeat=Ee,x.answerHasSegment=function(e,t){var r=t.pushed;n.sendMessage("hasSegment",{segmentInfo:e,pushed:!!r})},x.requestChunks=function(e,t,r,i){var o=se;se=(se+1)%65536;var u=f.default.decode(t),s=!0,l=!1,c=void 0;try{for(var d,h=(0,a.default)(u);!(s=(d=h.next()).done);s=!0){var p=d.value,E=new _.default(o,e,p,this,P,i,r),g=me(E);le.set(g,E),W.sentChunkRequestCount++}}catch(e){l=!0,c=e}finally{try{!s&&h.return&&h.return()}finally{if(l)throw c}}var m={requestTimestamp:Date.now(),responseTimestamp:null,timeoutTimestamp:null,chunksReceived:0,chunksExpected:u.length};de.set(o,m),n.sendMessage("requestChunks",{requestId:o,segmentView:e,ids:t,safe:r===v.default.SAFE})},x.timeoutChunk=function(e){ee++,te++;var t=de.get(e.requestId);t&&!t.timeoutTimestamp&&(t.timeoutTimestamp=Date.now());var n=me(e);ce.set(n,le.get(n)),le.delete(n),(0,u.createTimeout)(function(){ce.delete(n),de.delete(e.requestId)},R.CHUNK_GRACE_DURATION),this.isBannedSeeder()||Pe(R.BLOCK_SEEDER_SCHEDULING_WINDOW)>R.BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD&&ee>R.BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD&&(fe=Date.now())},x.isOnSameTrack=De,x.close=function(){oe?oe.clear():P.errorFunnel.notifyError(new Error("clear() call on undefined Peer.speedMonitorTimer")),W.state=T.default.CLOSED,n.close()},x.isConnected=function(){return n.connected},x.peerId=function(){return b},x.getDataDownloaded=function(){return Y},x.getDataUploaded=function(){return U.dataUploaded},x.getId=function(){return b},x.getConnection=function(){return n},x.getDlSpeed=function(){return Z},x.getUpSpeed=function(){return $},x.getUsefulDlSpeedEMA=function(){return B.value},x.getUpSpeedEMA=function(){return F.value},x.getChunkTimeoutCount=function(){return te},x.getChunkRequestedCount=function(){return ee},x.getLateChunksCount=function(){return re},x.getGracedChunksCount=function(){return ne},x.getUploadCapacity=function(){return J.value},x.sampleResponseTime=function(){return he.fetchSample()},x.sampleResponseDurationPerChunk=function(){return _e.fetchSample()},x.sampleLastChunkDelayFromTimeout=function(){return pe.fetchSample()},x.isLooser=function(){var e=Pe()>R.PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD,t=F.value<R.LOOSER_UPLOAD_THRESHOLD;return e&&t},x.isBannedSeeder=function(){return Date.now()-fe<R.BLOCK_SEEDER_SCHEDULING_DURATION},x.getChunksQuantityForInterval=function(e){var t=J.value*(e/1e3),n=Math.ceil(t*(1+R.PEER_UPLOAD_CAPACITY_EXTRA_RATIO)/(8*R.CHUNK_SIZE/1024)),a=Math.floor(n*R.PEER_UPLOAD_CAPACITY_SAFE_RATIO/(1+R.PEER_UPLOAD_CAPACITY_EXTRA_RATIO)),i=n-a;return(0,r.default)(new S.default,{safe:a,unsafe:i})},x.getCreationTimestamp=function(){return V},x.locked=function(){return De()&&(Date.now()-V<R.PEER_INIT_LOCKED_DURATION||F.value/A.abrStats.estimatedBitrate>R.PEER_LOCKED_UPLOAD_THRESHOLD||B.value/A.abrStats.estimatedBitrate>R.PEER_LOCKED_DOWNLOAD_THRESHOLD)},x.getHistoricalMeanRtt=function(){return q},x.getDebugInfos=function(){return{id:b.slice(-7),RawDownloadSpeed:new c.BitDataAmount(1e3*Z,"ps"),RawUploadSpeed:new c.BitDataAmount(1e3*$,"ps"),DataDownloaded:new c.ByteDataAmount(Y),DataUploaded:new c.ByteDataAmount(U.dataUploaded),RTT:n.getRtt()>=0?n.getRtt():"unavailable",UploadCapacity:new c.BitDataAmount(1e3*J.value,"ps"),ConenctedDuration:Math.round((Date.now()-V)/1e3),OngoingRequests:le.size,GracingRequests:ce.size,RequestedChunks:ee,GracedChunks:ne,TimeoutChunks:te,LateChunks:re,GracedRatio:(ee?ne/ee:0).toFixed(2),TimeoutRatio:(ee?te/ee:0).toFixed(2),LateRatio:(ee?re/ee:0).toFixed(2),SmoothedUsefulDownloadSpeed:new c.ByteDataAmount(1e3*this.getUsefulDlSpeedEMA()/8,"ps"),SmoothedUploadSpeed:new c.ByteDataAmount(1e3*this.getUpSpeedEMA()/8,"ps"),WindowedTimeoutRatio:Pe().toFixed(2),PeerStatus:(this.locked()?"locked":"unlocked")+"-"+(this.isLooser()?"looser":"normal"),LastCRank:this.lastCRank?this.lastCRank.toFixed(2):"unavailable",SeederTimeoutRatio:Pe(R.BLOCK_SEEDER_SCHEDULING_WINDOW).toFixed(2),SeederBanned:this.isBannedSeeder(),VideoTrack:Q,SameTrack:De(),SameTrackTime:Math.round(ye()/1e3)}},J=new d.default(A,x,C),oe=(0,u.createInterval)(ve,R.PEER_SPEED_MONITOR_INTERVAL),U.onTransfering=Ce,n.once(h.default.PeerConnection.DISCONNECTED,function(){L.disconnected++,q.count>0&&L.endedConnectionP2pRttSamples.addSample(q.mean),L.sampledPeerStatsQueue.addSample({connectionDuration:(Date.now()-V)/1e3,sameTrackTime:ye()/1e3}),L.residualDisconnectedPeerDuration+=(Date.now()-A.lastStatPayloadTimestamp)/1e3,M.emit(h.default.Peer.PEER_DISCONNECTED,x),n.removeListener(h.default.PeerConnection.BINARY_DATA_RECEIVED,Ae),n.removeListener(h.default.PeerConnection.MESSAGE_RECEIVED,Te),M.off("segmentInfo",Re),M.off(h.default.Metrics.TRACK_SWITCH,Se),oe?oe.clear():P.errorFunnel.notifyError(new Error("clear() call on undefined Peer.speedMonitorTimer")),U.dispose(),J.dispose(),n.destroy()}),n.on(h.default.PeerConnection.BINARY_DATA_RECEIVED,Ae),n.on(h.default.PeerConnection.MESSAGE_RECEIVED,Te),M.once("segmentInfo",Re),M.on(h.default.Metrics.TRACK_SWITCH,Se),G.push(0),j.push(0),Ee(),D={platform:A.uaHelper.getPlatform(),property:A.conf.PROPERTY,uaName:A.uaHelper.getJavaScriptEngine().name,uaOs:A.uaHelper.getOperatingSystem().name},n.sendMessage("info",{info:D})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uInt8ArrayToString=t.utf8StringToUint8Array=t.ipv6StringToArray=t.BitDataAmount=t.ByteDataAmount=t.DataAmount=t.base64ToIpPort=t.ipPortToBase64=t.base64ToHexHash=t.hexHashToBase64=t.numToUint8Array4=t.uint16ToUint8Array2=t.BIG_ENDIAN=t.LITTLE_ENDIAN=void 0;var r=d(n(13)),a=d(n(11)),i=d(n(12)),o=d(n(1)),u=d(n(2)),s=d(n(100)),l=d(n(259)),c=d(n(17)),f=d(n(585));function d(e){return e&&e.__esModule?e:{default:e}}var h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Math.floor(e/256),r=e%256;return 0===t?new Uint8Array([r,n]):new Uint8Array([n,r])};function _(e){for(var t=[0,0,0,0,0,0,0,0],n=e.split(":"),r=0;""!==n[r]&&r<8;)t[r]=(0,l.default)(n[r],16),r++;if(r<7){r=7;for(var a=n.length-1;""!==n[a];)t[r]=(0,l.default)(n[a],16),r--,a--}return t}var p=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;(0,o.default)(this,e),this.decoratedValue={value:t,stringRep:this._format(t,n,r,a,i)}}return(0,u.default)(e,[{key:"_format",value:function(e,t,n,r,a){if(e<1)return"0"+t+r;var i=["","K","M","G","T","P","E","Z","Y"],o=Math.min(Math.floor(Math.log(e)/Math.log(n)),i.length-1);return parseFloat((e/Math.pow(n,o)).toFixed(a))+i[o]+t+r}},{key:"valueOf",value:function(){return this.decoratedValue.value}},{key:"toString",value:function(){return this.decoratedValue.stringRep}}]),e}(),v=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return(0,o.default)(this,t),(0,a.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,"B",1e3,n,i))}return(0,i.default)(t,e),t}(p),E=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;return(0,o.default)(this,t),(0,a.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,"b",1e3,n,i))}return(0,i.default)(t,e),t}(p);t.LITTLE_ENDIAN=0,t.BIG_ENDIAN=1,t.uint16ToUint8Array2=h,t.numToUint8Array4=function(e){var t=h(Math.floor(e/65536)),n=h(e%65536);return new Uint8Array([n[0],n[1],t[0],t[1]])},t.hexHashToBase64=function(e){var t=[],n=!0,r=!1,a=void 0;try{for(var i,o=(0,c.default)(e.split(":"));!(n=(i=o.next()).done);n=!0){var u=i.value;t.push((0,l.default)(u,16))}}catch(e){r=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}return f.default.fromByteArray(new Uint8Array(t))},t.base64ToHexHash=function(e){var t=f.default.toByteArray(e),n="",r=!0,a=!1,i=void 0;try{for(var o,u=(0,c.default)(t);!(r=(o=u.next()).done);r=!0){var s=o.value.toString(16).toUpperCase();2!==s.length&&(s="0"+s[0]),0===n.length?n+=s:n+=":"+s}}catch(e){a=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(a)throw i}}return n},t.ipPortToBase64=function(e,t){var n=[],r=void 0;if(e.indexOf(".")>-1){var a=!0,i=!1,o=void 0;try{for(var u,s=(0,c.default)(e.split("."));!(a=(u=s.next()).done);a=!0){var d=u.value;n.push((0,l.default)(d,10))}}catch(e){i=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}n.push(Math.floor(t/256)),n.push(t%256),r=new Uint8Array(n)}else if(e.indexOf(":")>-1){(n=_(e)).push(t);var h=new Uint16Array(n);r=new Uint8Array(h.buffer)}return f.default.fromByteArray(r)},t.base64ToIpPort=function(e){var t=f.default.toByteArray(e),n=void 0,r=void 0;if(6===t.length)n=t[0]+"."+t[1]+"."+t[2]+"."+t[3],r=256*t[4]+t[5];else{if(18!==t.length)throw new Error("Ip-Port array "+e+" has unexpected length "+t.length);var a=new Uint16Array(t.buffer);n=[].concat((0,s.default)(a.slice(0,8))).map(function(e){return Number(e).toString(16)}).join(":"),r=a[8]}return{ip:n,port:r}},t.DataAmount=p,t.ByteDataAmount=v,t.BitDataAmount=E,t.ipv6StringToArray=_,t.utf8StringToUint8Array=function(e){for(var t=e.length,n=-1,r="undefined"==typeof Uint8Array?new Array(2*t):new Uint8Array(3*t),a=0,i=0,o=0;o!==t;){if(a=e.charCodeAt(o),o+=1,a>=55296&&a<=56319){if(o===t){r[n+=1]=239,r[n+=1]=191,r[n+=1]=189;break}if(!((i=e.charCodeAt(o))>=56320&&i<=57343)){r[n+=1]=239,r[n+=1]=191,r[n+=1]=189;continue}if(o+=1,(a=1024*(a-55296)+i-56320+65536)>65535){r[n+=1]=240|a>>>18,r[n+=1]=128|a>>>12&63,r[n+=1]=128|a>>>6&63,r[n+=1]=128|63&a;continue}}a<=127?r[n+=1]=0|a:a<=2047?(r[n+=1]=192|a>>>6,r[n+=1]=128|63&a):(r[n+=1]=224|a>>>12,r[n+=1]=128|a>>>6&63,r[n+=1]=128|63&a)}return"undefined"!=typeof Uint8Array?new Uint8Array(r.buffer.slice(0,n+1)):r.length===n+1?r:r.slice(0,n+1)},t.uInt8ArrayToString=function(e){var t="",n=void 0,r=void 0,a=void 0,i=void 0,o=e.length;for(n=0;n<o;)switch((r=e[n++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(r);break;case 12:case 13:a=e[n++],t+=String.fromCharCode((31&r)<<6|63&a);break;case 14:a=e[n++],i=e[n++],t+=String.fromCharCode((15&r)<<12|(63&a)<<6|(63&i)<<0)}return t}},function(e,t,n){n(582),e.exports=n(8).Number.parseInt},function(e,t,n){var r=n(10),a=n(583);r(r.S+r.F*(Number.parseInt!=a),"Number",{parseInt:a})},function(e,t,n){var r=n(21).parseInt,a=n(584).trim,i=n(260),o=/^[-+]?0[xX]/;e.exports=8!==r(i+"08")||22!==r(i+"0x16")?function(e,t){var n=a(String(e),3);return r(n,t>>>0||(o.test(n)?16:10))}:r},function(e,t,n){var r=n(10),a=n(123),i=n(52),o=n(260),u="["+o+"]",s=RegExp("^"+u+u+"*"),l=RegExp(u+u+"*$"),c=function(e,t,n){var a={},u=i(function(){return!!o[e]()||"​"!="​"[e]()}),s=a[e]=u?t(f):o[e];n&&(a[n]=s),r(r.P+r.F*u,"String",a)},f=c.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(s,"")),2&t&&(e=e.replace(l,"")),e};e.exports=c},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=l(e),r=n[0],o=n[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,r,o)),s=0,c=o>0?r-4:r,f=0;f<c;f+=4)t=a[e.charCodeAt(f)]<<18|a[e.charCodeAt(f+1)]<<12|a[e.charCodeAt(f+2)]<<6|a[e.charCodeAt(f+3)],u[s++]=t>>16&255,u[s++]=t>>8&255,u[s++]=255&t;2===o&&(t=a[e.charCodeAt(f)]<<2|a[e.charCodeAt(f+1)]>>4,u[s++]=255&t);1===o&&(t=a[e.charCodeAt(f)]<<10|a[e.charCodeAt(f+1)]<<4|a[e.charCodeAt(f+2)]>>2,u[s++]=t>>8&255,u[s++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,i=[],o=0,u=n-a;o<u;o+=16383)i.push(c(e,o,o+16383>u?u:o+16383));1===a?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],a=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,s=o.length;u<s;++u)r[u]=o[u],a[o.charCodeAt(u)]=u;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){for(var a,i,o=[],u=t;u<n;u+=3)a=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(255&e[u+2]),o.push(r[(i=a)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(179)),a=o(n(17)),i=n(56);function o(e){return e&&e.__esModule?e:{default:e}}t.default={decode:function(e){var t=[],n=e.split(","),o=!0,u=!1,s=void 0;try{for(var l,c=(0,a.default)(n);!(o=(l=c.next()).done);o=!0){var f=l.value.split("-"),d=""!==f[0]?Number(f[0]):NaN,h=""!==f[1]?Number(f[1]):NaN;if(1===f.length&&(0,r.default)(d))t.push(d);else{if(2!==f.length||!(0,r.default)(d)||!(0,r.default)(h))throw new Error("P2P protocol error: could not decode chunk batch");t=t.concat((0,i.range)(d,h))}}}catch(e){u=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(u)throw s}}return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(1)),a=l(n(2)),i=l(n(98)),o=l(n(185)),u=n(38),s=n(18);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,n,a){var l=this;(0,r.default)(this,e);var c=t.conf,f=this._getTrimmedWindowTimeout(t),d=new u.Delta(n.getDataDownloaded()),h=new u.Delta(Date.now()),_=new o.default(f),p=new o.default(f);this._capacityEmwa=new i.default(a,c.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP),_.push(n.getChunkTimeoutCount()),p.push(n.getChunkRequestedCount()),this._timer=(0,s.createInterval)(function(){_.push(n.getChunkTimeoutCount()),p.push(n.getChunkRequestedCount());var e=p.delta,t=_.delta,r=d.calcDelta(n.getDataDownloaded()),a=h.calcDelta(Date.now());if(null!==t&&null!==e){var i=8*r/1024*1e3/a,o=e>0?t/e:0;i>=l._capacityEmwa.value?l._capacityEmwa.update(i):o>=c.MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO&&(c.PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO?l._capacityEmwa.update(i,Math.min(o,c.PUC_EMWA_WEIGHT_CAP)):l._capacityEmwa.update(i,c.PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN))}},c.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL)}return(0,a.default)(e,[{key:"_getTrimmedWindowTimeout",value:function(e){var t=e.conf,n=e.moduleState,r=t.PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL,a=n.isLive()?t.LIVE.CHUNK_TIMEOUT:t.CHUNK_TIMEOUT;return r*Math.ceil(a/r)+100}},{key:"dispose",value:function(){this._timer.clear()}},{key:"value",get:function(){return this._capacityEmwa.value}}]),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(13)),a=f(n(1)),i=f(n(2)),o=f(n(11)),u=f(n(12)),s=f(n(261)),l=n(18),c=f(n(85));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,n,i,u,s,c,f){(0,a.default)(this,t);var d=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i,f));d._chunkManager=c,d._peer=u,d._sharedState=s;var h=s.moduleState.isLive()?s.conf.LIVE.CHUNK_TIMEOUT:s.conf.CHUNK_TIMEOUT;return d._timeoutTimer=(0,l.createTimeout)(function(){d._chunkTimedOut()},h),d._timedOut=!1,d}return(0,u.default)(t,e),(0,i.default)(t,[{key:"_chunkTimedOut",value:function(){this._timedOut=!0,this._chunkManager.timeout(this._chunkIndex,this._bandwidthSafety),this._bandwidthSafety===c.default.SAFE?(this._sharedState.efficiencyStats.safeChunkRequestCount++,this._sharedState.efficiencyStats.safeChunkRequestTimeoutCount++):this._bandwidthSafety===c.default.UNSAFE&&(this._sharedState.efficiencyStats.unsafeChunkRequestCount++,this._sharedState.efficiencyStats.unsafeChunkRequestTimeoutCount++),this._peer.timeoutChunk(this)}},{key:"dataDownloaded",value:function(e){this._chunkManager.chunkDownloaded(e,this._chunkIndex,this._peer),this._timedOut||(this._bandwidthSafety===c.default.SAFE?this._sharedState.efficiencyStats.safeChunkRequestCount++:this._bandwidthSafety===c.default.UNSAFE&&this._sharedState.efficiencyStats.unsafeChunkRequestCount++,this._timeoutTimer?this._timeoutTimer.clear():this._sharedState.errorFunnel.notifyError(new Error("clear() call on undefined DownloadChunkRequest.timeoutTimer.")))}},{key:"timestamp",get:function(){return this._timestamp}}]),t}(s.default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(13)),a=s(n(1)),i=s(n(2)),o=s(n(11)),u=s(n(12));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n,i,u,s){(0,a.default)(this,t);var l=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i,s));return l._chunkUpTimeout=u,l}return(0,u.default)(t,e),(0,i.default)(t,[{key:"isExpired",get:function(){return Date.now()-this._timestamp>this._chunkUpTimeout}}]),t}(s(n(261)).default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this._runningAverage=0,this._count=0}return(0,a.default)(e,[{key:"addSample",value:function(e){this._count++,this._runningAverage+=(e-this._runningAverage)/this._count}},{key:"mean",get:function(){return this._runningAverage}},{key:"count",get:function(){return this._count}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(85));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,r.default)(this,e)}return(0,a.default)(e,[{key:"getCapacityOf",value:function(e){switch(e){case i.default.SAFE:return this.safe;case i.default.UNSAFE:return this.unsafe;default:return 0}}},{key:"setCapacityOf",value:function(e,t){switch(e){case i.default.SAFE:this.safe=t;break;case i.default.UNSAFE:this.unsafe=t}}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,a){return new(n(188).default)(e,t,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(1)),a=c(n(2)),i=c(n(72)),o=c(n(594)),u=c(n(184)),s=c(n(3)),l=n(18);c(n(263));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,r.default)(this,e),this._lastCommunication=0,this._isConnected=!0,this._rtt=-1,this._ee=new i.default,this._timerStore=new u.default,this._sharedState=t,this.stats=new o.default}return(0,a.default)(e,[{key:"_checkHeartbeat",value:function(){var e=this,t=(0,l.createInterval)(function(){Date.now()-e._lastCommunication>e._sharedState.conf.CHECK_HEARTBEAT_INTERVAL&&(e._sharedState.controlStats.checkHeartbeatFailed++,e._closeConnectionIfOpen())},this._sharedState.conf.CHECK_HEARTBEAT_INTERVAL);this._timerStore.register(t)}},{key:"_setDisconnected",value:function(){this._isConnected&&(this._isConnected=!1,this._ee.emit(s.default.PeerConnection.DISCONNECTED))}},{key:"_closeConnectionIfOpen",value:function(){throw new Error("Cannot call abstract method")}},{key:"sendMessage",value:function(e,t){throw new Error("Cannot call abstract method")}},{key:"sendBinaryData",value:function(e,t){throw new Error("Cannot call abstract method")}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];(t=this._ee).emit.apply(t,[e].concat(r))}},{key:"on",value:function(e,t){this._ee.on(e,t)}},{key:"once",value:function(e,t){this._ee.once(e,t)}},{key:"removeListener",value:function(e,t){this._ee.removeListener(e,t)}},{key:"getRtt",value:function(){return this._rtt}},{key:"getBufferedAmount",value:function(){throw new Error("Cannot call abstract method")}},{key:"onbufferedamountlow",set:function(e){throw new Error("Cannot call abstract method")}},{key:"connected",get:function(){return this._isConnected}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(131)),o=s(n(595)),u=s(n(187));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){(0,r.default)(this,e),this.establishmentTimestamp=0,this.establishmentDuration=0,this.dataUploaded=0,this.dataDownloaded=0,this.sentChunkRequestCount=0,this.receivedChunkRequestCount=0,this.sentChunkRequestAnsweredCount=0,this.receivedChunkRequestAnsweredCount=0,this.remoteInfo={},this.details={},this.establishmentTimestamp=Date.now(),this.state=u.default.ACTIVE,this._rtt=new i.default,this._uploadCapacity=new i.default,this._sameTrackTime=new o.default}return(0,a.default)(e,[{key:"updateRtt",value:function(e){this._rtt.updateMetric(e)}},{key:"updateUploadCapacity",value:function(e){this._uploadCapacity.updateMetric(e)}},{key:"getAverageRtt",value:function(){return this._rtt.getAverage()}},{key:"getAverageUploadCapacity",value:function(){return this._uploadCapacity.getAverage()}},{key:"updateSameTrack",value:function(e){e?this._sameTrackTime.activate():this._sameTrackTime.deactivate()}},{key:"timeSpentOnSameTrack",get:function(){return this._sameTrackTime.accumulatedActiveTime}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this.reset()}return(0,a.default)(e,[{key:"reset",value:function(){this._startActiveTimestamp=null,this._accumulatedActiveTime=0}},{key:"activate",value:function(){this.isActive||(this._startActiveTimestamp=Date.now())}},{key:"deactivate",value:function(){this.isActive&&(this._accumulatedActiveTime+=Date.now()-this._startActiveTimestamp,this._startActiveTimestamp=null)}},{key:"accumulatedActiveTime",get:function(){var e=this.isActive?Date.now()-this._startActiveTimestamp:0;return this._accumulatedActiveTime+e}},{key:"isActive",get:function(){return null!==this._startActiveTimestamp}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeartbeatPayload=t.RequestChunkPayload=t.HasSegmentPayload=t.RequestHasSegmentPayload=t.InfoPayload=t.MessageTypes=t.PayloadTypes=void 0;var r=i(n(2)),a=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}var o=function e(){(0,a.default)(this,e)};o.INFO="a",o.REQUEST_HAS_SEGMENT="b",o.HAS_SEGMENT="c",o.REQUEST_CHUNK="d",o.HEARTBEAT="e";var u=function e(){(0,a.default)(this,e)};u.INFO="info",u.REQUEST_HAS_SEGMENT="requestHasSegment",u.HAS_SEGMENT="hasSegment",u.REQUEST_CHUNK="requestChunks",u.HEARTBEAT="heartbeat";var s=function(){function e(){(0,a.default)(this,e),this.type=u.INFO,this.info=""}return(0,r.default)(e,[{key:"encode",value:function(){return{a:o.INFO,b:this.info}}}],[{key:"decode",value:function(t){var n=new e;return n.info=t.b,n}}]),e}(),l=function(){function e(){(0,a.default)(this,e),this.type=u.REQUEST_HAS_SEGMENT,this.segmentView=""}return(0,r.default)(e,[{key:"encode",value:function(){return{a:o.REQUEST_HAS_SEGMENT,b:this.segmentView}}}],[{key:"decode",value:function(t){var n=new e;return n.segmentView=t.b,n}}]),e}(),c=function(){function e(){(0,a.default)(this,e),this.type=u.HAS_SEGMENT,this.segmentInfo="",this.pushed=""}return(0,r.default)(e,[{key:"encode",value:function(){return{a:o.HAS_SEGMENT,b:this.segmentInfo,c:this.pushed}}}],[{key:"decode",value:function(t){var n=new e;return n.segmentInfo=t.b,n.pushed=t.c,n}}]),e}(),f=function(){function e(){(0,a.default)(this,e),this.type=u.REQUEST_CHUNK,this.segmentView="",this.ids="",this.safe="",this.requestId=void 0}return(0,r.default)(e,[{key:"encode",value:function(){return{a:o.REQUEST_CHUNK,b:this.segmentView,c:this.ids,d:this.safe,e:this.requestId}}}],[{key:"decode",value:function(t){var n=new e;return n.segmentView=t.b,n.ids=t.c,n.safe=t.d,n.requestId=t.e,n}}]),e}(),d=function(){function e(){(0,a.default)(this,e),this.type=u.HEARTBEAT,this.videoTrack=""}return(0,r.default)(e,[{key:"encode",value:function(){return{a:o.HEARTBEAT,b:this.videoTrack}}}],[{key:"decode",value:function(t){var n=new e;return n.videoTrack=t.b,n}}]),e}();t.PayloadTypes=o,t.MessageTypes=u,t.InfoPayload=s,t.RequestHasSegmentPayload=l,t.HasSegmentPayload=c,t.RequestChunkPayload=f,t.HeartbeatPayload=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TRACK_HASH=void 0;var r=c(n(1)),a=c(n(2)),i=(c(n(72)),n(18)),o=n(56),u=c(n(3)),s=c(n(68)),l=c(n(183));function c(e){return e&&e.__esModule?e:{default:e}}var f=t.DEFAULT_TRACK_HASH="defautTrackHash",d={CONNECTED:"connected",CONNECTING:"connecting",DISCONNECTED:"disconnected",PERMANENTLY_DISCONNECTED:"permanentlyDisconnected"},h="allowed",_="blocked_other",p=function(){function e(t,n,a){var c=this;(0,r.default)(this,e),this._trackerConnection=null,this._state=d.DISCONNECTED,this._onPeersCallback=function(){},this._onTrackerReady=function(e){if(c._state===d.CONNECTING){var t=e.getPeerId(),n=e.getTrackerId();c._trackerConnection=e,c._status.setMyPeerId(t),c._status.setTrackerId(n),c._status.setConnected(!0),c._state=d.CONNECTED,c._eventBus.emit(u.default.Tracker.READY),c._sharedState.externalEventBus.emit(s.default.TRACKER.READY,{trackerId:n})}else e.close()},this._onPeers=function(e){"boolean"==typeof e.becomeSuperSeeder&&(c._sharedState.superSeederMode=e.becomeSuperSeeder?l.default.FORCED:l.default.FORBIDDEN),c._onPeersCallback(e.peers)},this._onRejected=function(){c.disconnect();var e=(0,o.randomInRange)(0,c._sharedState.conf.REQUEST_RETRY.TRACKER.MAX_REINIT_DELAY);c._reInitTimeout=(0,i.createTimeout)(c._onConnectionRequest,e)},this._sharedState=a,this._eventBus=a.eventBus,this._status=a.status,this._moduleState=a.moduleState,this._trackerProtocolVersion=a.conf.CLIENT_TRACKER_PROTOCOL_VERSION,this._playerInterface=t,this._p2pCacheStats=n,this._onConnectionRequest=function(){c._init()},this._onDisconnectionRequest=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];c.disconnect(e)},a.eventBus.on(u.default.Tracker.TRACKER_CONNECTION_REQUEST,this._onConnectionRequest),a.eventBus.on(u.default.Tracker.TRACKER_DISCONNECTION_REQUEST,this._onDisconnectionRequest),this._init()}return(0,a.default)(e,[{key:"dispose",value:function(){this._eventBus.removeListener(u.default.Tracker.TRACKER_CONNECTION_REQUEST,this._onConnectionRequest),this._eventBus.removeListener(u.default.Tracker.TRACKER_DISCONNECTION_REQUEST,this._onDisconnectionRequest);this.disconnect(!0)}},{key:"_getTrackerActivationStatus",value:function(){var e=h;return this._state===d.PERMANENTLY_DISCONNECTED&&(e=_),e}},{key:"_init",value:function(){var e=this._getTrackerActivationStatus();if(e!==h)return this._eventBus.emit(u.default.Tracker.BLOCKED,{reason:e}),void this._sharedState.externalEventBus.emit(s.default.TRACKER.FAILED,{reason:e,trackerId:this._status.getTrackerId()});if(this._state!==d.CONNECTING&&this._state!==d.CONNECTED){this._state=d.CONNECTING;var t={url:this._sharedState.conf.TRACKER_URL,customerId:this._sharedState.conf.ID_CLIENT,contentId:this._moduleState.content,trackerId:this._status.getTrackerId(),siteId:this._sharedState.peerAgentConfig.siteId||void 0,p2pProtocolVersion:this._sharedState.conf.P2P_PROTOCOL_VERSION,isLive:this._moduleState.isLive(),bufferTarget:this._moduleState.isLive()?this._playerInterface.getBufferTarget():void 0,superSeederRatio:this._sharedState.peerAgentConfig.propertyParameters.superSeederRatio||void 0};this._sharedState.trackerFactory.create(t,this._onTrackerReady)}}},{key:"_getVideoTrackHash",value:function(){var e=this._moduleState.currentTracks.video;return e?e.viewToString():f}},{key:"askPeers",value:function(e,t){var n=this._trackerConnection;if(n){this._onPeersCallback=t;var r={exclusions:e,tracks:[this._getVideoTrackHash()],number:this._sharedState.conf.MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE,currentPosition:null!==this._moduleState.videoCurrentTime?this._moduleState.videoCurrentTime:void 0,nearEdge:this._p2pCacheStats.getStats()&&this._moduleState.isLive()?this._moduleState.isNearEdge:void 0,superSeederRatio:this._sharedState.peerAgentConfig.propertyParameters.superSeederRatio};n.askPeers(r,this._onPeers,this._onRejected)}}},{key:"disconnect",value:function(e){this._trackerConnection&&(this._trackerConnection.close(),this._trackerConnection=null),this._reInitTimeout&&(this._reInitTimeout.clear(),this._reInitTimeout=null),this._state!==d.CONNECTING&&this._state!==d.CONNECTED||(this._state=e?d.PERMANENTLY_DISCONNECTED:d.DISCONNECTED,this._status.setConnected(!1),this._eventBus.emit(u.default.Tracker.DISCONNECTED))}}]),e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=d(n(17)),a=d(n(13)),i=d(n(1)),o=d(n(2)),u=d(n(11)),s=d(n(12)),l=d(n(599)),c=d(n(3)),f=n(18);function d(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,i.default)(this,t);var r=[],o=(0,u.default)(this,(t.__proto__||(0,a.default)(t)).call(this,r));return o._peerIds=r,o._peerConnector=e,o._sharedState=n,o._onTS=o._onTrackSwitch.bind(o),o._sharedState.eventBus.on(c.default.Metrics.TRACK_SWITCH,o._onTS),o}return(0,s.default)(t,e),(0,o.default)(t,[{key:"dispose",value:function(){this._tryDequeueTimer&&this._tryDequeueTimer.clear(),this._sharedState.eventBus.removeListener(c.default.Metrics.TRACK_SWITCH,this._onTS)}},{key:"flush",value:function(){this._sharedState.peerStats.excessMatch+=this._peerIds.length,this._peerIds.length=0}},{key:"onPeersFromTracker",value:function(e){if(0!==e.length){this.flush(),this._sharedState.peerStats.match+=e.length;var t=!0,n=!1,a=void 0;try{for(var i,o=(0,r.default)(e);!(t=(i=o.next()).done);t=!0){var u=i.value;this.push(u)}}catch(e){n=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw a}}void 0===this._tryDequeueTimer&&this._createTryDequeueTimer()}}},{key:"_onTrackSwitch",value:function(e){e.isVideo&&this.flush()}},{key:"_createTryDequeueTimer",value:function(){this._tryDequeueTimer=(0,f.createInterval)(this._onTryDequeueTimer.bind(this),this._sharedState.conf.CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL)}},{key:"_onTryDequeueTimer",value:function(){var e=Math.min(this._peerIds.length,this._peerConnector.getOpenConnectorSlotsCount());e>0&&this.tryDequeueN(e)}},{key:"_canDequeue",value:function(){return this._peerIds.length>0&&this._peerConnector.getOpenConnectorSlotsCount()>this._sharedState.conf.RESERVED_OFFER_SLOTS&&(0===this._sharedState.conf.MAX_CONCURRENT_CONNECTION_ESTABLISHMENT||this._peerConnector.getPeerConnectionCount()<this._sharedState.conf.MAX_CONCURRENT_CONNECTION_ESTABLISHMENT)}},{key:"_dequeuedCallback",value:function(e){this._peerConnector.createPeerConnection(e)}}]),t}(l.default);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){(0,r.default)(this,e),this._internalQueue=t}return(0,a.default)(e,[{key:"_canDequeue",value:function(){return!0}},{key:"_dequeuedCallback",value:function(e){}},{key:"_emptyCallback",value:function(){}},{key:"_validateItem",value:function(e){return!0}},{key:"push",value:function(e){this._internalQueue.push(e),this.tryDequeue()}},{key:"_skipInvalidItems",value:function(){for(var e=this._internalQueue.shift();void 0!==e&&!this._validateItem(e);)e=this._internalQueue.shift();return e}},{key:"tryDequeue",value:function(){if(this._canDequeue()){var e=this._skipInvalidItems();e?this._dequeuedCallback(e):this._emptyCallback()}}},{key:"tryDequeueN",value:function(e){for(;this._canDequeue()&&e>0;){var t=this._skipInvalidItems();if(!t){this._emptyCallback();break}this._dequeuedCallback(t),e--}}},{key:"tryDequeueAll",value:function(){for(;this._canDequeue();){var e=this._skipInvalidItems();if(!e){this._emptyCallback();break}this._dequeuedCallback(e)}}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(48)),a=c(n(100)),i=c(n(83)),o=c(n(17)),u=c(n(20)),s=c(n(1)),l=c(n(2));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,n,r){(0,s.default)(this,e),this._peerPool=t,this._peerConnector=n,this._secondOrderExclusions=new u.default,this._sharedState=r}return(0,l.default)(e,[{key:"addSecondOrderExclusion",value:function(e,t,n,r){this._secondOrderExclusions.set(e,{rank:t,releaseTimestamp:Date.now()+n,tag:r})}},{key:"_clearExpiredExclusions",value:function(){var e=Date.now(),t=!0,n=!1,r=void 0;try{for(var a,u=(0,o.default)(this._secondOrderExclusions.entries());!(t=(a=u.next()).done);t=!0){var s=(0,i.default)(a.value,2),l=s[0];s[1].releaseTimestamp<=e&&this._secondOrderExclusions.delete(l)}}catch(e){n=!0,r=e}finally{try{!t&&u.return&&u.return()}finally{if(n)throw r}}}},{key:"exclusionList",get:function(){this._clearExpiredExclusions();var e=this._peerConnector.getPendingConnectionPeers(),t=!0,n=!1,u=void 0;try{for(var s,l=(0,o.default)(this._peerPool.getPeerArray());!(t=(s=l.next()).done);t=!0){var c=s.value;e.push(c.getId())}}catch(e){n=!0,u=e}finally{try{!t&&l.return&&l.return()}finally{if(n)throw u}}var f=Math.max(this._sharedState.conf.MAX_TRACKER_EXCLUSION_LENGTH-e.length,0);if(f>=this._secondOrderExclusions.size)return[].concat((0,a.default)(e),(0,a.default)(this._secondOrderExclusions.keys()));var d=Date.now(),h=(0,r.default)(this._secondOrderExclusions.entries());h.sort(function(e,t){var n=(0,i.default)(e,2),r=(n[0],n[1]),a=(0,i.default)(t,2),o=(a[0],a[1]);return(o.releaseTimestamp-d)*o.rank-(r.releaseTimestamp-d)*r.rank});var _=h.map(function(e){var t=(0,i.default)(e,2),n=t[0];t[1];return n});return[].concat((0,a.default)(e),(0,a.default)(_.slice(0,f)))}},{key:"secondOrderExclusions",get:function(){return this._clearExpiredExclusions(),this._secondOrderExclusions}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(1)),a=f(n(2)),i=f(n(184)),o=n(18),u=n(38),s=n(56),l=f(n(602)),c=f(n(98));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){var n=this;(0,r.default)(this,e),this._sharedState=t;var a=t.conf,s=t.transferStats,f=t.abrStats;this._conf=a,this._transferStats=s,this._abrStats=f,this._p2pMediaDownloadedDelta=new u.Delta,this._p2pTimeElapsedDelta=new u.Delta(Date.now());var d=a.P2P_SPEED_ESTIMATION_BUCKET_COUNT*a.P2P_SPEED_ESTIMATION_BUCKET_DURATION;this._p2pMediaDownloadedSMWA=new l.default(d),this._p2pMediaDownloadedEMWA=new c.default(0,a.P2P_SPEED_EMA_WEIGHT),this._p2pMediaDownloadedLongSMA=new l.default(a.P2P_USEFUL_SMA_WINDOW),this._p2pMediaDownloadedLongDelta=new u.Delta,this._p2pUsefulLongSMA=new l.default(a.P2P_USEFUL_SMA_WINDOW),this._p2pUsefulLongDelta=new u.Delta,this._timerStore=new i.default,this._ewmaZeroWeight=1-Math.exp(Math.log(.5)*a.MEAN_SPEED_CALCULATION_INTERVAL/a.P2P_SPEED_EMA_ZERO_HALF_LIFE);var h=(0,o.createInterval)(function(){n._computeMeanInstantSpeed()},a.MEAN_SPEED_CALCULATION_INTERVAL),_=(0,o.createInterval)(function(){n._computeDeltaP2PSpeed()},a.P2P_SPEED_ESTIMATION_BUCKET_DURATION),p=(0,o.createInterval)(function(){n._updateUsefulP2PRatio()},a.P2P_USEFUL_CALCULATION_INTERVAL);this._timerStore.register(h),this._timerStore.register(_),this._timerStore.register(p)}return(0,a.default)(e,[{key:"getP2PSpeedEstimate",value:function(){var e=this._p2pMediaDownloadedEMWA.value;return e*(1-this._conf.P2P_USEFUL_RATIO_WEIGHT)+e*this._abrStats.p2pUsefulEstimate*this._conf.P2P_USEFUL_RATIO_WEIGHT}},{key:"_updateUsefulP2PRatio",value:function(){var e=this._p2pUsefulLongDelta.calcDelta(this._transferStats.p2pUseful),t=this._p2pMediaDownloadedLongDelta.calcDelta(this._transferStats.p2pMediaDownloaded);t>0&&(this._p2pMediaDownloadedLongSMA.addPoint(t),this._p2pUsefulLongSMA.addPoint(e));var n=this._p2pMediaDownloadedLongSMA.computeSum(),r=this._p2pUsefulLongSMA.computeSum(),a=8*n/this._conf.P2P_USEFUL_SMA_WINDOW<this._conf.P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION?1:Math.min(1,r/n);this._abrStats.p2pUsefulEstimate=(0,s.toDecimal)(a,3)}},{key:"_computeMeanInstantSpeed",value:function(){var e=this._p2pMediaDownloadedSMWA.compute();e<0?this._sharedState.errorFunnel.notifyError(new Error("Negative p2pMediaDownloaded delta.")):this._p2pMediaDownloadedEMWA.value<this._conf.P2P_SPEED_ZERO_THRESHOLD?this._p2pMediaDownloadedEMWA.update(e,1):e>0?this._p2pMediaDownloadedEMWA.update(e):0===e&&this._p2pMediaDownloadedEMWA.update(e,this._ewmaZeroWeight),this._abrStats.p2pSpeed=this.getP2PSpeedEstimate()}},{key:"_computeDeltaP2PSpeed",value:function(){var e=this._p2pMediaDownloadedDelta.calcDelta(this._transferStats.p2pMediaDownloaded),t=this._p2pTimeElapsedDelta.calcDelta(Date.now());e>0&&t>0?this._p2pMediaDownloadedSMWA.addPoint(8*e/t):e<0&&this._sharedState.errorFunnel.notifyError(new Error("Negative p2pMediaDownloaded delta."))}},{key:"dispose",value:function(){this._timerStore.clearAll()}}]),e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(603),i=(r=a)&&r.__esModule?r:{default:r};t.default=function(e){var t=[],n=e,r=function(){var e=function(){for(var e=-1,r=Date.now(),a=0;a<t.length&&r-t[a].timestamp()>n;a++)e=a;return e}();e>-1&&t.splice(0,e+1)};this.addPoint=function(e){r();var n=new i.default(e);t.push(n)},this.compute=function(){if(r(),!t.length)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n].value();return e/t.length},this.computeSum=function(){if(r(),!t.length)return 0;for(var e=0,n=0;n<t.length;n++)e+=t[n].value();return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e,n=Date.now();this.timestamp=function(){return n},this.value=function(){return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(120)),a=s(n(1)),i=s(n(2)),o=s(n(605)),u=s(n(611));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n,i,s,l){(0,a.default)(this,e),this.segmentView=t,this.chunkManager=new o.default(t,n,i,s,l),this.seeders=new u.default(l.conf),(0,r.default)(this)}return(0,i.default)(e,[{key:"dispose",value:function(){this.chunkManager.dispose(),this.seeders.clear()}},{key:"hasChunksToDownload",get:function(){return this.chunkManager.hasChunksToDownload}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(1)),a=l(n(2)),i=l(n(606)),o=l(n(610)),u=l(n(3)),s=l(n(258));function l(e){return e&&e.__esModule?e:{default:e}}var c="pending",f="downloading",d="downloaded",h="CDNdownloaded",_="failed",p=function(){function e(t,n,a,i,o){(0,r.default)(this,e),this._sharedState=o,this._conf=o.conf,this._transferStats=o.transferStats,this._controlStats=o.controlStats,this._segmentHasher=o.segmentHasher,this._p2pCache=n,this._dataLocked=!1,this._downloadStatus=[],this._writeLock=!1,this._isEmpty=!0,this._partialSegmentRequested=!1,this._broadcastedSegmentInfoCalled=!1,this._segmentView=t,this._peerPool=a,this._segmentInfoMap=i}return(0,a.default)(e,[{key:"_initChunkStatus",value:function(){var e=Math.ceil(this.size/this._conf.CHUNK_SIZE);s.default.clear(this._downloadStatus);for(var t=0;t<e;t++)this._downloadStatus.push(c)}},{key:"setSegmentSize",value:function(e){this.size||(this.size=e,this.segmentData=new o.default(e),this._initChunkStatus())}},{key:"getNumberOfChunks",value:function(){return this._downloadStatus.length}},{key:"getChunk",value:function(e){if(!this._dataLocked&&this._isChunkP2POrCDNDownloaded(e)){var t=this._conf.CHUNK_SIZE,n=e*this._conf.CHUNK_SIZE;return n+t>this.size&&(t=this.size-n),this.segmentData.getBinaryData(n,t)}return null}},{key:"_getConsecutiveChunksCount",value:function(e,t,n){for(var r=1,a=1===t?0:e.length-1,i=1===t?e.length-1:0,o=a;o!==i;o+=t){var u=o+t;if(u>=0&&u<=e.length-1){if(1!==Math.abs(e[o]-e[u])||r===n)break;r++}}return r}},{key:"_getRemainingChunks",value:function(){for(var e=[],t=0,n=this._downloadStatus.length;t<n;t++)this._downloadStatus[t]!==_&&this._downloadStatus[t]!==c||e.push(t);return e}},{key:"_encodePartialBatchStr",value:function(e,t){var n=e;return e&&(n+=","),n+=""+t[0],t.length>1&&(n+="-"+t[t.length-1]),n}},{key:"getNextChunks",value:function(e){for(var t="",n=e,r=this._getRemainingChunks();r.length>0&&n>0;){var a=r[0],i=r[r.length-1],o=void 0,u=void 0;if(this._downloadStatus.length-1-i===a){var s=this._getConsecutiveChunksCount(r,1,n),l=this._getConsecutiveChunksCount(r,-1,n);o=(u=Math.max(s,l))===s?1:-1}else o=this._downloadStatus.length-1-i>a?1:-1,u=this._getConsecutiveChunksCount(r,o,n);var c=1===o?0:r.length-u,d=r.splice(c,u);d=1===o?d:d.reverse(),t=this._encodePartialBatchStr(t,d),n-=d.length;for(var h=0,_=d.length;h<_;h++)this._downloadStatus[d[h]]=f}return{encoded:t,size:e-n}}},{key:"chunkDownloaded",value:function(e,t,n){if(!this.segmentData||t>=this._downloadStatus.length)return this._transferStats.multipleDlM+=e.byteLength,void e.destroy();if(this._isEmpty=!1,this._isChunkP2POrCDNDownloaded(t)||this._writeLock){var r=this._downloadStatus[t];r===d?this._transferStats.multipleDlPP+=e.byteLength:(r===h||this._writeLock)&&(this._transferStats.multipleDlCP+=e.byteLength),e.destroy()}else{try{this.segmentData.setBinaryData(e,t*this._conf.CHUNK_SIZE)}catch(r){this._transferStats.multipleDlHP+=e.byteLength,e.destroy(),this._downloadStatus[t]=_;var a=this._p2pCache.getSegmentHandler(this._segmentView);return a&&a.seeders.remove(n),void this._sharedState.errorFunnel.notifyError(r)}if(this._downloadStatus[t]=d,this.isSegmentDownloaded()){this.lockSegmentData(),this._checkHashP2P();var i=this._p2pCache.getSegmentHandler(this._segmentView);i&&i.seeders.clear()}this._broadcastSegmentInfo()}this._sharedState.eventBus.emit(u.default.ChunkManager.CHUNK_DOWNLOADED)}},{key:"timeout",value:function(e){this._downloadStatus[e]===f&&(this._downloadStatus[e]=_)}},{key:"isSegmentDownloaded",value:function(){var e=this;return!!this.size&&this._downloadStatus.every(function(t,n){return e._isChunkP2POrCDNDownloaded(n)})}},{key:"shouldDownloadSegment",value:function(){return!this.isSegmentDownloaded()&&!this.partialSegment&&!this._partialSegmentRequested}},{key:"getPartialSegment",value:function(){var e=this;return this._partialSegmentRequested=!0,!(this._isEmpty||!this.size)&&(e.partialSegment||e._dataLocked||(e.partialSegment=new i.default(e._segmentView,e._p2pCache,e._downloadStatus,e,e.isSegmentDownloaded(),e._segmentInfoMap,e._sharedState)),this._dataLocked||(this._writeLock=!0),this.partialSegment)}},{key:"getPercentageOfChunksDownloaded",value:function(){var e=this;return this._downloadStatus.reduce(function(t,n,r){return t+(e._isChunkP2POrCDNDownloaded(r)?1/e.getNumberOfChunks()*100:0)},0)}},{key:"storeSegment",value:function(e){this._isEmpty=!1,this.segmentData&&!this.segmentData.equals(e)&&this.segmentData.destroy(),this.segmentData=e,this.size||(this.size=this.segmentData.byteLength,this._initChunkStatus()),this._updateDownloadStatus(),this._transferStats.p2pUseful+=this.getP2PAndCDNDownloads().p2pDownloaded}},{key:"_broadcastSegmentInfo",value:function(){var e=this.getPercentageOfChunksDownloaded();!this._broadcastedSegmentInfoCalled&&e>=this._conf.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER&&(this._broadcastedSegmentInfoCalled=!0,this._peerPool.broadcastSegmentInfo(this._segmentView))}},{key:"_updateDownloadStatus",value:function(){var e=void 0;e={start:0,end:this.getNumberOfChunks()},this.partialSegment&&this.partialSegment.getCDNIndexRange()&&(e=this.partialSegment.getCDNIndexRange());for(var t=e.start;t<e.end;t++){if(this._isChunkP2POrCDNDownloaded(t)){var n=this._conf.CHUNK_SIZE;t===this.getNumberOfChunks()-1&&(n=this.size-(this.getNumberOfChunks()-1)*this._conf.CHUNK_SIZE),this._downloadStatus[t]===d?this._transferStats.multipleDlPC+=n:this._downloadStatus[t]===h&&(this._transferStats.multipleDlCC+=n)}this._downloadStatus[t]=h}}},{key:"getP2PAndCDNDownloads",value:function(){var e=0,t=0,n=this.getNumberOfChunks()-1;if(this.size)for(var r=0;r<this._downloadStatus.length;r++){var a=void 0,i=this._downloadStatus[r];a=r<n?this._conf.CHUNK_SIZE:this.size-n*this._conf.CHUNK_SIZE,i===d?e+=a:i===h&&(t+=a)}return{p2pDownloaded:e,cdnDownloaded:t}}},{key:"lockSegmentData",value:function(){this._dataLocked=!0}},{key:"unlockSegmentData",value:function(){this._dataLocked=!1}},{key:"removePartialSegment",value:function(){delete this.partialSegment}},{key:"_checkHashP2P",value:function(){var e=this,t=this._segmentInfoMap.getSegmentInfo(this._segmentView);if(t){this._segmentHasher.calculateHash(this.segmentData,function(n,r){var a=function(){e._p2pCache.removeSegmentHandler(t.segmentView),n.destroy()};if(t.hash===r){e._controlStats.nbRightHashP2P++;try{e.segmentData=n}catch(t){return a(),e._transferStats.multipleDlM+=e.size,void e._sharedState.errorFunnel.notifyError(t)}e._transferStats.p2pUseful+=e.size,e.unlockSegmentData()}else a(),e._controlStats.nbWrongHashP2P++,e._transferStats.multipleDlHP+=e.size})}}},{key:"_isChunkP2POrCDNDownloaded",value:function(e){var t=this._downloadStatus[e];return t===d||t===h}},{key:"dispose",value:function(){this.segmentData&&this.segmentData.destroy()}},{key:"hasChunksToDownload",get:function(){return this._downloadStatus.indexOf(_)>=0||this._downloadStatus.indexOf(c)>=0}}]),e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(607)),a=c(n(13)),i=c(n(1)),o=c(n(11)),u=c(n(12)),s=c(n(256)),l=c(n(181));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,n,u,s,c,f,d){(0,i.default)(this,t);var h=d.conf,_=d.status,p=d.eventBus,v=d.segmentHasher,E=d.controlStats,g=d.transferStats,m=d.moduleState,S=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this)),y=c,T=e,A=f,C=g,D=E,P=void 0,R=void 0,w=void 0,O=void 0,I=0,k=!1,N=!1;function M(){n.fillSegment(T,s.segmentData),s.removePartialSegment(),s.unlockSegmentData()}return S.getFullSegment=function(t,r,a){if(this.isComplete())r(s.segmentData,null),s.removePartialSegment();else if(s.lockSegmentData(),p.emit("CDNSegmentDownloaded",T),I=(o=t).byteLength,d.transferStats.cdnDownloaded+=o.byteLength,function(t){if(void 0===P)throw new Error("assertion: _cdnIndexRange is not defined");if(void 0===s.segmentData)throw new Error("assertion: chunkManager.segmentData is not defined");d.conf.RESET_SIZE_ON_CDN_MISMATCH&&0===P.start&&P.end===u.length&&(t.byteLength!==s.segmentData.byteLength&&(r=t.byteLength,a=n.resetSegmentHandler(e),(s=a.chunkManager).setSegmentSize(r),N=!0,D.mismatchedSegmentPCCount++),D.totalSegmentPCCount++);var r,a;if(d.conf.ENABLE_RR_PREVENT_FULL_SEGMENT_DISCARDING)t.byteLength!==s.segmentData.byteLength||0===P.start&&P.end===u.length||(P.start=0,P.end=R.length,w=0,k=!0),s.segmentData.setBinaryData(t,P.start*h.CHUNK_SIZE);else try{s.segmentData.setBinaryData(t,P.start*h.CHUNK_SIZE)}catch(e){throw d.errorFunnel.notifyError(e),new Error("Invalid configuration: The current stream has no range request enabled and the p2p configuration has range request set to true.")}}(t),0!==w||k){var i=A.getSegmentInfo(T);i?function(e,t,r){v.calculateHash(s.segmentData,function(a,i){e.hash===i?(D.nbRightHashDLM++,s.segmentData=a,M(),t(s.segmentData,T)):(D.nbWrongHashDLM++,C.multipleDlHD+=I,C.multipleDlHP+=w,n.removeSegmentHandler(T),r())})}(i,r,a):a()}else N||d.conf.FORCE_REHASH_ON_FULL_CDN_PARTIAL_SEGMENT?function(e){v.calculateHash(s.segmentData,function(t,n){var r=new l.default(T,t.byteLength,n,!0);f.addSegmentInfo(r),s.segmentData=t,M(),e(s.segmentData,T)})}(r):(M(),r(s.segmentData,T));var o},S.getUpdatedRange=function(e){if(!m.rangeRequestStatus.canDoRR)return e;var t=void 0;if(void 0===P.start||void 0===P.end)throw new Error("PartialSegmentP2P: getUpdatedRange called with complete segment");var n=e?e.start+P.start*h.CHUNK_SIZE:P.start*h.CHUNK_SIZE;P.end===R.length&&e?t=e.end:P.end<R.length&&(t=e?e.start+P.end*h.CHUNK_SIZE-1:P.end*h.CHUNK_SIZE-1);return{start:n,end:t}},S.getCDNIndexRange=function(){return P},S.isComplete=function(){return y},S.isLocked=function(){return s._dataLocked},function(){if(!u.length)throw new Error("PartialSegmentP2P should not be instantiated with an empty segment");R=u.slice(),P=m.rangeRequestStatus.canDoRR?{start:function(){for(var e=0;e<R.length;e++)if("downloaded"!==R[e]&&"CDNdownloaded"!==R[e])return e}(),end:function(){for(var e=R.length-1;e>=0;e--)if("downloaded"!==R[e]&&"CDNdownloaded"!==R[e])return e+1}()}:{start:0,end:R.length},y?w=s.segmentData.byteLength:(w=P.start*h.CHUNK_SIZE,P.end&&P.end<R.length&&(w+=(R.length-P.end-1)*h.CHUNK_SIZE,w+=s.segmentData.byteLength-(R.length-1)*h.CHUNK_SIZE)),O=_.getMeanInstantSpeed()}(),(0,r.default)(S,{p2pSpeed:{get:function(){return O},set:void 0},p2pAmount:{get:function(){return w},set:void 0},byteLength:{get:function(){return s.segmentData.byteLength},set:void 0}}),S}return(0,u.default)(t,e),t}(s.default);t.default=f},function(e,t,n){e.exports={default:n(608),__esModule:!0}},function(e,t,n){n(609);var r=n(8).Object;e.exports=function(e,t){return r.defineProperties(e,t)}},function(e,t,n){var r=n(10);r(r.S+r.F*!n(37),"Object",{defineProperties:n(235)})},function(e,t,n){"use strict";e.exports=n(133).default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){var n=this;(0,r.default)(this,e),this._conf=t,this._peers=[],this._peerUpoadCapacityComparator=function(e,t){var r=e.getChunksQuantityForInterval(n._conf.CHUNK_BATCHING_INTERVAL).safe;return t.getChunksQuantityForInterval(n._conf.CHUNK_BATCHING_INTERVAL).safe-r}}return(0,a.default)(e,[{key:"add",value:function(e){this.remove(e),this._peers.push(e)}},{key:"remove",value:function(e){var t=e.getId();this._peers=this._peers.filter(function(e){return e.getId()!==t})}},{key:"all",value:function(){return this._peers.sort(this._peerUpoadCapacityComparator)}},{key:"allNotBanned",value:function(){return this._peers.filter(function(e){return!e.isBannedSeeder()}).sort(this._peerUpoadCapacityComparator)}},{key:"clear",value:function(){this._peers.length=0}},{key:"length",get:function(){return this._peers.length}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(48)),a=c(n(17)),i=c(n(20)),o=c(n(1)),u=c(n(2)),s=c(n(613)),l=c(n(134));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,n){(0,o.default)(this,e),this._sharedState=t,this._mediaMap=n,this._segmentTimelines=new i.default}return(0,u.default)(e,[{key:"dispose",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=(0,a.default)(this._segmentTimelines.values());!(e=(r=i.next()).done);e=!0){r.value.dispose()}}catch(e){t=!0,n=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw n}}this._segmentTimelines.clear(),this._mediaMap=new l.default}},{key:"add",value:function(e){var t=this._findSegmentTrack(e);t&&this.getTrackTimeline(t).add(e)}},{key:"remove",value:function(e){var t=this._findSegmentTrack(e);t&&this.getTrackTimeline(t).remove(e)}},{key:"getTrackTimeline",value:function(e){var t=e.viewToString(),n=this._segmentTimelines.get(t);return n||(n=new s.default(this._sharedState,this._mediaMap,e),this._segmentTimelines.set(t,n)),n}},{key:"getCurrentVideoTrackTimeline",value:function(){var e=this._getCurrentVideoTrack();return e?this.getTrackTimeline(e):null}},{key:"getLowerVideoTrackTimelines",value:function(){var e=this._getCurrentVideoBitrate();return this._sortTrackTimelines((0,r.default)(this._segmentTimelines.values()).filter(function(t){return"video"===t.trackView.type&&t.bitrate<e}))}},{key:"getHigherVideoTrackTimelines",value:function(){var e=this._getCurrentVideoBitrate();return this._sortTrackTimelines((0,r.default)(this._segmentTimelines.values()).filter(function(t){return"video"===t.trackView.type&&t.bitrate>e}))}},{key:"getCurrentAudioTrackTimeline",value:function(){var e=this._getCurrentAudioTrack();return e?this.getTrackTimeline(e):null}},{key:"getOtherAudioTrackTimelines",value:function(){var e=this._getCurrentAudioTrack();return this._sortTrackTimelines((0,r.default)(this._segmentTimelines.values()).filter(function(t){return!("video"===t.trackView.type||e&&t.trackView.isEqual(e))}))}},{key:"getAllTrackTimelines",value:function(){return this._sortTrackTimelines((0,r.default)(this._segmentTimelines.values()))}},{key:"_getCurrentVideoTrack",value:function(){return this._sharedState.moduleState.currentTracks.video||null}},{key:"_getCurrentAudioTrack",value:function(){return this._sharedState.moduleState.currentTracks.audio||null}},{key:"_getCurrentVideoBitrate",value:function(){var e=this._getCurrentVideoTrack();return e?this._mediaMap.getTrackBitrate(e):0}},{key:"getSegmentDuration",value:function(e){return this._mediaMap.getSegmentDuration(e)}},{key:"getTotalDuration",value:function(){return(0,r.default)(this._segmentTimelines.values()).reduce(function(e,t){return e+t.getTotalDuration()},0)}},{key:"_findSegmentTrack",value:function(e){var t=this._mediaMap.getTrackList(),n=!0,r=!1,i=void 0;try{for(var o,u=(0,a.default)(t);!(n=(o=u.next()).done);n=!0){var s=o.value;if(e.isInTrack(s))return s}}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}return null}},{key:"_sortTrackTimelines",value:function(e){return e.sort(function(e,t){return e.bitrate-t.bitrate})}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(134));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n,a){(0,r.default)(this,e),this._sharedState=t,this._mediaMap=n,this._trackView=a,this._bitrate=this._mediaMap.getTrackBitrate(a),this._orderedSegments=[]}return(0,a.default)(e,[{key:"dispose",value:function(){this._orderedSegments.length=0,this._mediaMap=new i.default}},{key:"add",value:function(e){if(!e.isInTrack(this._trackView))throw Error("Segment is not in expected track");if(this._mediaMap.getSegmentDuration(e))if(0!==this._orderedSegments.length){var t=this._mediaMap.getSegmentTime(e);if(t>this._mediaMap.getSegmentTime(this._orderedSegments[this._orderedSegments.length-1]))this._orderedSegments.push(e);else{var n=this._getIndexForTime(t);if(n<this._orderedSegments.length){var r=this._mediaMap.getSegmentTime(this._orderedSegments[n]);r===t?this._orderedSegments[n]=e:r>t?this._orderedSegments.splice(n,0,e):this._orderedSegments.splice(n+1,0,e)}else this._orderedSegments.push(e)}}else this._orderedSegments.push(e);else this._sharedState.errorFunnel.notifyError(new Error("Segment with missing duration was added to the timeline"))}},{key:"remove",value:function(e){if(0!==this._orderedSegments.length&&e.isInTrack(this._trackView))if(this._orderedSegments[0].isEqual(e))this._orderedSegments.shift();else{var t=this._mediaMap.getSegmentTime(e),n=this._getIndexForTime(t);n<this._orderedSegments.length&&this._orderedSegments[n].isEqual(e)&&this._orderedSegments.splice(n,1)}}},{key:"getSegmentsBefore",value:function(e){var t=this._getIndexForTime(e);return this._orderedSegments.slice(0,t)}},{key:"getSegmentsAfter",value:function(e){var t=this._getIndexForTime(e);return this._orderedSegments.slice(t)}},{key:"getSegmentsBeforeTrackEdge",value:function(){return this.getSegmentsBefore(this._sharedState.moduleState.videoCurrentTime||0)}},{key:"getSegmentsAfterTrackEdge",value:function(){return this.getSegmentsAfter(this._sharedState.moduleState.videoCurrentTime||0)}},{key:"getAllSegments",value:function(){return this._orderedSegments}},{key:"getSegmentDuration",value:function(e){return this._mediaMap.getSegmentDuration(e)}},{key:"getTotalDuration",value:function(){var e=this;return this._orderedSegments.reduce(function(t,n){return t+e.getSegmentDuration(n)},0)}},{key:"_getIndexForTime",value:function(e){if(0===this._orderedSegments.length)return 0;for(var t=0,n=this._orderedSegments.length-1;t<n;){var r=Math.floor((t+n)/2),a=this._orderedSegments[r],i=this._mediaMap.getSegmentTime(a),o=this._mediaMap.getSegmentDuration(a);if(i>e)n=r-1;else{if(i+o>e)return r;t=r+1}}var u=t,s=this._orderedSegments[u];return this._mediaMap.getSegmentTime(s)<e&&u++,u}},{key:"trackView",get:function(){return this._trackView}},{key:"bitrate",get:function(){return this._bitrate}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGarbageCollector=function(e,t){if(e.conf.ENABLE_P2P_CACHE_TIMELINE_GC&&!e.moduleState.isLive())return new a.default(e,t);return new r.default(e,t)};var r=i(n(615)),a=i(n(617));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(17)),a=l(n(13)),i=l(n(1)),o=l(n(2)),u=l(n(11)),s=l(n(12));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,u.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_collect",value:function(e){if(e.finished)return!1;var t=this._sharedState.moduleState,n=t.videoTrackEdge,a=t.audioTrackEdge,i=this._p2pCache.getSegmentList(),o=!0,u=!1,s=void 0;try{for(var l,c=(0,r.default)(i);!(o=(l=c.next()).done);o=!0){var f=l.value,d=n&&f.isEqual(n),h=a&&f.isEqual(a);if(d||h)return!0;if(this._removeSegment(f,e),e.finished)break}}catch(e){u=!0,s=e}finally{try{!o&&c.return&&c.return()}finally{if(u)throw s}}return!1}}]),t}(l(n(267)).default);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t,n){(0,r.default)(this,e),this._leftSize=t,this._leftDuration=n}return(0,a.default)(e,[{key:"recordRemoved",value:function(e,t){this._leftSize-=e,this._leftDuration-=t}},{key:"finished",get:function(){return this._leftSize<=0&&this._leftDuration<=0}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(17)),a=l(n(13)),i=l(n(1)),o=l(n(2)),u=l(n(11)),s=l(n(12));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,i.default)(this,t),(0,u.default)(this,(t.__proto__||(0,a.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"_collect",value:function(e){if(e.finished)return!1;var t=this._p2pCache.getTimeline(),n=!0,a=!1,i=void 0;try{for(var o,u=(0,r.default)(t.getOtherAudioTrackTimelines());!(n=(o=u.next()).done);n=!0){var s=o.value;if(this._collectTrackBeforeEdge(s,e))return!1;if(this._collectTrackAfterEdge(s,e,!1))return!1}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}var l=!0,c=!1,f=void 0;try{for(var d,h=(0,r.default)(t.getLowerVideoTrackTimelines());!(l=(d=h.next()).done);l=!0){var _=d.value;if(this._collectTrackBeforeEdge(_,e))return!1;if(this._collectTrackAfterEdge(_,e,!1))return!1}}catch(e){c=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(c)throw f}}var p=!0,v=!1,E=void 0;try{for(var g,m=(0,r.default)(t.getHigherVideoTrackTimelines());!(p=(g=m.next()).done);p=!0){var S=g.value;if(this._collectTrackBeforeEdge(S,e))return!1;if(this._collectTrackAfterEdge(S,e,!1))return!1}}catch(e){v=!0,E=e}finally{try{!p&&m.return&&m.return()}finally{if(v)throw E}}var y=t.getCurrentAudioTrackTimeline(),T=t.getCurrentVideoTrackTimeline();return!(!y&&!T)&&((!y||!this._collectTrackBeforeEdge(y,e))&&((!T||!this._collectTrackBeforeEdge(T,e))&&(!e.finished&&(y&&this._collectTrackAfterEdge(y,e,!0),T&&this._collectTrackAfterEdge(T,e,!0),!0))))}},{key:"_collectTrackBeforeEdge",value:function(e,t){var n=!0,a=!1,i=void 0;try{for(var o,u=(0,r.default)(e.getSegmentsBeforeTrackEdge());!(n=(o=u.next()).done);n=!0){var s=o.value;if(t.finished)return!0;this._removeSegment(s,t,!1)}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return!1}},{key:"_collectTrackAfterEdge",value:function(e,t,n){var a=!0,i=!1,o=void 0;try{for(var u,s=(0,r.default)(e.getSegmentsAfterTrackEdge().reverse());!(a=(u=s.next()).done);a=!0){var l=u.value;if(t.finished)return!0;this._removeSegment(l,t,n)}}catch(e){i=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}return!1}}]),t}(l(n(267)).default);t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n){var r=e,a=t;n.eventBus.on("segmentRequested",function(e,t){if(n.dnaTransferStatus.effectiveUploadAllowed&&!n.isP2PUploadBlocked){var i=a.getSegmentHandler(t),o=i?i.chunkManager:null;if(o){var u=o.getPercentageOfChunksDownloaded();if(u>=n.conf.MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER){var s=r.getSegmentInfo(t);s&&e.answerHasSegment(s,{pushed:!1})}}}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createScheduler=function(e,t,n,o){if(o.moduleState.streamType===i.StreamTypes.HLS)return new r.default(e,t,n,o);return new a.default(e,t,n,o)};var r=o(n(620)),a=o(n(623)),i=n(71);function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(13)),a=s(n(1)),i=s(n(2)),o=s(n(11)),u=s(n(12));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,a.default)(this,t),(0,o.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,i.default)(t,[{key:"getSegmentListToDownload",value:function(){var e=[],t=this._currentTracks.video;return t&&(e=this._getSegmentsToDownloadByTrack(t,"video")),this._cachedSegmentToDownload=e.sort(function(e,t){return e.getId()-t.getId()}).slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER),this._cachedSegmentToDownload}},{key:"updateTrackEdge",value:function(e){this._currentTracks.video&&e.isInTrack(this._currentTracks.video)&&this._edges.update({video:e,audio:null})}}]),t}(s(n(268)).default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n){(0,r.default)(this,e),this._sharedState=n,this._mediaMapCache=t}return(0,a.default)(e,[{key:"update",value:function(e){var t=e.audio,n=e.video;if(void 0===t&&void 0===n)throw new Error("There must be at least one updated track edge");if(!t||this.audio&&this.audio.isEqual(t)||(this.audio=t,this._sharedState.moduleState.audioTrackEdge=t,this._sharedState.eventBus.emit(i.default.Media.TRACK_EDGE_CHANGED,{isVideo:!1})),n&&(!this.video||!this.video.isEqual(n))){this.video=n,this._sharedState.moduleState.videoTrackEdge=n;var r=this._mediaMapCache.getSegmentTime(n);null!==r?this._sharedState.moduleState.videoCurrentTime=r:this._sharedState.errorFunnel.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable")),this._sharedState.eventBus.emit(i.default.Media.TRACK_EDGE_CHANGED,{isVideo:!0})}}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(20)),a=c(n(1)),i=c(n(2)),o=n(269),u=n(71),s=c(n(134)),l=n(18);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,n){(0,a.default)(this,e),this._mediaMap=t,this._sharedState=n,this._cachedSegmentList=new r.default,this._cachedSegmentTime=new r.default}return(0,i.default)(e,[{key:"getSegmentListAfterEdge",value:function(e,t,n){var r=this,a=t.viewToString(),i=this._cachedSegmentList.get(e.viewToString());if(i&&i.edgeString===a&&i.duration===n)return i.cachedSegmentList;var o=this.getSegmentTime(t),u=void 0;return null===o?(this._sharedState.errorFunnel.notifyError(new Error("Unexpected getSegmentTime error: track edge timestamp is not supposed to be unreliable")),u=[]):(isNaN(this._sharedState.conf.MEDIA_MAP_GET_SEGMENT_LIST_TRACK_EDGE_OFFSET)||(o+=this._sharedState.conf.MEDIA_MAP_GET_SEGMENT_LIST_TRACK_EDGE_OFFSET),u=this._mediaMap.getSegmentList(e,o,n)),(this._sharedState.conf.ENABLE_PREBUFFER_FEEDBACK||this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME)&&(u=this._filterGreaterThanTrackEdge(u,t)),this._cachedSegmentList.set(e.viewToString(),{edgeString:a,cachedSegmentList:u,duration:n}),this._sharedState.conf.MEDIA_MAP_SEGMENT_LIST_TTL&&(0,l.createTimeout)(function(){r._cachedSegmentList.delete(e.viewToString())},this._sharedState.conf.MEDIA_MAP_SEGMENT_LIST_TTL),u}},{key:"_filterGreaterThanTrackEdge",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].getId()>t.getId())return e.slice(n);return[]}},{key:"getSegmentTime",value:function(e){if(e.fromPeer&&this._sharedState.moduleState.streamType===u.StreamTypes.HLS&&this._sharedState.conf.ENABLE_FIX_UNRELIABLE_SEGMENT_TIME)return null;var t=this._cachedSegmentTime.get(e.viewToString());if(void 0!==t)return t;var n=this._mediaMap.getSegmentTime(e);if(this._cachedSegmentTime.set(e.viewToString(),n),this._cachedSegmentTime.size>this._sharedState.conf.GETSEGMENTTIME_CACHE_MAX_SIZE){var r=this._cachedSegmentTime.keys().next().value,a=(0,o.unwrap)(r);this._cachedSegmentTime.delete(a)}return n}},{key:"dispose",value:function(){this._mediaMap=new s.default}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(13)),a=s(n(1)),i=s(n(2)),o=s(n(11)),u=s(n(12));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return(0,a.default)(this,t),(0,o.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,u.default)(t,e),(0,i.default)(t,[{key:"getSegmentListToDownload",value:function(){var e=[],t=this._currentTracks.audio;t&&(e=(e=this._getSegmentsToDownloadByTrack(t,"audio")).slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER));var n=[],r=this._currentTracks.video;return r&&(n=(n=this._getSegmentsToDownloadByTrack(r,"video")).slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER)),this._cachedSegmentToDownload=e.concat(n).sort(function(e,t){return e.getId()-t.getId()}).slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER),this._cachedSegmentToDownload}},{key:"updateTrackEdge",value:function(e){var t=this._findTrack(e);"audio"===t?this._edges.update({audio:e,video:null}):"video"===t&&this._edges.update({audio:null,video:e})}},{key:"_findTrack",value:function(e){var t=this._currentTracks.video;if(t&&e.isInTrack(t))return"video";var n=this._currentTracks.audio;return n&&e.isInTrack(n)?"audio":void 0}}]),t}(s(n(268)).default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(20)),a=o(n(1)),i=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,a.default)(this,e),this._map=new r.default,this._sharedState=t}return(0,i.default)(e,[{key:"addSegmentInfo",value:function(e){this._sharedState.controlStats.addSegmentInfoCount++;var t=e.segmentView.viewToString(),n=this._map.get(t);if(this._sharedState.conf.REJECT_MISMATCH_SEGMENT_INFO&&!e.trusted&&n){if(e.size!==n.size||e.hash!==n.hash)throw this._sharedState.controlStats.mismatchedSegmentInfoCount++,new Error("SegmentInfo mismatch: size or hash coming from untrusted source did not match stored value")}else this._map.set(t,e)}},{key:"getSegmentInfo",value:function(e){var t=e.viewToString(),n=this._map.get(t);return n||null}},{key:"removeSegmentInfo",value:function(e){var t=e.viewToString();this._map.delete(t)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(83)),a=l(n(17)),i=l(n(20)),o=l(n(1)),u=l(n(2)),s=n(269);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,n){(0,o.default)(this,e),this._segmentListMap=new i.default,this._sharedState=n;for(var r=t.getTrackList(),a=0;a<r.length;a++)this._segmentListMap.set(r[a],[])}return(0,u.default)(e,[{key:"insert",value:function(e){var t=this._getMatchingTrack(e);if(t){var n=(0,s.unwrap)(this._segmentListMap.get(t));if(0===n.length)n.push(e);else if(n[0].getId()>e.getId())n.unshift(e);else for(var r=n.length;r>0;r--){if(e.getId()>n[r-1].getId()){n.splice(r,0,e);break}if(e.getId()===n[r-1].getId())break}var a=n.length;if(a>this._sharedState.conf.MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH){var i=n.slice(a-this._sharedState.conf.MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH);this._segmentListMap.set(t,i)}}}},{key:"getSegmentListAfter",value:function(e){var t=this._getMatchingTrack(e);if(t){var n=(0,s.unwrap)(this._segmentListMap.get(t)).filter(function(t){return t.getId()>e.getId()});return this._segmentListMap.set(t,n),n.slice(0,this._sharedState.conf.NB_SEGMENT_P2P_PREBUFFER)}return[]}},{key:"_getMatchingTrack",value:function(e){var t=!0,n=!1,i=void 0;try{for(var o,u=(0,a.default)(this._segmentListMap);!(t=(o=u.next()).done);t=!0){var s=(0,r.default)(o.value,1)[0];if(e.isInTrack(s))return s}}catch(e){n=!0,i=e}finally{try{!t&&u.return&&u.return()}finally{if(n)throw i}}this._sharedState.errorFunnel.notifyError(new Error("Pushed segment belongs to no track"))}}]),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(627),i=(r=a)&&r.__esModule?r:{default:r},o=n(191);t.default={getSegment:function(e,t,n,r,a){var u=n.onProgress,s=void 0===u?o.noop:u,l=n.onError,c=void 0===l?o.noop:l,f=n.onSuccess,d=void 0===f?o.noop:f,h=n.onFallback,_={onProgress:s,onError:c,onSuccess:d,onFallback:void 0===h?o.noop:h};return(0,i.default)(e,a,t,_,r).getSegment()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(628)),a=l(n(646)),i=l(n(647)),o=l(n(648)),u=l(n(649)),s=n(196);function l(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n,l,c){var f=(0,u.default)(t,l,c);function d(e){t.errorFunnel.notifyError(e)}f.onFallback=function(e){e&&d(e),new r.default(t,n,f).getSegment()};try{if(n&&(0,s.getRangeFromRequest)(n)&&t.moduleState.rangeRequestStatus.setEnabledByStream(),t.moduleState.rangeRequestStatus.isUnknown&&t.bufferStats.bufferedAmount>=t.conf.RR_DETECTION_MIN_BUFFER_LEVEL)return new o.default(t,n,f);var h=function(){return e.getP2PData(c)},_=h();return _.isComplete()?new a.default(t,n,f,h):new i.default(t,n,f,_)}catch(e){return d(e),new r.default(t,n,f)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(13)),a=l(n(1)),i=l(n(2)),o=l(n(11)),u=l(n(101)),s=l(n(12));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n,i){(0,a.default)(this,t);var u=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i));return e.controlStats.getSegmentFallback++,u}return(0,s.default)(t,e),(0,i.default)(t,[{key:"_incSuccessStats",value:function(){}},{key:"_onHttpSuccess",value:function(e){e.recyclable=!0,(0,u.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"_onHttpSuccess",this).call(this,e)}}]),t}(l(n(190)).default);t.default=c},function(e,t,n){e.exports={default:n(630),__esModule:!0}},function(e,t,n){n(631);var r=n(8).Object;e.exports=function(e,t){return r.getOwnPropertyDescriptor(e,t)}},function(e,t,n){var r=n(69),a=n(174).f;n(78)("getOwnPropertyDescriptor",function(){return function(e,t){return a(r(e),t)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(55)),a=s(n(1)),i=s(n(2)),o=s(n(192)),u=n(196);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this._firstByteCdnTimestamp=null,this._sharedState=t,this._request=n,this._stats=r,this._resultCallback=i.result,this._progressCallback=i.progress,this._range=o}return(0,i.default)(e,[{key:"send",value:function(){var e=this;this._startDownloadCdn=Date.now(),this._p2pAmountOnStart=this._sharedState.transferStats.p2pMediaDownloaded;var t={headers:(0,u.getHttpRequestHeaders)(this._request,this._range),responseType:o.default.ResponseTypes.ARRAY_BUFFER,withCredentials:!!this._request.withCredentials,events:{onprogress:this._onCDNProgress.bind(this)}},n=new o.default(o.default.Methods.GET,this._request.url,t);return n.send().then(function(t){e._sharedState.transferStats.cdnRequestCount++,!e._range&&t.length<e._sharedState.conf.CDN_TOO_SMALL_SEGMENT_LENGTH_THRESHOLD&&e._sharedState.transferStats.cdnTooSmallCount++,e._calculateAbrStats(t),e._resultCallback(null,t)}).catch(function(t){e._sharedState.transferStats.cdnRequestCount++,e._sharedState.transferStats.cdnErrorCount++,e._resultCallback(t,null)}),n}},{key:"_onCDNProgress",value:function(e){var t=Date.now();null===this._firstByteCdnTimestamp&&(this._firstByteCdnTimestamp=t,this._sharedState.conf.ENABLE_LATENCY_FEEDBACK&&(this._stats.latency=this._firstByteCdnTimestamp-this._startDownloadCdn)),this._stats.cdnDuration=t-this._startDownloadCdn,this._stats.cdnDownloaded=e.loaded;var n={};if((0,r.default)(n,this._stats),e.lengthComputable){var a=e.loaded/e.total;n.p2pDownloaded=Math.round(a*this._stats.p2pDownloaded),n.p2pDuration=Math.round(a*this._stats.p2pDuration)}else n.p2pDownloaded=0,n.p2pDuration=0;n.lengthComputable=e.lengthComputable,n.total=e.lengthComputable?e.total+this._stats.p2pDownloaded:0,this._progressCallback(n,this._request)}},{key:"_calculateAbrStats",value:function(e){var t=Date.now();this._stats.cdnDownloaded=e.byteLength||0,this._stats.cdnDuration=t-this._startDownloadCdn;var n=this._sharedState.transferStats.p2pMediaDownloaded-this._p2pAmountOnStart;this._sharedState.abrStats.concurrentP2pDownloaded+=n,this._sharedState.abrStats.cdnEstimationCount++,0!==n&&this._sharedState.abrStats.concurrentP2pDownloadCount++;var r=this._stats.cdnDownloaded+this._stats.p2pDownloaded,a=this._stats.cdnDownloaded/r;if(a>=this._sharedState.conf.ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD&&this._stats.cdnDownloaded>=this._sharedState.conf.ABR_CDN_DL_THRESHOLD||r<this._sharedState.conf.ABR_CDN_DL_THRESHOLD&&a>=this._sharedState.conf.ABR_CDN_SMALL_SEGMENT_SPEED_UPDATE_RATIO_THRESHOLD){if(this._sharedState.conf.CDN_SPEED_ESTIMATE_CONSIDER_P2P){var i=Math.min(this._stats.cdnDownloaded+n,this._stats.cdnDownloaded*this._sharedState.conf.CDN_CONCURRENT_SCALING_CAP);this._sharedState.abrStats.cdnSpeed=8*i/this._stats.cdnDuration}else this._sharedState.abrStats.cdnSpeed=8*this._stats.cdnDownloaded/this._stats.cdnDuration;this._sharedState.abrStats.cdnTimestamp=Date.now()}}}]),e}();t.default=l},function(e,t,n){n(128),n(70),n(81),n(634),n(638),n(639),e.exports=n(8).Promise},function(e,t,n){"use strict";var r,a,i,o,u=n(95),s=n(21),l=n(47),c=n(129),f=n(10),d=n(24),h=n(90),_=n(176),p=n(97),v=n(273),E=n(274).set,g=n(636)(),m=n(193),S=n(275),y=n(637),T=n(276),A=s.TypeError,C=s.process,D=C&&C.versions,P=D&&D.v8||"",R=s.Promise,w="process"==c(C),O=function(){},I=a=m.f,k=!!function(){try{var e=R.resolve(1),t=(e.constructor={})[n(23)("species")]=function(e){e(O,O)};return(w||"function"==typeof PromiseRejectionEvent)&&e.then(O)instanceof t&&0!==P.indexOf("6.6")&&-1===y.indexOf("Chrome/66")}catch(e){}}(),N=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;g(function(){for(var r=e._v,a=1==e._s,i=0,o=function(t){var n,i,o,u=a?t.ok:t.fail,s=t.resolve,l=t.reject,c=t.domain;try{u?(a||(2==e._h&&U(e),e._h=1),!0===u?n=r:(c&&c.enter(),n=u(r),c&&(c.exit(),o=!0)),n===t.promise?l(A("Promise-chain cycle")):(i=N(n))?i.call(n,s,l):s(n)):l(r)}catch(e){c&&!o&&c.exit(),l(e)}};n.length>i;)o(n[i++]);e._c=[],e._n=!1,t&&!e._h&&b(e)})}},b=function(e){E.call(s,function(){var t,n,r,a=e._v,i=L(e);if(i&&(t=S(function(){w?C.emit("unhandledRejection",a,e):(n=s.onunhandledrejection)?n({promise:e,reason:a}):(r=s.console)&&r.error&&r.error("Unhandled promise rejection",a)}),e._h=w||L(e)?2:1),e._a=void 0,i&&t.e)throw t.v})},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},U=function(e){E.call(s,function(){var t;w?C.emit("rejectionHandled",e):(t=s.onrejectionhandled)&&t({promise:e,reason:e._v})})},x=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw A("Promise can't be resolved itself");(t=N(e))?g(function(){var r={_w:n,_d:!1};try{t.call(e,l(F,r,1),l(x,r,1))}catch(e){x.call(r,e)}}):(n._v=e,n._s=1,M(n,!1))}catch(e){x.call({_w:n,_d:!1},e)}}};k||(R=function(e){_(this,R,"Promise","_h"),h(e),r.call(this);try{e(l(F,this,1),l(x,this,1))}catch(e){x.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(175)(R.prototype,{then:function(e,t){var n=I(v(this,R));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=w?C.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r;this.promise=e,this.resolve=l(F,e,1),this.reject=l(x,e,1)},m.f=I=function(e){return e===R||e===o?new i(e):a(e)}),f(f.G+f.W+f.F*!k,{Promise:R}),n(96)(R,"Promise"),n(245)("Promise"),o=n(8).Promise,f(f.S+f.F*!k,"Promise",{reject:function(e){var t=I(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(u||!k),"Promise",{resolve:function(e){return T(u&&this===o?R:this,e)}}),f(f.S+f.F*!(k&&n(257)(function(e){R.all(e).catch(O)})),"Promise",{all:function(e){var t=this,n=I(t),r=n.resolve,a=n.reject,i=S(function(){var n=[],i=0,o=1;p(e,!1,function(e){var u=i++,s=!1;n.push(void 0),o++,t.resolve(e).then(function(e){s||(s=!0,n[u]=e,--o||r(n))},a)}),--o||r(n)});return i.e&&a(i.v),n.promise},race:function(e){var t=this,n=I(t),r=n.reject,a=S(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return a.e&&r(a.v),n.promise}})},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(21),a=n(274).set,i=r.MutationObserver||r.WebKitMutationObserver,o=r.process,u=r.Promise,s="process"==n(94)(o);e.exports=function(){var e,t,n,l=function(){var r,a;for(s&&(r=o.domain)&&r.exit();e;){a=e.fn,e=e.next;try{a()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(s)n=function(){o.nextTick(l)};else if(!i||r.navigator&&r.navigator.standalone)if(u&&u.resolve){var c=u.resolve(void 0);n=function(){c.then(l)}}else n=function(){a.call(r,l)};else{var f=!0,d=document.createTextNode("");new i(l).observe(d,{characterData:!0}),n=function(){d.data=f=!f}}return function(r){var a={fn:r,next:void 0};t&&(t.next=a),e||(e=a,n()),t=a}}},function(e,t,n){var r=n(21).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(10),a=n(8),i=n(21),o=n(273),u=n(276);r(r.P+r.R,"Promise",{finally:function(e){var t=o(this,a.Promise||i.Promise),n="function"==typeof e;return this.then(n?function(n){return u(t,e()).then(function(){return n})}:e,n?function(n){return u(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var r=n(10),a=n(193),i=n(275);r(r.S,"Promise",{try:function(e){var t=a.f(this),n=i(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){e.exports={default:n(641),__esModule:!0}},function(e,t,n){n(642),e.exports=n(8).Object.isFrozen},function(e,t,n){var r=n(24);n(78)("isFrozen",function(e){return function(t){return!r(t)||!!e&&e(t)}})},function(e,t,n){e.exports={default:n(644),__esModule:!0}},function(e,t,n){n(645);var r=n(8).Object;e.exports=function(e){return r.getOwnPropertyNames(e)}},function(e,t,n){n(78)("getOwnPropertyNames",function(){return n(240).f})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=h(n(13)),a=h(n(1)),i=h(n(2)),o=h(n(11)),u=h(n(101)),s=h(n(12)),l=h(n(270)),c=h(n(278)),f=h(n(3)),d=n(18);function h(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e,n,i,u){(0,a.default)(this,t);var s=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i));return s._partialSegmentProvider=u,s._partialSegment=s._partialSegmentProvider(),s._stats={cdnDownloaded:0,cdnDuration:0,p2pDownloaded:s._partialSegment.p2pAmount,p2pDuration:0===s._partialSegment.p2pSpeed?0:Math.round(s._partialSegment.p2pAmount/s._partialSegment.p2pSpeed*1e3)},e.conf.ENABLE_LATENCY_FEEDBACK&&(s._stats.latency=Math.min(e.abrStats.latencyHistoricalValue,Math.ceil(s._stats.p2pDuration*e.conf.LATENCY_CAPPING_RATIO))),s._segmentFiller=new c.default(e,s._partialSegment),s._segmentFiller.once(f.default.SegmentFiller.SUCCESS,s._onRequestSuccess.bind(s)),s._segmentFiller.once(f.default.SegmentFiller.FALLBACK,s._onRequestFallback.bind(s)),i.onProgress(s._stats,n),s}return(0,s.default)(t,e),(0,i.default)(t,[{key:"_getSegmentImplementation",value:function(){var e=this;this._waitSegmentUnlocked(function(t){t?e._segmentFiller.fillSegment(null):e._onRequestFallback()})}},{key:"_waitSegmentUnlocked",value:function(e){var t=this;if(this._partialSegment.isLocked())var n=0,r=(0,d.createInterval)(function(){if(t._partialSegment=t._partialSegmentProvider(),!t._partialSegment.isLocked())return r.clear(),void e(!0);(n+=t._sharedState.conf.LOCKED_RETRY_INTERVAL)>t._sharedState.conf.LOCKED_RETRY_TIMEOUT&&(r.clear(),e(!1))},this._sharedState.conf.LOCKED_RETRY_INTERVAL);else e(!0)}},{key:"_onRequestSuccess",value:function(e){(0,u.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"_onRequestSuccess",this).call(this,e)}},{key:"_abort",value:function(){this._segmentFiller.removeAllListeners(),(0,u.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"_abort",this).call(this)}}]),t}(l.default);t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=_(n(13)),a=_(n(1)),i=_(n(2)),o=_(n(11)),u=_(n(101)),s=_(n(12)),l=_(n(190)),c=_(n(278)),f=_(n(3)),d=n(196),h=_(n(102));_(n(195));function _(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e,n,i,u){(0,a.default)(this,t);var s=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n,i));return s._partialSegment=u,s._stats={cdnDownloaded:0,cdnDuration:0,p2pDownloaded:s._partialSegment.p2pAmount,p2pDuration:0===s._partialSegment.p2pSpeed?0:Math.round(s._partialSegment.p2pAmount/s._partialSegment.p2pSpeed*1e3)},s._segmentFiller=new c.default(e,u),s._segmentFiller.once(f.default.SegmentFiller.SUCCESS,s._onRequestSuccess.bind(s)),s._segmentFiller.once(f.default.SegmentFiller.FALLBACK,s._onRequestFallback.bind(s)),e.eventBus.emit(f.default.SRModuleInterface.UNCOMPLETE_SEGMENT_REQUESTED),s}return(0,s.default)(t,e),(0,i.default)(t,[{key:"_getRange",value:function(){var e=(0,d.getRangeFromRequest)(this._request);return this._rangeToDownload=this._partialSegment.getUpdatedRange(e),this._rangeToDownload}},{key:"_checkResponseSize",value:function(e){if(!this._rangeToDownload)return!0;var t=void 0;if(void 0===this._rangeToDownload.end){if(0===this._rangeToDownload.start)return!0;if(!this._partialSegment.byteLength)return!0;t=this._partialSegment.byteLength-this._rangeToDownload.start}else t=Number(this._rangeToDownload.end)-this._rangeToDownload.start+1;return t===e.byteLength?(this._sharedState.moduleState.rangeRequestStatus.setEnabled(),!0):(this._sharedState.moduleState.rangeRequestStatus.setDisabledBecauseWrongRange(),!1)}},{key:"_onHttpSuccess",value:function(e){this._checkResponseSize(e)?this._segmentFiller.fillSegment(e):!this._rangeToDownload&&this._sharedState.conf.CDN_TOO_SMALL_SEGMENT_DISCARD&&e.byteLength<this._sharedState.conf.CDN_TOO_SMALL_SEGMENT_LENGTH_THRESHOLD?this._onRequestFallback(new Error("CDN response for full segment is too small. Fallback to retry CDN download.")):this._sharedState.conf.ENABLE_RR_PREVENT_FULL_SEGMENT_DISCARDING&&e.byteLength===this._partialSegment.byteLength?(this._stats.p2pDownloaded=0,this._stats.p2pDuration=0,this._segmentFiller.fillSegment(e)):this._onRequestFallback(new Error("Mismatch in expected and received RR response byteLength. Fallback to full CDN download."))}},{key:"_onHttpError",value:function(e){(416===e.status||this._sharedState.conf.DISABLE_RR_ON_UNKNOWN_ERROR&&e.readyState===h.default.ReadyStates.DONE&&0===e.status&&e.message===h.default.Errors.REQUEST_ERROR)&&this._sharedState.moduleState.rangeRequestStatus.setDisabledBecauseWrongRange(),(0,u.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"_onHttpError",this).call(this,e)}},{key:"_abort",value:function(){this._segmentFiller.removeAllListeners(),(0,u.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"_abort",this).call(this)}}]),t}(l.default);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(13)),a=f(n(1)),i=f(n(2)),o=f(n(11)),u=f(n(101)),s=f(n(12)),l=f(n(190)),c=(f(n(195)),f(n(277)));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(){return(0,a.default)(this,t),(0,o.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,i.default)(t,[{key:"_getRange",value:function(){return{start:0}}},{key:"_onHttpError",value:function(e){e.message===c.default.Errors.REQUEST_ERROR&&this._sharedState.moduleState.rangeRequestStatus.setDisabledBecauseNoCors(),this._onRequestFallback()}},{key:"_onHttpSuccess",value:function(e){this._sharedState.moduleState.rangeRequestStatus.setProbably(),(0,u.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"_onHttpSuccess",this).call(this,e)}}]),t}(l.default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(3)),a=i(n(650));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){return{onSuccess:function(n,i,o){if((0,a.default)(i,e.abrStats,e.conf),e.conf.ENABLE_LATENCY_FEEDBACK){var u=i.latency||e.abrStats.latencyHistoricalValue;i.latency=Math.min(u,Math.ceil((i.cdnDuration+i.p2pDuration)*e.conf.LATENCY_CAPPING_RATIO))}e.transferStats.p2pConsumed+=i.p2pDownloaded,e.transferStats.cdnConsumed+=i.cdnDownloaded;var s=function(){t.onSuccess(n,i,o)};if(e.conf.ENABLE_FUNNEL_GETSEGMENT_CALLBACKS)try{s()}catch(t){e.errorFunnel.notifyError(t)}else s();e.eventBus.emit(r.default.SRModuleInterface.ABR_FEEDBACK,i),e.eventBus.emit(r.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE)},onError:function(n,r){if(e.conf.ENABLE_FUNNEL_GETSEGMENT_CALLBACKS)try{t.onError(n,r)}catch(t){e.errorFunnel.notifyError(t)}else t.onError(n,r)},onProgress:function(n,r){if(e.conf.ENABLE_FUNNEL_GETSEGMENT_CALLBACKS)try{t.onProgress(n,r)}catch(t){e.errorFunnel.notifyError(t)}else t.onProgress(n,r)},onFallback:function(){throw new Error("Cannot call abstract method")}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(n.USE_COMBINED_ABR_FEEDBACK){var r=e.cdnDownloaded+e.p2pDownloaded,a=e.cdnDownloaded/r,i=void 0;if(a<n.ABR_SEGMENT_CDN_RATIO_THRESHOLD||e.cdnDownloaded<n.ABR_CDN_DL_THRESHOLD){var o=void 0;if(null!==t.cdnTimestamp){var u=Date.now()-t.cdnTimestamp,s=Math.max(0,1-u/n.ABR_CDN_DL_DECAY_TIME);o=(1-s)*t.p2pSpeed+s*t.cdnSpeed}else o=t.p2pSpeed;i=8*r/o}else i=8*e.cdnDownloaded/t.cdnSpeed/a;e.p2pDuration=(1-a)*i,e.cdnDuration=a*i}else t.p2pSpeed>0?e.p2pDuration=8*e.p2pDownloaded/t.p2pSpeed:e.p2pDuration=0,null!==t.cdnSpeed?e.cdnDuration=8*e.cdnDownloaded/t.cdnSpeed:e.cdnDuration=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=N(n(1)),a=N(n(2)),i=N(n(130)),o=N(n(72)),u=N(n(652)),s=N(n(653)),l=N(n(654)),c=N(n(655)),f=N(n(656)),d=N(n(657)),h=N(n(658)),_=N(n(659)),p=N(n(660)),v=N(n(661)),E=N(n(662)),g=N(n(664)),m=N(n(279)),S=N(n(665)),y=N(n(666)),T=N(n(194)),A=N(n(669)),C=N(n(3)),D=N(n(672)),P=N(n(674)),R=N(n(676)),w=N(n(678)),O=N(n(183)),I=n(681),k=N(n(682));function N(e){return e&&e.__esModule?e:{default:e}}var M=function(){function e(t,n){(0,r.default)(this,e),this.lastStatPayloadTimestamp=Date.now(),this.superSeederMode=O.default.DISABLED,this.p2pDownloadBlocker=new D.default,this.p2pUploadBlocker=new D.default;var a=T.default.deepCopy(S.default);this.conf=a,this.peerAgentConfig=t;var C=t.contentId,N=t.streamType,M=t.interfaces,b=t.propertyParameters,L=t.injectedConf,U=t.networkType,x=M.playerInterface,F=M.mediaMap;(0,I.overloadDefaultConfig)(a,t),this.errorFunnel=M.errorFunnel,this.eventBus=new o.default,this.injectConfigFromDistributor(b,L),this._updateBackendUrls(),this.analyticsEventBus=new o.default,this.segmentHasher=k.default.getSegmentHasher(),this.moduleState=new y.default(this,x,F,N),this.moduleState.content=C,this.uaHelper=new P.default(M.environment),this.qosAnalytics=M.qosAnalytics,this.externalEventBus=M.externalEventBus,this.httpRequestFactory=M.httpRequestFactory,this.trackerFactory=M.trackerFactory?M.trackerFactory:new R.default(this),this.uploadQueueFactory=new w.default(this),this.peerToken=i.default.v4(),this.status=new u.default,this.dnaTransferStatus=new s.default(this.eventBus,b,U),this.statsProvider=new m.default,this.peerStats=new _.default(this.statsProvider),this.transferStats=new l.default,this.efficiencyStats=new c.default,this.controlStats=new f.default,this.costStats=new d.default,this.mediaStats=new p.default(n,F),this.abrStats=new v.default(this.eventBus),this.bufferStats=new h.default(this.eventBus),this.resourceStats=new E.default(this),this.backendStats=new g.default,this._backendManager=new A.default(this.conf,this.eventBus,this.externalEventBus),this._mediaElementPlaceholder=n}return(0,a.default)(e,[{key:"injectConfigFromDistributor",value:function(e,t){if((0,I.overloadConfigFromDistributor)(this.conf,t.config,this.errorFunnel,t.isClustered),(0,I.overloadPropertiesFromDistributor)(this.conf,e),this.conf.STRIP_HOST_FROM_SRFLX&&(this.conf.P2P_PROTOCOL_VERSION+="-stripsrflx"),this.conf.CLUSTER_BY_PA_VERSION&&(this.conf.P2P_PROTOCOL_VERSION+="-pa5.7.0"),this.conf.CLUSTER_BY_INTEGRATION_TAG){var n=this.peerAgentConfig.versions,r=n.wrapperVersion,a=n.streamrooterVersion;this.conf.P2P_PROTOCOL_VERSION+="-w"+r+"-s"+a}this.eventBus.emit(C.default.Config.CONFIG_UPDATED)}},{key:"setBackendUrls",value:function(e){this.peerAgentConfig.backendUrls=e,this._updateBackendUrls(),this.eventBus.emit(C.default.Config.BACKEND_URLS_UPDATED)}},{key:"_updateBackendUrls",value:function(){var e=this.peerAgentConfig.backendUrls,t=e.trackerUrl,n=e.signalingUrl;this.conf.TRACKER_URL=t,this.conf.SIGNALING_URL=n}},{key:"dispose",value:function(){this.moduleState.dispose(),this.segmentHasher.dispose(),this._backendManager.dispose(),this.mediaStats.dispose(),this.resourceStats.dispose()}},{key:"isP2PDownloadBlocked",get:function(){return this.p2pDownloadBlocker.blocked}},{key:"isP2PUploadBlocked",get:function(){return this.p2pUploadBlocker.blocked}}]),e}();t.default=M},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(72)),a=i(n(3));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(){var e=!1,t=void 0,n=0,i=0,o=0,u=0,s=0,l=0,c=0,f=0,d="",h=!1,_="",p=void 0,v=void 0,E=new r.default;this.getMyPeerId=function(){return t},this.setMyPeerId=function(e){t!==e&&(t=e)},this.getDlSpeed=function(){return n},this.setDlSpeed=function(e){n=e},this.getAvgDlSpeed=function(){return i},this.getMaxDlSpeed=function(){return o},this.getUpSpeed=function(){return u},this.setUpSpeed=function(e){u=e},this.getAvgUpSpeed=function(){return s},this.getMaxUpSpeed=function(){return l},this.getCdnCancelled=function(){return f},this.increaseCdnCancelledBy=function(e){f+=e},this.getConnected=function(){return e},this.setTrackerVersion=function(e){d=e},this.getTrackerVersion=function(){return d},this.setTrackerId=function(e){_=e},this.getTrackerId=function(){return _},this.setConnected=function(t){t!==e&&(e=t,!0===t?E.emit(a.default.Tracker.READY):E.emit(a.default.Tracker.DISCONNECTED))},this.getEE=function(){return E},this.setConnectedToSignalingServer=function(){h=!0,E.emit(a.default.Signaling.READY)},this.setDisconnectedToSignalingServer=function(){h=!1,E.emit(a.default.Signaling.DISCONNECTED)},this.getConnectedToSignalingServer=function(){return h},this.computeMaxAndAvgSpeed=function(){var e=void 0,t=void 0;n&&(n>o&&(o=n),e=i?(i*p+n)/(p+1):n,p=p?p+1:1,i=e),u&&(u>l&&(l=u),t=s?(s*v+u)/(v+1):u,v=v?v+1:1,s=t)},this.setMeanInstantSpeed=function(e){c=e},this.getMeanInstantSpeed=function(){return c}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),a=u(n(2)),i=(u(n(72)),u(n(161))),o=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}function s(e){return!0===e||!1===e}var l=function(){function e(t,n,a){(0,r.default)(this,e),this._networkType=i.default.UNKNOWN,this._downloadAllowed=!0,this._uploadAllowed=!0,this._properties=n,this._networkType=a,this._backendDownloadPolicy={wifiEthernet:n.wifiEthernetDownload,cellularOther:n.cellularOtherDownload,unknown:!1,none:!1},this._backendUploadPolicy={wifiEthernet:n.wifiEthernetUpload,cellularOther:n.cellularOtherUpload,unknown:!1,none:!1},this._clientDownloadPolicy={wifiEthernet:null,cellularOther:null,unknown:!1,none:!1},this._clientUploadPolicy={wifiEthernet:null,cellularOther:null,unknown:!1,none:!1},this._updateEffectiveDownload(),this._updateEffectiveUpload(),this._eventBus=t}return(0,a.default)(e,[{key:"_updateEffectiveDownload",value:function(){var e=this._downloadAllowed&&this._getCurrentNetworkDownloadPolicy();e!==this._effectiveDownloadAllowed&&(this._effectiveDownloadAllowed=e,void 0!==this._eventBus&&this._eventBus.emit(o.default.DnaTransferStatus.P2P_DOWNLOAD_TOGGLED,this.effectiveDownloadAllowed))}},{key:"_updateEffectiveUpload",value:function(){var e=this._uploadAllowed&&this._getCurrentNetworkUploadPolicy();e!==this._effectiveUploadAllowed&&(this._effectiveUploadAllowed=e,void 0!==this._eventBus&&this._eventBus.emit(o.default.DnaTransferStatus.P2P_UPLOAD_TOGGLED,this.effectiveUploadAllowed))}},{key:"_getCurrentNetworkDownloadPolicy",value:function(){return this._getNetworkDownloadPolicy(this._networkType)}},{key:"_getCurrentNetworkUploadPolicy",value:function(){return this._getNetworkUploadPolicy(this._networkType)}},{key:"_getNetworkDownloadPolicy",value:function(e){var t=this._clientDownloadPolicy[e];return s(t)?!!t:this._backendDownloadPolicy[e]}},{key:"_getNetworkUploadPolicy",value:function(e){var t=this._clientUploadPolicy[e];return s(t)?!!t:this._backendUploadPolicy[e]}},{key:"networkType",get:function(){return this._networkType},set:function(e){e!==this._networkType&&(this._networkType=e,this._updateEffectiveDownload(),this._updateEffectiveUpload())}},{key:"downloadAllowed",get:function(){return this._downloadAllowed},set:function(e){e!==this._downloadAllowed&&(this._downloadAllowed=e,this._updateEffectiveDownload())}},{key:"uploadAllowed",get:function(){return this._uploadAllowed},set:function(e){e!==this._uploadAllowed&&(this._uploadAllowed=e,this._updateEffectiveUpload())}},{key:"downloadOnWifiEthernetAllowed",get:function(){return this._getNetworkDownloadPolicy(i.default.WIFI_AND_ETHERNET)},set:function(e){this._clientDownloadPolicy[i.default.WIFI_AND_ETHERNET]=e,this._updateEffectiveDownload()}},{key:"uploadOnWifiEthernetAllowed",get:function(){return this._getNetworkUploadPolicy(i.default.WIFI_AND_ETHERNET)},set:function(e){this._clientUploadPolicy[i.default.WIFI_AND_ETHERNET]=e,this._updateEffectiveUpload()}},{key:"downloadOnCellularAllowed",get:function(){return this._getNetworkDownloadPolicy(i.default.CELLULAR_AND_OTHERS)},set:function(e){this._clientDownloadPolicy[i.default.CELLULAR_AND_OTHERS]=e,this._updateEffectiveDownload()}},{key:"uploadOnCellularAllowed",get:function(){return this._getNetworkUploadPolicy(i.default.CELLULAR_AND_OTHERS)},set:function(e){this._clientUploadPolicy[i.default.CELLULAR_AND_OTHERS]=e,this._updateEffectiveUpload()}},{key:"effectiveDownloadAllowed",get:function(){return this._effectiveDownloadAllowed}},{key:"effectiveUploadAllowed",get:function(){return this._effectiveUploadAllowed}},{key:"effectiveStatus",get:function(){return{effectiveDownloadAllowed:this.effectiveDownloadAllowed,effectiveUploadAllowed:this.effectiveUploadAllowed}}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this._p2pUseful=0,this.cdnDownloaded=0,this.p2pConsumed=0,this.cdnConsumed=0,this.p2pMediaDownloaded=0,this.p2pHeadersDownloaded=0,this.p2pMessagesDownloaded=0,this.p2pMessagesCount=0,this.p2pUploaded=0,this.cdnRequestCount=0,this.cdnErrorCount=0,this.cdnTooSmallCount=0,this.multipleDlPP=0,this.multipleDlPC=0,this.multipleDlCP=0,this.multipleDlCC=0,this.multipleDlHP=0,this.multipleDlHD=0,this.multipleDlM=0}return(0,a.default)(e,[{key:"p2pUseful",get:function(){return this._p2pUseful},set:function(e){if(e<this._p2pUseful)throw new TypeError("p2pUseful increment is not a positive number");this._p2pUseful=e}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),i=(r=a)&&r.__esModule?r:{default:r};t.default=function e(){(0,i.default)(this,e),this.receivedChunkRequestCount=0,this.dequeuedReceivedChunkRequestCount=0,this.missedDequeuedChunkRequestCount=0,this.safeChunkRequestCount=0,this.unsafeChunkRequestCount=0,this.safeChunkRequestTimeoutCount=0,this.unsafeChunkRequestTimeoutCount=0,this.gracedChunksCount=0,this.expiredGraceChunksCount=0,this.chunkSchedulingCount=0,this.chunkSchedulingSkipped=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this._sampledIceGatheringDuration=0,this.newPeerConnectionCount=0,this.nbRightHashP2P=0,this.nbWrongHashP2P=0,this.nbRightHashDLM=0,this.nbWrongHashDLM=0,this.checkHeartbeatFailed=0,this.getSegmentSuccess=0,this.getSegmentFallback=0,this.iceCandidates=0,this.iceCandidatesIpv6=0,this.mismatchedSegmentPCCount=0,this.totalSegmentPCCount=0,this.addSegmentInfoCount=0,this.mismatchedSegmentInfoCount=0}return(0,a.default)(e,[{key:"setSampledIceGatheringDuration",value:function(e){0===this._sampledIceGatheringDuration&&(this._sampledIceGatheringDuration=e)}},{key:"sampledIceGatheringDuration",get:function(){var e=this._sampledIceGatheringDuration;return this._sampledIceGatheringDuration=0,e}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),i=(r=a)&&r.__esModule?r:{default:r};t.default=function e(){(0,i.default)(this,e),this.signalingRequestsCount=0,this.signalingRequestsVolume=0,this.trackerRequestsCount=0,this.trackerRequestsVolume=0,this.trackerResponsesVolume=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(3)),o=s(n(182)),u=s(n(131));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,r.default)(this,e),this._alwaysDynamicBuffer=!0,this._lastLowBuffer=0,this.bufferRefill=0,this.bufferedAmount=0,this.lowerBufferTargetNetChangePerRebound=0,this.sampledHighLowBufferTargetGap=0,this._timeSpentOnEdgeStaircase=new u.default,this._timeSpentWithoutPeerStaircase=new u.default,this._timeSpentDynamicStaircase=new u.default,this._timeSpentTopSeederStaircase=new u.default,this._timeLowerTargetAboveLiveEdgeStaircase=new u.default,this._globalEventBus=t,this._globalEventBus.on(i.default.Scheduler.REACHED_LIVE_EDGE_STATE_CHANGED,this._onLiveEdgeChanged.bind(this)),this._globalEventBus.on(i.default.BufferManager.LOW_BUFFER,this._onLowBuffer.bind(this)),this._globalEventBus.on(i.default.BufferManager.HIGH_BUFFER,this._onHighBuffer.bind(this)),this._globalEventBus.on(i.default.BufferManager.STATE_CHANGED,this._onBufferStateChange.bind(this))}return(0,a.default)(e,[{key:"_onLiveEdgeChanged",value:function(e){var t=e?1:0;this._timeSpentOnEdgeStaircase.updateMetric(t)}},{key:"_onBufferStateChange",value:function(e,t){switch(e){case o.default.NO_PEER:this._timeSpentWithoutPeerStaircase.updateMetric(0);break;case o.default.DYNAMIC:this._timeSpentDynamicStaircase.updateMetric(0);break;case o.default.TOP_SEEDER:this._timeSpentTopSeederStaircase.updateMetric(0)}switch(t){case o.default.NO_PEER:this._timeSpentWithoutPeerStaircase.updateMetric(1),e!==o.default.IDLE&&(this._alwaysDynamicBuffer=!1);break;case o.default.DYNAMIC:this._timeSpentDynamicStaircase.updateMetric(1);break;case o.default.TOP_SEEDER:this._timeSpentTopSeederStaircase.updateMetric(1),this._alwaysDynamicBuffer=!1;break;case o.default.RANDOM:case o.default.STATIC:this._alwaysDynamicBuffer=!1}this.bufferState=t}},{key:"_onLowBuffer",value:function(e){this._lastLowBuffer=e}},{key:"_onHighBuffer",value:function(e){this.bufferRefill+=e-this._lastLowBuffer}},{key:"_resetDynamicFlag",value:function(){this._alwaysDynamicBuffer=this.bufferState===o.default.DYNAMIC}},{key:"setLowerTargetAboveLiveEdge",value:function(e){this._timeLowerTargetAboveLiveEdgeStaircase.updateMetric(e?1:0)}},{key:"timeSpentOnEdgeRatio",get:function(){return this._timeSpentOnEdgeStaircase.getAverage()}},{key:"timeSpentTopSeederRatio",get:function(){return this._timeSpentTopSeederStaircase.getAverage()}},{key:"timeLowerTargetAboveLiveEdge",get:function(){return this._timeLowerTargetAboveLiveEdgeStaircase.getAverage()}},{key:"timeSpentDynamicIntegral",get:function(){return this._timeSpentDynamicStaircase.getIntegral()}},{key:"alwaysDynamicBuffer",get:function(){var e=void 0;return e=this.bufferState!==o.default.NO_PEER&&this._alwaysDynamicBuffer,this._resetDynamicFlag(),e}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(100)),a=c(n(1)),i=c(n(2)),o=c(n(131)),u=c(n(266)),s=(c(n(279)),c(n(280))),l=c(n(186));function c(e){return e&&e.__esModule?e:{default:e}}var f=10,d=10,h=20,_=function(){function e(t){(0,a.default)(this,e),this.match=0,this.excessMatch=0,this.offer=0,this.openedMatch=0,this.openedOffer=0,this.unansweredOffer=0,this.active=0,this.transfer=0,this.denied=0,this.limit=0,this.droppedSameTrack=0,this.droppedOtherTrack=0,this.offerTimeout=0,this.answerTimeout=0,this.timeoutNewConnection=0,this.timeoutCheckingConnection=0,this.timeoutFailedConnection=0,this.timeoutNewIce=0,this.timeoutGatheringIce=0,this.timeoutCompleteIce=0,this.disconnected=0,this.lateMessage=0,this.exclusionSize=0,this.timeoutLocalSdp=0,this.timeoutRemoteSdp=0,this.timeoutLocalSdpWithStun=0,this.timeoutRemoteSdpWithStun=0,this.residualDisconnectedPeerDuration=0,this._statsProvider=t,this.peerPoolUploadCapacity=new o.default,this.locked=new o.default,this.loosers=new o.default,this.sampledPeerStatsQueue=new l.default(h),this.sampledDataChannelBufferEmptyingStatsQueue=new l.default(f),this.endedConnectionP2pRttSamples=new s.default(d)}return(0,i.default)(e,[{key:"incrementTimeout",value:function(e,t,n,r){switch(n?this.offerTimeout++:this.answerTimeout++,r.hasLocalDescription&&this.timeoutLocalSdp++,r.hasRemoteDescription&&this.timeoutRemoteSdp++,r.hasLocalDescriptionWithStun&&this.timeoutLocalSdpWithStun++,r.hasRemoteDescriptionWithStun&&this.timeoutRemoteSdpWithStun++,e){case"new":this.timeoutNewConnection++;break;case"checking":this.timeoutCheckingConnection++;break;case"failed":this.timeoutFailedConnection++}switch(t){case"new":this.timeoutNewIce++;break;case"gathering":this.timeoutGatheringIce++;break;case"complete":this.timeoutCompleteIce++}}},{key:"sampledPeerStats",get:function(){return this.sampledPeerStatsQueue.fetchSample()}},{key:"sampledDataChannelBufferEmptyingStats",get:function(){return this.sampledDataChannelBufferEmptyingStatsQueue.fetchSample()}},{key:"sampledPUC",get:function(){return this._statsProvider.getStat(u.default.PeerStats.SAMPLED_PUC)}},{key:"sampledP2pMeanRtt",get:function(){var e=this._statsProvider.getStat(u.default.PeerStats.SAMPLED_LIVE_CONNECTION_RTT)||[],t=[].concat((0,r.default)(this.endedConnectionP2pRttSamples.sampleList),(0,r.default)(e));return t.length>0?t[Math.floor(Math.random()*t.length)]:0}},{key:"totalConnectionDuration",get:function(){var e=this._statsProvider.getStat(u.default.PeerStats.TOTAL_CONNECTION_DURATION)+this.residualDisconnectedPeerDuration;return this.residualDisconnectedPeerDuration=0,e}},{key:"sampledResponseTime",get:function(){return this._statsProvider.getStat(u.default.PeerStats.SAMPLED_RESPONSE_TIME)}},{key:"sampledResponseDurationPerChunk",get:function(){return this._statsProvider.getStat(u.default.PeerStats.SAMPLED_RESPONSE_DURATION_PER_CHUNK)}},{key:"sampledLastChunkDelayFromTimeout",get:function(){return this._statsProvider.getStat(u.default.PeerStats.SAMPLED_LAST_CHUNK_DELAY_FROM_TIMEOUT)}}]),e}();t.default=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(17)),a=u(n(1)),i=u(n(2)),o=u(n(134));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n){(0,a.default)(this,e),this.abortFragmentCount=0,this.emergencyTrackSwitchCount=0,this.videoUpTrackSwitchCount=0,this.videoDownTrackSwitchCount=0,this.maxBitrate=0,this.minBitrate=0,this.playbackErrorCount=0,this.mediaElementSet=0,this.mediaElementChanged=0,this._mediaElementPlaceholder=t,this._mediaMap=n}return(0,i.default)(e,[{key:"dispose",value:function(){this._mediaMap=new o.default}},{key:"duration",get:function(){return!this._mediaMap.isLive()&&this._mediaElementPlaceholder.mediaElement?this._mediaElementPlaceholder.mediaElement.duration:0}},{key:"videoTrackCount",get:function(){var e=this._mediaMap.getTrackList(),t=0,n=!0,a=!1,i=void 0;try{for(var o,u=(0,r.default)(e);!(n=(o=u.next()).done);n=!0){var s=o.value;if((!s.type||"video"===s.type)&&(t++,s.bitrate)){var l=s.bitrate;this.maxBitrate=Math.max(this.maxBitrate,l),this.minBitrate=0===this.minBitrate?l:Math.min(this.minBitrate,l)}}}catch(e){a=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(a)throw i}}return t}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(1)),a=l(n(2)),i=(l(n(72)),l(n(3))),o=l(n(98)),u=l(n(265)),s=l(n(280));function l(e){return e&&e.__esModule?e:{default:e}}var c=.1,f=10,d=function(){function e(t){var n=this;(0,r.default)(this,e),this._bandwidthEstimates=[],this._latencyHistory=new s.default(f),this.cdnSpeed=null,this.cdnTimestamp=null,this.p2pSpeed=0,this.estimatedBitrate=0,this.p2pUsefulEstimate=1,this.concurrentP2pDownloaded=0,this.concurrentP2pDownloadCount=0,this.cdnEstimationCount=0,this.feebackCount=0,this._addBandwidthEstimate=function(e){n.feebackCount++;var t=e.p2pDuration+e.cdnDuration;if(0!==t){var r=e.p2pDownloaded+e.cdnDownloaded/t;n._bandwidthEWMA?n._bandwidthEWMA.update(r):n._bandwidthEWMA=new o.default(r,c),n._bandwidthEstimates.push(n._bandwidthEWMA.value),null!=e.latency&&e.cdnDownloaded>0&&n._latencyHistory.addSample(e.latency)}},this._eventBus=t,this._eventBus.on(i.default.SRModuleInterface.ABR_FEEDBACK,this._addBandwidthEstimate)}return(0,a.default)(e,[{key:"flushBandwidthEstimates",value:function(){this._bandwidthEstimates=[]}},{key:"dispose",value:function(){this.flushBandwidthEstimates()}},{key:"bandwidthEstimateCV",get:function(){var e=u.default.meanAbsoluteDeviation(this._bandwidthEstimates),t=u.default.mean(this._bandwidthEstimates);return e&&t&&0!==t?e/t:0}},{key:"latencyHistoricalValue",get:function(){return 0===this._latencyHistory.length?50:Math.round(this._latencyHistory.mean)}}]),e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(663)),o=s(n(3)),u=s(n(68));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){var n=this;(0,r.default)(this,e),this._currentPeerCount=0,this.peerCountPerPeerPoolHighEvent=0,this.peerLimitPerPeerPoolHighEvent=0,this._onPeerPoolHigh=function(){n.peerCountPerPeerPoolHighEvent+=n._currentPeerCount,n.peerLimitPerPeerPoolHighEvent+=n._sharedState.conf.PEER_POOL_LIMIT},this._onPeerPoolStats=function(e){var t=e.peerCount;n._currentPeerCount=t},this._sharedState=t,this._peerPoolHighObserver=new i.default(t.externalEventBus,u.default.RESOURCE_USAGE.PEER_POOL_HIGH),this._sharedState.externalEventBus.on(u.default.RESOURCE_USAGE.PEER_POOL_HIGH,this._onPeerPoolHigh),this._sharedState.eventBus.on(o.default.PeerPool.PEER_STATS_UPDATE,this._onPeerPoolStats)}return(0,a.default)(e,[{key:"dispose",value:function(){this._peerPoolHighObserver.dispose(),this._sharedState.externalEventBus.removeListener(u.default.RESOURCE_USAGE.PEER_POOL_HIGH,this._onPeerPoolHigh),this._sharedState.eventBus.removeListener(o.default.PeerPool.PEER_STATS_UPDATE,this._onPeerPoolStats)}},{key:"sampledPeerPoolHighEventInterval",get:function(){return this._peerPoolHighObserver.getSampledEventInterval()}},{key:"peerPoolHighEventCount",get:function(){return this._peerPoolHighObserver.getEventCount()}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(186));function o(e){return e&&e.__esModule?e:{default:e}}var u=20,s=function(){function e(t,n){var a=this;(0,r.default)(this,e),this._onEvent=function(){var e=Date.now(),t=Math.max(0,e-a._lastEventTime);a._lastEventTime=e,a._eventIntervalSamplingQueue.addSample(t),a._eventCount+=1},this._externalEventBus=t,this._eventName=n,this._lastEventTime=Date.now(),this._eventIntervalSamplingQueue=new i.default(u),this._eventCount=0,t.on(n,this._onEvent)}return(0,a.default)(e,[{key:"dispose",value:function(){this._externalEventBus.removeListener(this._eventName,this._onEvent)}},{key:"getSampledEventInterval",value:function(){return this._eventIntervalSamplingQueue.fetchSample()}},{key:"getEventCount",value:function(){return this._eventCount}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(1),i=(r=a)&&r.__esModule?r:{default:r};t.default=function e(){(0,i.default)(this,e),this.trackerConnectionAttempts=0,this.trackerErrors=0,this.signalingConnectionAttempts=0,this.signalingDisconnections=0,this.signalingErrors=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(82)),a=i(n(194));function i(e){return e&&e.__esModule?e:{default:e}}var o={TRACKER_URL:"",SIGNALING_URL:"",PROPERTY:"",REQUESTED_PROPERTY:"",MAX_NUMBER_OF_PEERS_ASKED_BY_GET_PEERS_MESSAGE:20,ASK_PEERS_INTERVAL:6e4,ASK_PEERS_AFTER_TRACK_SWITCH_INTERVAL:1e4,SEND_TRACKS_INTERVAL:6e4,SEND_TRACKS_REQUESTS:!0,REQUEST_RETRY:{SIGNALING:{TIMEOUT:1e4,MAX_INIT_DELAY:3e4,MIN_DELAY:5e3,MAX_DELAY:18e4,MIN_FACTOR:2,MAX_FACTOR:2.4},TRACKER:{MIN_DELAY:5e3,MAX_DELAY:18e4,MIN_FACTOR:2,MAX_FACTOR:2.4,MAX_REINIT_DELAY:6e4}},CONF_LABEL:"default",EXPOSE_CONF_LABEL:!1,ERRORS:{API_KEY:"8b7816ec573ca40bb9ec856f646f08c5",HANDLER:"xhr",STAGES:["staging","qa","production"]},PEER_CONNECTION_TIMEOUT:5e4,ICECANDIDATES_TIMEOUT:15e3,SEND_HEARTBEAT_INTERVAL:5e3,CHECK_HEARTBEAT_INTERVAL:1e4,ENABLE_ICECANDIDATES_TIMEOUT:!1,DATACHANNEL_TYPE:"limited-retransmits",DATACHANNEL_MAX_PACKET_LIFETIME:1e3,DATACHANNEL_MAX_RETRANSMITS:1,ENABLE_STUN:!0,ENABLE_TURN:!1,ENCODE_SDP:!0,ENABLE_SDP_IPV6:!1,STUNSERVERS:["stun.l.google.com:19302"],TURNSERVERS:[],CLIENT_TRACKER_PROTOCOL_VERSION:"3.0.0",P2P_PROTOCOL_VERSION:"3.9.0",CHUNK_SIZE:15360,MIN_CHUNK_PERCENTAGE_DOWNLOADED_FOR_HAS_SEGMENT_ANSWER:80,P2P_CACHE_MAX_SIZE:136314880,P2P_CACHE_MAX_DURATION:0,ENABLE_P2P_CACHE_TIMELINE_GC:!1,MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH:300,GETSEGMENTTIME_CACHE_MAX_SIZE:1e3,MEDIA_MAP_SEGMENT_LIST_TTL:null,NB_SEGMENT_P2P_PREBUFFER:10,MAX_BUFFER_DURATION:300,SEGMENT_ID_ACCEPTABLE_RANGE:50,MEDIA_MAP_GET_SEGMENT_LIST_TRACK_EDGE_OFFSET:0,CHUNK_BATCHING_INTERVAL:1e3,CHUNK_BATCHING_TIMER_GUARD_RATIO:.4,CHUNK_TIMEOUT:3e3,CHUNK_GRACE_DURATION:3e4,UP_BUFFERED_AMOUNT_LOW_THRESHOLD:15e3,UP_MAX_BUFFERED_AMOUNT:6e4,CHUNK_UP_TIMEOUT:2400,ENABLE_UPLOAD_QUEUE_MANAGER:!1,UP_MIN_GLOBAL_BUFFERED_AMOUNT:102400,UP_MAX_GLOBAL_BUFFERED_AMOUNT:512e3,BUFFERED_AMOUNT_CACHE_DURATION:0,LIVE:{LOWER_BUFFER_TARGET:15,HIGHER_BUFFER_TARGET:30,BUFFER_LEVEL_UPLOAD_SPEED_EMWA_WEIGHT:.1,UPLOAD_THRESHOLD_MAX_BUFFER_TARGET_LOCKING:6e3,HIGHER_STATIC_BUFFER_TARGET:30,P2P_CACHE_MAX_SIZE:62914560,P2P_CACHE_MAX_DURATION:0,CHUNK_TIMEOUT:1700,CHUNK_UP_TIMEOUT:1100,NEAR_EDGE_MARGIN:12e4,LOW_TARGET_P2P_DL_BLOCK_DURATION:2e4,ENABLE_DYNAMIC_LOWER_TARGET:!1,CRITICAL_LOWER_TARGET_RATIO:.5,FAST_BUFFER_FILL_FRACTION:.5,LOWER_BUFFER_TARGET_DECREASE_STEP:.2,LOWER_BUFFER_TARGET_INCREASE_STEP:.3,BUFFER_TARGET_GAP_SAMPLE_INTERVAL:12e4,UNCOMPLETE_REQUESTS_COUNT_FOR_HIGHER_TARGET:1},BUFFER_CHECK_INTERVAL:100,BUFFER_ZERO_THRESHOLD:2,VOD_CRITICAL_BUFFER_THRESHOLD:-1,VOD_CRITICAL_BUFFER_P2P_STOP_DOWNLOAD_DURATION:2e4,VOD_CRITICAL_BUFFER_P2P_STOP_UPLOAD_DURATION:0,VOD_SAFE_BUFFER_THRESHOLD:10,SPEED_MONITOR_INTERVAL:1e3,MEAN_SPEED_CALCULATION_INTERVAL:500,PEER_UPLOAD_SPEED_EMA_HALF_LIFE:1e4,PEER_DOWNLOAD_SPEED_EMA_HALF_LIFE:15e3,PEER_SPEED_MONITOR_INTERVAL:1e3,PEER_TIMEOUT_RATIO_WINDOW:3e4,PEER_UPLOAD_CAPACITY_SAFE_RATIO:.5,PEER_UPLOAD_CAPACITY_EXTRA_RATIO:.1,PEER_UPLOAD_CAPACITY_COMPUTATION_INTERVAL:1e3,DEFAULT_PEER_UPLOAD_CAPACITY:3e3,MIN_PEER_UPLOAD_CAPACITY:1500,MAX_PEER_UPLOAD_CAPACITY_TIMEOUT_RATIO:.1,PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_UP:.6,PEER_UPLOAD_CAPACITY_EWMA_WEIGHT_DOWN:.5,PUC_EMWA_WEIGHT_USE_TIMEOUT_RATIO:!0,PUC_EMWA_WEIGHT_CAP:.8,PEER_INIT_LOCKED_DURATION:5e4,PEER_LOCKED_UPLOAD_THRESHOLD:.02,PEER_LOCKED_DOWNLOAD_THRESHOLD:.03,PEER_CRITICAL_CHUNK_TIMEOUT_THRESHOLD:.6,LOOSER_UPLOAD_THRESHOLD:50,PEER_POOL_LIMIT:16,PEER_POOL_MAINTENANCE_INTERVAL:1e3,EXPECTED_CONNECTION_SUCCESS_RATE:.4,MAX_CONCURRENT_CONNECTION_ESTABLISHMENT:2,RESERVED_OFFER_SLOTS:3,CANDIDATE_PEERS_TRY_DEQUEUE_INTERVAL:1e3,MAX_TRACKER_EXCLUSION_LENGTH:100,PEER_DISCONNECTED_EXCLUSION_DURATION:6e4,PEER_DISCONNECTED_EXCLUSION_RANK:1,OFFER_DECLINED_EXCLUSION_DURATION:6e4,OFFER_DECLINED_EXCLUSION_RANK:1,PEER_REMOVED_EXCLUSION_DURATION:9e5,PEER_REMOVED_EXCLUSION_RANK:1,PEER_CONNECTION_ATTEMPT_TIMED_OUT_EXCLUSION_DURATION:9e5,PEER_CONNECTION_ATTEMPT_EXCLUSION_RANK:1,CDN_SPEED_ESTIMATE_CONSIDER_P2P:!1,CDN_CONCURRENT_SCALING_CAP:1.5,P2P_SPEED_ZERO_THRESHOLD:50,P2P_SPEED_ESTIMATION_BUCKET_DURATION:100,P2P_SPEED_ESTIMATION_BUCKET_COUNT:100,P2P_SPEED_EMA_WEIGHT:.5,P2P_SPEED_EMA_ZERO_HALF_LIFE:12e4,P2P_USEFUL_CALCULATION_INTERVAL:5e3,P2P_USEFUL_SMA_WINDOW:12e4,P2P_DL_THRESHOLD_FOR_USEFUL_CORRECTION:50,P2P_USEFUL_RATIO_WEIGHT:.8,ABR_SEGMENT_CDN_RATIO_THRESHOLD:.3,ABR_CDN_SPEED_UPDATE_RATIO_THRESHOLD:.1,ABR_CDN_SMALL_SEGMENT_SPEED_UPDATE_RATIO_THRESHOLD:.7,ABR_CDN_DL_THRESHOLD:100,ABR_CDN_DL_DECAY_TIME:12e4,USE_COMBINED_ABR_FEEDBACK:!0,BITRATE_ESTIMATION_WINDOW:3e4,ENABLE_PREBUFFER_FEEDBACK:!0,BLOCK_SEEDER_SCHEDULING_WINDOW:6e4,BLOCK_SEEDER_SCHEDULING_DURATION:12e4,BLOCK_SEEDER_SCHEDULING_TIMEOUT_THRESHOLD:1.1,BLOCK_SEEDER_SCHEDULING_REQUEST_THRESHOLD:50,PEER_COMPUTE_RTT_INTERVAL:5e3,ENABLE_LATENCY_FEEDBACK:!1,LATENCY_CAPPING_RATIO:.5,MAX_PEER_CONNECTION_FAILURES:r.default,SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS:null,TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND:null,LOCKED_RETRY_INTERVAL:30,LOCKED_RETRY_TIMEOUT:500,TIMEOUT_GET_FULL_SEGMENT:0,RETURN_COPY_SEGMENT:!0,ENABLE_FIX_UNRELIABLE_SEGMENT_TIME:!0,ALLOW_P2P:!0,DEVICE_INFO:"",ID_CLIENT:"",ENABLE_PLAYBACK_ERROR_LOGGING:!1,ENABLE_FILTER_BANNED_SEEDERS:!1,ENABLE_FUNNEL_GETSEGMENT_CALLBACKS:!1,ENABLE_RR_PREVENT_FULL_SEGMENT_DISCARDING:!0,RANGE_REQUEST_DETECTION:!0,RR_DETECTION_MIN_BUFFER_LEVEL:10,DISABLE_RR_ON_UNKNOWN_ERROR:!1,CLUSTER_BY_PA_VERSION:!1,CLUSTER_BY_INTEGRATION_TAG:!1,ALLOW_HOSTLESS_SRFLX:!0,STRIP_HOST_CANDIDATE:!1,STRIP_HOST_FROM_SRFLX:!1,ENABLE_RESOURCE_ADAPTATION:!1,RESOURCE_USAGE_POLLING_INTERVAL:1e3,RESOURCE_USAGE_EVENT_INTERVAL:1e4,RESOURCE_USAGE_DROPPED_FRAME_PER_SEC_THRESHOLD:6,RESOURCE_USAGE_BUFFERING_WITH_BUFFER_RATIO_THRESHOLD:.25,RESOURCE_ADAPTATION_PEER_POOL_INCREASE:.05,RESOURCE_ADAPTATION_PEER_POOL_DECREASE:.75,RESOURCE_ADAPTATION_PEER_POOL_DECREASE_STEP:0,RESOURCE_ADAPTATION_PEER_POOL_CONVERGENCE:1,RESOURCE_ADAPTATION_PEER_POOL_MIN:1,RESOURCE_ADAPTATION_PEER_POOL_INIT:8,CDN_TOO_SMALL_SEGMENT_LENGTH_THRESHOLD:0,CDN_TOO_SMALL_SEGMENT_DISCARD:!1,PEER_IGNORE_LATE_CHUNKS_IN_DATA_DOWNLOADED:!1,SMOOTH_TOLERANCE_FOR_REACHED_LIVE_EDGE:.3,RESET_SIZE_ON_CDN_MISMATCH:!0,REJECT_MISMATCH_SEGMENT_INFO:!1,FORCE_REHASH_ON_FULL_CDN_PARTIAL_SEGMENT:!1,SCHEDULE_UNSAFE_ON_SECOND_SEGMENT:!1,PEER_CONNECTIONS_MAX_SAMPLE_SIZE:10};a.default.deepFreeze(o),t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(667)),o=n(668),u=n(71);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n,a,u){(0,r.default)(this,e),this._peerAgentDisposed=!1,this._isNearEdge=!0,this.isAlwaysDvr=!1,this._sharedState=t,this.currentTracks=new o.CurrentTracks(t.eventBus),this._playerInterface=n,this._mediaMap=a,this._streamType=u,this.nextSegmentPrebuffered={video:!1,audio:!1},this.rangeRequestStatus=new i.default(t)}return(0,a.default)(e,[{key:"isLive",value:function(){return this._mediaMap.isLive()}},{key:"getTrackBitrate",value:function(e){return this._mediaMap.getTrackBitrate(e)}},{key:"resetIsAlwaysDvr",value:function(){this.isAlwaysDvr=this.isLive()&&!this._isNearEdge}},{key:"dispose",value:function(){this._peerAgentDisposed=!0}},{key:"peerAgentDisposed",get:function(){return this._peerAgentDisposed}},{key:"isNearEdge",get:function(){if(this._streamType===u.StreamTypes.SMOOTH){var e=this._playerInterface.getLatency();if(e)return e<=this._sharedState.conf.LIVE.NEAR_EDGE_MARGIN/1e3}return this._isNearEdge},set:function(e){this._isNearEdge!==e&&(this._isNearEdge=e,this.isAlwaysDvr=!1)}},{key:"currentBufferTarget",get:function(){return this._playerInterface.getBufferTarget()||0}},{key:"streamType",get:function(){return this._streamType}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o={UNKNOWN:"unknown",DISABLED_BY_INJECTED_CONF:"disabledByInjectedConf",DISABLED_BY_PROPERTIES:"disabledByProperties",DISABLED_BECAUSE_NO_CORS:"disabledBecauseNoCors",DISABLED_BECAUSE_WRONG_RANGE:"disabledBecauseWrongRange",PROBABLY:"probably",ENABLED:"enabled",ENABLED_BY_STREAM:"enabledByStream"},u=function(){function e(t){(0,r.default)(this,e),this._status=o.UNKNOWN,this._sharedState=t,t.conf.RANGE_REQUEST_DETECTION?this._status=o.PROBABLY:this._status=t.peerAgentConfig.propertyParameters.detectRangeRequest?o.DISABLED_BY_INJECTED_CONF:o.DISABLED_BY_PROPERTIES}return(0,a.default)(e,[{key:"setProbably",value:function(){this._status===o.UNKNOWN||this._status===o.PROBABLY?this._status=o.PROBABLY:this._sharedState.errorFunnel.notifyError(new Error("Transition to 'probably' state is possible only from 'unknown'. Current status="+this._status))}},{key:"setDisabledBecauseNoCors",value:function(){this._status!==o.DISABLED_BECAUSE_NO_CORS&&(this._status===o.UNKNOWN?this._status=o.DISABLED_BECAUSE_NO_CORS:this._sharedState.errorFunnel.notifyError(new Error("Transition to 'disabledBecauseNoCors' state is possible only from 'unknown'. Current status="+this._status)))}},{key:"setDisabledBecauseWrongRange",value:function(){this._status===o.PROBABLY||this._status===o.ENABLED?this._status=o.DISABLED_BECAUSE_WRONG_RANGE:this._sharedState.errorFunnel.notifyError(new Error("Transition to 'disabledBecauseWrongRange' state is possible only from 'probably' or 'enabled'. Current status="+this._status))}},{key:"setEnabled",value:function(){this._status!==o.ENABLED_BY_STREAM&&(this._status===o.PROBABLY||this._status===o.ENABLED?this._status=o.ENABLED:this._sharedState.errorFunnel.notifyError(new Error("Transition to 'enabled' state is possible only from 'probably'. Current status="+this._status)))}},{key:"setEnabledByStream",value:function(){this._status=o.ENABLED_BY_STREAM}},{key:"status",get:function(){return this._status}},{key:"isUnknown",get:function(){return this._status===o.UNKNOWN}},{key:"isProbably",get:function(){return this._status===o.PROBABLY}},{key:"canDoRR",get:function(){return this.isProbably||this._status===o.ENABLED||this._status===o.ENABLED_BY_STREAM}}]),e}();u.States=o,t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentTracks=void 0;var r=u(n(99)),a=u(n(1)),i=u(n(2)),o=u(n(3));function u(e){return e&&e.__esModule?e:{default:e}}t.CurrentTracks=function(){function e(t){(0,a.default)(this,e),this._globalEventBus=t,this._lastSwitchTimestamp=r.default}return(0,i.default)(e,[{key:"update",value:function(e){var t=e.audio,n=e.video;if(!t&&!n)throw new Error("There must be at least one updated track");!t||this.audio&&this.audio.viewToString()===t.viewToString()||(this.audio=t,this._globalEventBus.emit(o.default.Metrics.TRACK_SWITCH,{isVideo:!1})),!n||this.video&&this.video.viewToString()===n.viewToString()||(this.video=n||this.video,this._lastSwitchTimestamp=Date.now(),this._globalEventBus.emit(o.default.Metrics.TRACK_SWITCH,{isVideo:!0}))}},{key:"lastSwitchTimestamp",get:function(){return this._lastSwitchTimestamp}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(670)),o=s(n(671)),u=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n,a){(0,r.default)(this,e),this._conf=t,this._eventBus=n,this._externalEventBus=a,this._onInit=this._init.bind(this),this._eventBus.on(u.default.Config.CONFIG_UPDATED,this._onInit),this._init()}return(0,a.default)(e,[{key:"dispose",value:function(){this._backendConnectionManager&&this._backendConnectionManager.dispose(),this._askPeersManager&&this._askPeersManager.dispose(),this._eventBus.removeListener(u.default.Config.CONFIG_UPDATED,this._onInit)}},{key:"_init",value:function(){this._backendConnectionManager||(this._backendConnectionManager=new i.default(this._conf,this._eventBus,this._externalEventBus)),this._conf.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS&&!this._askPeersManager&&(this._askPeersManager=new o.default(this._conf,this._eventBus))}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(3)),o=s(n(68)),u=n(18);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,n,a){(0,r.default)(this,e),this._tickInterval=null,this._conf=t,this._eventBus=n,this._externalEventBus=a,this._initTickInerval(),this._onDataTransferCallback=this._onDataTransfer.bind(this),this._eventBus.on(i.default.UploadQueue.CHUNK_REQUESTED,this._onDataTransferCallback),this._eventBus.on(i.default.ChunkManager.CHUNK_DOWNLOADED,this._onDataTransferCallback),this._eventBus.on(i.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE,this._onDataTransferCallback),this._backendUrlsUpdatedCallback=this._backendUrlsUpdated.bind(this),this._eventBus.on(i.default.Config.BACKEND_URLS_UPDATED,this._backendUrlsUpdatedCallback)}return(0,a.default)(e,[{key:"dispose",value:function(){this._clearTickInterval(),this._eventBus.removeListener(i.default.Config.BACKEND_URLS_UPDATED,this._backendUrlsUpdatedCallback),this._eventBus.removeListener(i.default.UploadQueue.CHUNK_REQUESTED,this._onDataTransferCallback),this._eventBus.removeListener(i.default.ChunkManager.CHUNK_DOWNLOADED,this._onDataTransferCallback),this._eventBus.removeListener(i.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE,this._onDataTransferCallback)}},{key:"_initTickInerval",value:function(){var e=this;this._conf.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND&&(this._clearTickInterval(),this._updateTransferTimestamp(),this._tickInterval=(0,u.createInterval)(function(){e._checkTimeSinceLastTransfer()},1e3))}},{key:"_clearTickInterval",value:function(){this._tickInterval&&(this._tickInterval.clear(),this._tickInterval=null)}},{key:"_updateTransferTimestamp",value:function(){this._lastTransferTimestamp=Date.now()}},{key:"_onDataTransfer",value:function(){this._updateTransferTimestamp(),this._isDisconnectedBecauseNoTransfer&&this._reconnectToBackend()}},{key:"_checkTimeSinceLastTransfer",value:function(){var e=Date.now()-this._lastTransferTimestamp;this._conf.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND&&e>=Number(this._conf.TRANSFER_ACTIVITY_TIMEOUT_TO_DISCONNECT_FROM_BACKEND)&&(this._isDisconnectedBecauseNoTransfer||(this._isDisconnectedBecauseNoTransfer=!0,this._disconnectFromBackend()))}},{key:"_backendUrlsUpdated",value:function(){this._disconnectFromBackend(),this._reconnectToBackend()}},{key:"_reconnectToBackend",value:function(){this._eventBus.emit(i.default.Tracker.TRACKER_CONNECTION_REQUEST),this._isDisconnectedBecauseNoTransfer&&this._externalEventBus.emit(o.default.ANALYTICS.RESTART_REPORTING_TRAFFIC),this._isDisconnectedBecauseNoTransfer=!1,this._initTickInerval()}},{key:"_disconnectFromBackend",value:function(){this._eventBus.emit(i.default.Tracker.TRACKER_DISCONNECTION_REQUEST),this._eventBus.emit(i.default.Signaling.SIGNALING_DISCONNECTION_REQUEST),this._isDisconnectedBecauseNoTransfer&&this._externalEventBus.emit(o.default.ANALYTICS.STOP_REPORTING_TRAFFIC),this._clearTickInterval()}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),a=u(n(2)),i=u(n(3)),o=n(18);function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n){(0,r.default)(this,e),this._stoppedAskingPeers=!1,this._conf=t,this._eventBus=n,this._updateSegmentTransferToPlayerTimestamp(),this._initTickInerval(),this._onSegmentTransferred=this._updateSegmentTransferToPlayerTimestamp.bind(this),n.on(i.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE,this._onSegmentTransferred)}return(0,a.default)(e,[{key:"dispose",value:function(){this._tickInterval.clear(),this._eventBus.removeListener(i.default.SRModuleInterface.SEGMENT_TRANSFERED_TO_MEDIA_ENGINE,this._onSegmentTransferred)}},{key:"_initTickInerval",value:function(){var e=this;this._tickInterval=(0,o.createInterval)(function(){e._checkTimeSinceLastSegmentTransferToPlayer()},1e3)}},{key:"_updateSegmentTransferToPlayerTimestamp",value:function(){this._lastSegmentToPlayerTransferTimestamp=Date.now(),this._stoppedAskingPeers&&this._startAskingPeers()}},{key:"_checkTimeSinceLastSegmentTransferToPlayer",value:function(){Date.now()-this._lastSegmentToPlayerTransferTimestamp>=Number(this._conf.SEGMENT_REQUEST_TIMEOUT_TO_STOP_ASKING_PEERS)&&this._stopAskingPeers()}},{key:"_stopAskingPeers",value:function(){!1===this._stoppedAskingPeers&&(this._stoppedAskingPeers=!0,this._eventBus.emit(i.default.PeerPool.STOP_ASKING_PEERS),this._tickInterval.clear())}},{key:"_startAskingPeers",value:function(){this._stoppedAskingPeers&&(this._stoppedAskingPeers=!1,this._eventBus.emit(i.default.PeerPool.START_ASKING_PEERS),this._initTickInerval())}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(99)),a=c(n(83)),i=c(n(17)),o=c(n(20)),u=c(n(1)),s=c(n(2)),l=c(n(673));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(){(0,u.default)(this,e),this._activeBlockKey=null,this._blockList=new o.default}return(0,s.default)(e,[{key:"_cleanExpiredBlocks",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=(0,i.default)(this._blockList.entries());!(e=(r=o.next()).done);e=!0){var u=(0,a.default)(r.value,2),s=u[0];u[1].active||(this._blockList.delete(s),s===this._activeBlockKey&&(this._activeBlockKey=null))}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}},{key:"_updateActiveBlock",value:function(){var e=null,t=r.default,n=!0,o=!1,u=void 0;try{for(var s,l=(0,i.default)(this._blockList.entries());!(n=(s=l.next()).done);n=!0){var c=(0,a.default)(s.value,2),f=c[0],d=c[1];d.endTimestamp>t&&(e=f,t=d.endTimestamp)}}catch(e){o=!0,u=e}finally{try{!n&&l.return&&l.return()}finally{if(o)throw u}}this._activeBlockKey=e}},{key:"block",value:function(e,t){this._cleanExpiredBlocks();var n=this.lookupTimedBlock(t);n?n.extend(e):(n=new l.default(e),this._blockList.set(t,n)),(!this.activeBlock||n.endTimestamp>this.activeBlock.endTimestamp)&&(this._activeBlockKey=t)}},{key:"unblock",value:function(e){return this._cleanExpiredBlocks(),!!this._blockList.delete(e)&&(e===this._activeBlockKey&&this._updateActiveBlock(),!0)}},{key:"unblockAll",value:function(){this._activeBlockKey=null,this._blockList.clear()}},{key:"lookupTimedBlock",value:function(e){return this._blockList.get(e)}},{key:"blocked",get:function(){return!!this.activeBlock&&this.activeBlock.active}},{key:"activeBlock",get:function(){return this._activeBlockKey?this.lookupTimedBlock(this._activeBlockKey):null}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(99)),a=o(n(1)),i=o(n(2));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,a.default)(this,e),this._endTimestamp=r.default,this.extend(t)}return(0,i.default)(e,[{key:"extend",value:function(e){var t=Date.now()+e;t>this._endTimestamp&&(this._endTimestamp=t)}},{key:"active",get:function(){return Date.now()<this._endTimestamp}},{key:"endTimestamp",get:function(){return this._endTimestamp}},{key:"remainingTime",get:function(){var e=this._endTimestamp-Date.now();return e>0?e:0}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(259)),a=u(n(1)),i=u(n(2)),o=u(n(675));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,a.default)(this,e),this._environment=t}return(0,i.default)(e,[{key:"getPlatform",value:function(){return this._environment.getPlatform()}},{key:"getJavaScriptEngine",value:function(){return this._environment.getJavaScriptEngine()}},{key:"getOperatingSystem",value:function(){return this._environment.getOperatingSystem?this._environment.getOperatingSystem():{name:"Unknown",version:""}}},{key:"isMobileBrowser",value:function(){return!1}},{key:"isSafari",value:function(){var e=this.getJavaScriptEngine();return("Safari"===e.name||"Mobile Safari"===e.name)&&(0,r.default)(e.version.split(".")[0],10)>=11}},{key:"isFirefox",value:function(){return"Firefox"===this.getJavaScriptEngine().name}},{key:"isEdge",value:function(){return"Edge"===this.getJavaScriptEngine().name}},{key:"isWebOS",value:function(){return this.getPlatform()===o.default.LG_WEB}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={WEB_DESKTOP:"web-desktop",WEB_MOBILE:"web-mobile",ANDROID:"android",IOS:"ios",CHROMECAST:"chromecast",ANDROID_WEBVIEW:"android-webview",UNKNOWN_NATIVE:"unknown-native",UNKNOWN:"unknown",LG_WEB:"lg-web",DESKTOP_ELECTRON:"desktop-electron"};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(86)),a=c(n(1)),i=c(n(2)),o=c(n(677)),u=c(n(102)),s=c(n(192)),l=c(n(103));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,a.default)(this,e),this._request=null,this._sharedState=t}return(0,i.default)(e,[{key:"create",value:function(e,t){var n=this;this._request&&(this._request.abort(),this._request=null);var a=e.url.endsWith("/")?e.url.slice(0,-1):e.url,i=a+"/init",o=(0,r.default)(this._generateInitPayload(e));this._sharedState.analyticsEventBus.emit(l.default.TRACKER_ATTEMPT),this._sharedState.analyticsEventBus.emit(l.default.TRACKER_REQUEST,{size:o.length});this._request=this._createHttpPostRequest(i,this._sharedState.conf.REQUEST_RETRY.TRACKER),this._request.send(o,function(){n._sharedState.analyticsEventBus.emit(l.default.TRACKER_ERROR)}).then(function(e){n._request=null,n._sharedState.analyticsEventBus.emit(l.default.TRACKER_SUCCESS,{size:(0,r.default)(e).length});var i=n._createTrackerConnection(a,e);t(i)})}},{key:"dispose",value:function(){this._request&&(this._request.abort(),this._request=null)}},{key:"_generateInitPayload",value:function(e){return{content:e.contentId,p2p_protocol:e.p2pProtocolVersion,customer_id:e.customerId,is_live:e.isLive,tracker_id:e.trackerId,buffer_level_max:e.bufferTarget,super_seeder_ratio:e.superSeederRatio,site_id:e.siteId}}},{key:"_createTrackerConnection",value:function(e,t){var n=t.peer_id,r=t.tracker_id;return new o.default(this._sharedState,e,n,r)}},{key:"_createHttpPostRequest",value:function(e,t){var n=u.default.Methods.POST,r=this._sharedState.httpRequestFactory,a=r?r.getRequest(n,e,{},t):new s.default(n,e,{});return a.isStreamroot=!0,a}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(86)),a=l(n(1)),i=l(n(2)),o=l(n(102)),u=l(n(192)),s=l(n(103));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,n,r,i){(0,a.default)(this,e),this._request=null,this._askPeersInfo=null,this._sharedState=t,this._trackerUrl=n,this._peerId=r,this._trackerId=i}return(0,i.default)(e,[{key:"askPeers",value:function(e,t,n){this._askPeersInfo=e,this._peersCallback=t,this._rejectedCallback=n,this._request||this._requestPeers()}},{key:"getPeerId",value:function(){return this._peerId}},{key:"getTrackerId",value:function(){return this._trackerId}},{key:"close",value:function(){this._request&&(this._request.abort(),this._request=null);var e=this._trackerUrl+"/bye",t=(0,r.default)(this._generateDisconnectionPayload());this._sharedState.analyticsEventBus.emit(s.default.TRACKER_REQUEST,{size:t.length}),this._createHttpPostRequest(e).send(t).catch(function(){})}},{key:"_requestPeers",value:function(){var e=this,t=this._trackerUrl+"/sources",n=function(){return(0,r.default)(e._generateGetPeersPayload())};this._sharedState.analyticsEventBus.emit(s.default.TRACKER_REQUEST,{size:n.length});this._request=this._createHttpPostRequest(t,this._sharedState.conf.REQUEST_RETRY.TRACKER),this._request.send(n,function(t){e._sharedState.analyticsEventBus.emit(s.default.TRACKER_ERROR),t&&401===t.status&&(e._request&&(e._request.abort(),e._request=null),e._rejectedCallback&&e._rejectedCallback())}).then(function(t){e._request=null,e._sharedState.analyticsEventBus.emit(s.default.TRACKER_SUCCESS,{size:(0,r.default)(t).length}),e._peersCallback&&e._peersCallback({peers:t.peers,becomeSuperSeeder:t.become_super_seeder})})}},{key:"_generateGetPeersPayload",value:function(){var e=this._askPeersInfo;if(!e)throw Error("Missing askPeersInfo");return{tracks:e.tracks,exclusions:e.exclusions,peer_number:e.number,current_position:e.currentPosition,near_edge:e.nearEdge,super_seeder_ratio:e.superSeederRatio,id:this._peerId}}},{key:"_generateDisconnectionPayload",value:function(){return{id:this._peerId}}},{key:"_createHttpPostRequest",value:function(e,t){var n=o.default.Methods.POST,r=this._sharedState.httpRequestFactory,a=r?r.getRequest(n,e,{},t):new u.default(n,e,{});return a.isStreamroot=!0,a}}]),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),a=u(n(2)),i=u(n(679)),o=u(n(680));u(n(189));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,r.default)(this,e),this._sharedState=t,this._manager=new o.default(this._sharedState)}return(0,a.default)(e,[{key:"create",value:function(e){return new i.default(this._sharedState,this._p2pCache,this._manager,e)}},{key:"registerP2PCache",value:function(e){this._p2pCache=e}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(85));o(n(189));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n,a,i){(0,r.default)(this,e),this._dataUploaded=0,this._onTransfering=function(){},this._lastBufferedAmountMaxTimestamp=null,this._bufferedAmountAccumulator=0,this._lastBufferedAmountFetchedTime=0,this._lastBufferedAmountFetched=0,this._safeQueue=[],this._unsafeQueue=[],this._sharedState=t,this._p2pCache=n,this._manager=a,this._peerConnection=i,this._connectionStats=i.stats,this._manager.register(this),this._peerConnection.onbufferedamountlow=this._onBufferedAmountLow.bind(this)}return(0,a.default)(e,[{key:"push",value:function(e){this._sharedState.conf.ENABLE_UPLOAD_QUEUE_MANAGER&&e.bandwidthSafety!==i.default.SAFE?this._unsafeQueue.push(e):this._safeQueue.push(e),this.tryDequeue()}},{key:"peek",value:function(){return this._safeQueue.length?this._safeQueue[0]:this._unsafeQueue.length?this._unsafeQueue[0]:void 0}},{key:"shift",value:function(){return this._safeQueue.length?this._safeQueue.shift():this._unsafeQueue.shift()}},{key:"shiftExpired",value:function(){for(var e=this.peek();e&&e.isExpired;)this.shift(),e=this.peek()}},{key:"tryDequeue",value:function(){this.shiftExpired(),this.length>0&&this._canDequeue()&&this.dequeue()}},{key:"tryDequeueAll",value:function(){for(this.shiftExpired();this.length>0&&this._canDequeue();)this.dequeue()}},{key:"dequeue",value:function(){var e=this.shift();if(e){this._sharedState.efficiencyStats.dequeuedReceivedChunkRequestCount++;var t=this._p2pCache.getSegmentHandler(e.segmentView),n=t?t.chunkManager:null;if(n){var r=n.getChunk(e.chunkIndex);r?this.onChunkFound(e,r):this.onChunkMissed()}}}},{key:"dispose",value:function(){this._manager.unregister(this),this._onTransfering=function(){},this._peerConnection.onbufferedamountlow=function(){},this._safeQueue=[],this._unsafeQueue=[]}},{key:"onChunkFound",value:function(e,t){var n=t.byteLength;this._lastBufferedAmountMaxTimestamp&&(this._bufferedAmountAccumulator+=n),this._peerConnection.sendBinaryData(t,e)&&(this._lastBufferedAmountFetched+=n,this._dataUploaded+=n,this._connectionStats.dataUploaded+=n,this._connectionStats.receivedChunkRequestAnsweredCount++,this._sharedState.transferStats.p2pUploaded+=n,this._onTransfering())}},{key:"onChunkMissed",value:function(){this._sharedState.efficiencyStats.missedDequeuedChunkRequestCount++,this._sharedState.conf.ENABLE_UPLOAD_QUEUE_MANAGER||this.tryDequeue()}},{key:"getBufferedAmount",value:function(){var e=Date.now();return e-this._lastBufferedAmountFetchedTime>=this._sharedState.conf.BUFFERED_AMOUNT_CACHE_DURATION&&(this._lastBufferedAmountFetchedTime=e,this._lastBufferedAmountFetched=this._peerConnection.getBufferedAmount()),this._lastBufferedAmountFetched}},{key:"_canDequeue",value:function(){if(this._sharedState.conf.ENABLE_UPLOAD_QUEUE_MANAGER)return this._manager.canDequeue(this);var e=this.getBufferedAmount()<=this._sharedState.conf.UP_MAX_BUFFERED_AMOUNT;return e||(this._lastBufferedAmountMaxTimestamp=Date.now(),this._bufferedAmountAccumulator=this.getBufferedAmount()),e}},{key:"_onBufferedAmountLow",value:function(){if(this._lastBufferedAmountMaxTimestamp){var e=Date.now()-this._lastBufferedAmountMaxTimestamp;e>0&&this._sharedState.peerStats.sampledDataChannelBufferEmptyingStatsQueue.addSample({time:e,amount:this._bufferedAmountAccumulator}),this._lastBufferedAmountMaxTimestamp=null}this._sharedState.conf.ENABLE_UPLOAD_QUEUE_MANAGER?(this.tryDequeueAll(),this._bufferedAmountAccumulator=this.getBufferedAmount(),this._bufferedAmountAccumulator&&(this._lastBufferedAmountMaxTimestamp=Date.now())):this.tryDequeue()}},{key:"length",get:function(){return this._safeQueue.length+this._unsafeQueue.length}},{key:"dataUploaded",get:function(){return this._dataUploaded}},{key:"onTransfering",set:function(e){this._onTransfering=e}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(48)),a=s(n(84)),i=s(n(1)),o=s(n(2)),u=s(n(85));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,i.default)(this,e),this._sharedState=t,this._queues=new a.default}return(0,o.default)(e,[{key:"register",value:function(e){this._queues.add(e)}},{key:"unregister",value:function(e){this._queues.delete(e)}},{key:"getQueuesCount",value:function(){return this._queues.size}},{key:"canDequeue",value:function(e){var t=e.getBufferedAmount();if(t>=this._sharedState.conf.UP_MAX_BUFFERED_AMOUNT)return!1;for(var n=this.getTotalBufferedAmount();n<this._sharedState.conf.UP_MAX_GLOBAL_BUFFERED_AMOUNT;){var r=e.peek();if(r){if(n<this._sharedState.conf.UP_MIN_GLOBAL_BUFFERED_AMOUNT)return!0;if(r.bandwidthSafety===u.default.SAFE)return!0}var a=this.getDequeueCandidate(t);if(!a||a===e)return!0;a.dequeue(),n+=this._sharedState.conf.CHUNK_SIZE}return!1}},{key:"getDequeueCandidate",value:function(e){var t=this,n=(0,r.default)(this._queues.values()).filter(function(t){return t.length>0&&t.getBufferedAmount()<=e});return n.sort(function(e,n){var r=e.peek(),a=n.peek();if(r.bandwidthSafety===u.default.SAFE&&a.bandwidthSafety!==u.default.SAFE)return-1;if(a.bandwidthSafety===u.default.SAFE&&r.bandwidthSafety!==u.default.SAFE)return 1;var i=e.getBufferedAmount(),o=n.getBufferedAmount(),s=t._sharedState.conf.UP_BUFFERED_AMOUNT_LOW_THRESHOLD;return i<=s&&o>s?-1:o<=s&&i>s?1:r.timestamp-a.timestamp}),n.length>0?n[0]:null}},{key:"getTotalBufferedAmount",value:function(){return(0,r.default)(this._queues.values(),function(e){return e.getBufferedAmount()}).reduce(function(e,t){return e+t},0)}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overloadPropertiesFromDistributor=t.overloadConfigFromDistributor=t.overloadDefaultConfig=void 0;var r=i(n(54)),a=i(n(92));function i(e){return e&&e.__esModule?e:{default:e}}var o=new(i(n(84)).default)(["TRACKER_URL","SIGNALING_URL","TRACKER_DELAY_MAX","TRACKER_DELAY_INIT","SEND_TRACKS_INTERVAL","ERRORS.HANDLER","ERRORS.STAGES","SEND_HEARTBEAT_INTERVAL","CHECK_HEARTBEAT_INTERVAL","CLIENT_TRACKER_PROTOCOL_VERSION","P2P_PROTOCOL_VERSION","MAX_DISTRIBUTED_SEGMENT_LIST_LENGTH","GETSEGMENTTIME_CACHE_MAX_SIZE","BUFFER_CHECK_INTERVAL","SPEED_MONITOR_INTERVAL","MEAN_SPEED_CALCULATION_INTERVAL","PEER_COMPUTE_RTT_INTERVAL","BITRATE_ESTIMATION_WINDOW","LATENCY_CAPPING_RATIO","LOCKED_RETRY_INTERVAL","LOCKED_RETRY_TIMEOUT","TIMEOUT_GET_FULL_SEGMENT","RETURN_COPY_SEGMENT","ALLOW_P2P","DEVICE_INFO","ID_CLIENT","PROPERTY"]);t.overloadDefaultConfig=function(e,t){e.ID_CLIENT=t.streamrootKey,e.PROPERTY=t.propertyParameters.name,e.REQUESTED_PROPERTY=t.propertyParameters.requested,e.P2P_PROTOCOL_VERSION+="-"+t.versions.integrationVersion},t.overloadConfigFromDistributor=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];void 0!==t.CONF_LABEL?(!function e(t,n,i,o){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";(0,a.default)(n).forEach(function(a){var s=""===u?a:u+"."+a;void 0!==t[a]?"object"!==(0,r.default)(n[a])||Array.isArray(n[a])?i(t,n,s):e(t[a],n[a],i,o,s):o(t,n,s)})}(e,t,function(e,t,r){if(o.has(r))n.notify("Unable to inject "+r,"Conf parameter "+r+" is not injectable.");else{var a=function(e){return e.substr(e.lastIndexOf(".")+1)}(r);e[a]=t[a]}},function(e,t,r){"WEB"!==r&&"NATIVE"!==r&&n.notify("Unable to inject "+r,"Conf parameter "+r+" does not exist in default conf.")}),i&&(e.P2P_PROTOCOL_VERSION+="-"+e.CONF_LABEL),void 0!==t.CHUNK_SIZE&&(e.P2P_PROTOCOL_VERSION+="-cz"+t.CHUNK_SIZE)):n.notify("Missing CONF_LABEL in injected conf","")},t.overloadPropertiesFromDistributor=function(e,t){e.PROPERTY=t.name,void 0!==t.detectRangeRequest&&e.RANGE_REQUEST_DETECTION&&(e.RANGE_REQUEST_DETECTION=!!t.detectRangeRequest),void 0!==t.localNetworkOnly&&(e.ENABLE_STUN=!t.localNetworkOnly),t.customStunUrls instanceof Array&&t.customStunUrls.length>0&&(e.STUNSERVERS=t.customStunUrls)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(683).default;t.default={getSegmentHasher:function(){return new r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(132));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){(0,r.default)(this,e)}return(0,a.default)(e,[{key:"calculateHash",value:function(e,t){i.default.add("hash_worker_callback",e.id,t),HashInteractor.forge(e.id,e.byteLength)}},{key:"dispose",value:function(){this._disposed=!0}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r(n(55)),r(n(685));function r(e){return e&&e.__esModule?e:{default:e}}t.default={get:function(e,t,n){var r=t.transferStats,a=r.cdnDownloaded,i=r.p2pUseful,o=r.p2pUploaded,u={cdn:a,p2p:i,peers:e?e.getPeerArray().length:0,upload:o,confLabel:""};return t.conf.EXPOSE_CONF_LABEL&&(u.confLabel=t.conf.CONF_LABEL+"|on"),u}}},function(e,t,n){"use strict";t.__esModule=!0;var r,a=n(55),i=(r=a)&&r.__esModule?r:{default:r};t.default=i.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e),this._mediaElement=null}return(0,a.default)(e,[{key:"mediaElement",get:function(){return this._mediaElement},set:function(e){this._mediaElement=e}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={get:function(e){var t={version:e.version,get stats(){return e.stats},get networkType(){return e.networkType},set networkType(t){e.networkType=t},transferStatus:{get effectiveDownloadAllowed(){return e.transferStatus.effectiveDownloadAllowed},get effectiveUploadAllowed(){return e.transferStatus.effectiveUploadAllowed}},get dnaDownloadAllowed(){return e.dnaDownloadAllowed},set dnaDownloadAllowed(t){e.dnaDownloadAllowed=t},get dnaUploadAllowed(){return e.dnaUploadAllowed},set dnaUploadAllowed(t){e.dnaUploadAllowed=t},get dnaDownloadOnWifiEthernetAllowed(){return e.dnaDownloadOnWifiEthernetAllowed},set dnaDownloadOnWifiEthernetAllowed(t){e.dnaDownloadOnWifiEthernetAllowed=t},get dnaUploadOnWifiEthernetAllowed(){return e.dnaUploadOnWifiEthernetAllowed},set dnaUploadOnWifiEthernetAllowed(t){e.dnaUploadOnWifiEthernetAllowed=t},get dnaDownloadOnCellularAllowed(){return e.dnaDownloadOnCellularAllowed},set dnaDownloadOnCellularAllowed(t){e.dnaDownloadOnCellularAllowed=t},get dnaUploadOnCellularAllowed(){return e.dnaUploadOnCellularAllowed},set dnaUploadOnCellularAllowed(t){e.dnaUploadOnCellularAllowed=t}};return t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e)}return(0,a.default)(e,[{key:"init",value:function(e,t){this._p2pCache=e,this._scheduler=t}},{key:"getStats",value:function(){var e=this._scheduler.getEdgeSegment();if(e){var t=e.getId(),n=this._p2pCache.getSegmentsStats(),r=n.minSegmentId,a=n.maxSegmentId;return{min:r||t,max:a||t,current:t}}return null}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=new r.default(e.conf.BITRATE_ESTIMATION_WINDOW);e.eventBus.on(a.default.SRModuleInterface.ABR_FEEDBACK,function(){t.push(e.transferStats.p2pConsumed+e.transferStats.cdnConsumed);var n=t.delta,r=t.timeDelta;n&&r&&(e.abrStats.estimatedBitrate=8*n/r)})};var r=i(n(185)),a=i(n(3));function i(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(1)),a=u(n(2)),i=u(n(691)),o=u(n(692));function u(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n){var a=this;(0,r.default)(this,e),this._onFragLoadAborted=function(){a._sharedState.mediaStats.emergencyTrackSwitchCount++},this._onTrackSwitch=function(e){a._incrementTrackSwitchMetrics(e),a._updateCurrentTracks(e)},this._externalEventManager=t,this._externalEventManager.addMediaEventListener(i.default.EMERGENCY_FRAG_LOAD_ABORT,this._onFragLoadAborted),this._externalEventManager.addMediaEventListener(i.default.TRACK_CHANGE_EVENT,this._onTrackSwitch),this._sharedState=n}return(0,a.default)(e,[{key:"_updateCurrentTracks",value:function(e){var t=e.audio,n=e.video;this._sharedState.moduleState.currentTracks.update({audio:t,video:n})}},{key:"_compareToCurrentTrack",value:function(e){var t=this._sharedState.moduleState.currentTracks.video,n=e.video;if(n){if(!t)return o.default.HIGHER;var r=this._sharedState.moduleState.getTrackBitrate(t),a=this._sharedState.moduleState.getTrackBitrate(n);return r===a?o.default.SAME:r<a?o.default.HIGHER:o.default.LOWER}}},{key:"_incrementTrackSwitchMetrics",value:function(e){if(e.video){var t=this._compareToCurrentTrack(e);t===o.default.HIGHER?this._sharedState.mediaStats.videoUpTrackSwitchCount++:t===o.default.LOWER&&this._sharedState.mediaStats.videoDownTrackSwitchCount++}}},{key:"updateWithSegmentView",value:function(e){var t={};t[e.trackView.type]=e.trackView,this._incrementTrackSwitchMetrics(t),this._updateCurrentTracks(t)}}]),e}();t.default=s},function(e,t,n){"use strict";e.exports={TRACK_CHANGE_EVENT:"onTrackChange",EMERGENCY_FRAG_LOAD_ABORT:"onEmergencyFragLoadAborted"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={HIGHER:"higher",SAME:"same",LOWER:"lower"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e.eventBus.on(i.default.BufferedAmountObserver.BUFFER_CHECK,function(t){t<e.conf.VOD_CRITICAL_BUFFER_THRESHOLD?(e.p2pDownloadBlocker.block(e.conf.VOD_CRITICAL_BUFFER_P2P_STOP_DOWNLOAD_DURATION,o),e.p2pUploadBlocker.block(e.conf.VOD_CRITICAL_BUFFER_P2P_STOP_UPLOAD_DURATION,o)):t>e.conf.VOD_SAFE_BUFFER_THRESHOLD&&e.p2pDownloadBlocker.unblock(o)})};var r,a=n(3),i=(r=a)&&r.__esModule?r:{default:r};var o="vodQosOptimizerBlock"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,r.default)(this,e)}return(0,a.default)(e,[{key:"getBufferTarget",value:function(){return 0}},{key:"setBufferTarget",value:function(e){}},{key:"getLatency",value:function(){return null}},{key:"on",value:function(e,t){}},{key:"removeListener",value:function(e,t){}},{key:"getPlayerInfo",value:function(){}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(696));o(n(698)),o(n(68));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n){(0,r.default)(this,e),this._peerPoolActionnable=null,this._peerPoolHighObservable=null,this._sharedState=t,this._peerPool=n,this._sharedState.conf.ENABLE_RESOURCE_ADAPTATION&&this._init()}return(0,a.default)(e,[{key:"dispose",value:function(){this._peerPoolActionnable&&this._peerPoolActionnable.dispose(),this._peerPoolHighObservable&&this._peerPoolHighObservable.dispose()}},{key:"_init",value:function(){this._peerPoolActionnable=new i.default(this._sharedState,this._peerPool)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=f(n(13)),a=f(n(1)),i=f(n(2)),o=f(n(11)),u=f(n(12)),s=f(n(697)),l=f(n(3)),c=f(n(68));function f(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e,n){(0,a.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,c.default.RESOURCE_USAGE.PEER_POOL_HIGH));return i._peerPool=n,i._increaseStep=e.conf.RESOURCE_ADAPTATION_PEER_POOL_INCREASE,i._decreaseRatio=e.conf.RESOURCE_ADAPTATION_PEER_POOL_DECREASE,i._decreaseStep=e.conf.RESOURCE_ADAPTATION_PEER_POOL_DECREASE_STEP,i._convergenceFactor=e.conf.RESOURCE_ADAPTATION_PEER_POOL_CONVERGENCE,i._minimumValue=e.conf.RESOURCE_ADAPTATION_PEER_POOL_MIN,i._maximumValue=e.conf.PEER_POOL_LIMIT,i.init(e.conf.RESOURCE_ADAPTATION_PEER_POOL_INIT),i}return(0,u.default)(t,e),(0,i.default)(t,[{key:"getValue",value:function(){return this._peerPool.getPeerCount()}},{key:"setValueCap",value:function(e){var t=Math.round(e);this._sharedState.conf.PEER_POOL_LIMIT!==t&&(this._sharedState.conf.PEER_POOL_LIMIT=t,this._sharedState.eventBus.emit(l.default.PeerPool.PEER_LIMIT_UPDATE))}}]),t}(s.default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=n(18);function o(e){return e&&e.__esModule?e:{default:e}}var u=1e3,s=function(){function e(t,n){var a=this;(0,r.default)(this,e),this._increaseStep=.1,this._decreaseRatio=.8,this._minimumValue=1,this._maximumValue=10,this._decreaseStep=0,this._convergenceFactor=1,this._value=1,this._onTick=function(){a._value+=a._increaseStep,a._update()},this._onLimitEvent=function(){a._value=Math.min(a._value,a.getValue())*a._decreaseRatio-a._decreaseStep,a._increaseStep*=a._convergenceFactor;var e=a;e._decreaseRatio=Math.pow(e._decreaseRatio,a._convergenceFactor),a._update()},this._sharedState=t,this._limitEventName=n,t.externalEventBus.on(n,this._onLimitEvent),this._tickTimer=(0,i.createInterval)(this._onTick,u)}return(0,a.default)(e,[{key:"dispose",value:function(){this._sharedState.externalEventBus.removeListener(this._limitEventName,this._onLimitEvent),this._tickTimer&&(this._tickTimer.clear(),this._tickTimer=null)}},{key:"init",value:function(e){this._value=e,this._update()}},{key:"_update",value:function(){this._value=Math.max(this._value,this._minimumValue),this._value=Math.min(this._value,this._maximumValue),this.setValueCap(this._value)}},{key:"getValue",value:function(){return this._value}},{key:"setValueCap",value:function(e){}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(13)),a=c(n(1)),i=c(n(2)),o=c(n(11)),u=c(n(12)),s=c(n(699)),l=n(38);function c(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,n){(0,a.default)(this,t);var i=(0,o.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n));return i._droppedFrameCountDelta=new l.Delta,i._timeSpentRebufferingWithBufferDelta=new l.Delta,i}return(0,u.default)(t,e),(0,i.default)(t,[{key:"observe",value:function(e){var t=this._sharedState.qosAnalytics?this._sharedState.qosAnalytics.getQoSAnalytics():null;if(!t)return!1;var n=this._sharedState.uaHelper.isSafari()?0:this._droppedFrameCountDelta.calcDelta(t.droppedFrameCount),r=this._timeSpentRebufferingWithBufferDelta.calcDelta(t.timeSpentRebufferingWithBuffer),a=e/1e3;return n>=this._sharedState.conf.RESOURCE_USAGE_DROPPED_FRAME_PER_SEC_THRESHOLD*a||r>=this._sharedState.conf.RESOURCE_USAGE_BUFFERING_WITH_BUFFER_RATIO_THRESHOLD*a}}]),t}(s.default);t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=n(18);function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n){var a=this;(0,r.default)(this,e),this._lastObserved=!1,this._onCheck=function(){var e=a.observe(a._lastObserved?a._sharedState.conf.RESOURCE_USAGE_EVENT_INTERVAL:a._sharedState.conf.RESOURCE_USAGE_POLLING_INTERVAL);e&&a._sharedState.externalEventBus.emit(a._eventName),e!==a._lastObserved&&(a._lastObserved=e,a._checkTimer&&a._checkTimer.clear(),a._checkTimer=(0,i.createInterval)(a._onCheck,e?a._sharedState.conf.RESOURCE_USAGE_EVENT_INTERVAL:a._sharedState.conf.RESOURCE_USAGE_POLLING_INTERVAL))},this._sharedState=t,this._eventName=n,this._checkTimer=(0,i.createInterval)(this._onCheck,this._sharedState.conf.RESOURCE_USAGE_POLLING_INTERVAL)}return(0,a.default)(e,[{key:"dispose",value:function(){this._checkTimer&&(this._checkTimer.clear(),this._checkTimer=null)}},{key:"observe",value:function(e){return!1}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(1)),a=c(n(2)),i=c(n(701)),o=c(n(702)),u=c(n(705)),s=c(n(706)),l=c(n(707));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,r.default)(this,e),this._sharedState=t,this._trafficAnalytics=new i.default(t),this._statsAnalytics=new o.default(t),this._controlAnalytics=new u.default(t),this._supportAnalytics=new s.default(t),this._peerConnectionsAnalytics=new l.default(this._sharedState)}return(0,a.default)(e,[{key:"attachPeerPool",value:function(e){this._peerConnectionsAnalytics.attachPeerPool(e)}},{key:"detachPeerPool",value:function(){this._peerConnectionsAnalytics.detachPeerPool()}},{key:"calculatePayload",value:function(e){switch(e){case"traffic":return this._trafficAnalytics.calculatePayload();case"stats":return this._statsAnalytics.calculatePayload();case"control":return this._controlAnalytics.calculatePayload();case"support":return this._supportAnalytics.calculatePayload();case"connections":return this._peerConnectionsAnalytics.calculatePayload();default:throw Error("Unknown payload label")}}},{key:"dispose",value:function(){this._trafficAnalytics.dispose(),this._statsAnalytics.dispose(),this._controlAnalytics.dispose(),this._supportAnalytics.dispose()}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=n(38);function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,r.default)(this,e),this._sharedState=t,this._lastPayloadTimestamp=Date.now(),this._p2p=new i.Delta,this._cdn=new i.Delta,this._upload=new i.Delta,this._played=new i.Delta,this._buffered=new i.Delta}return(0,a.default)(e,[{key:"dispose",value:function(){}},{key:"calculatePayload",value:function(){var e=this._sharedState,t=e.transferStats,n=e.moduleState,r=this._cdn.calcDelta(t.cdnDownloaded),a=this._p2p.calcDelta(t.p2pUseful),i=this._upload.calcDelta(t.p2pUploaded),o=this._sharedState.qosAnalytics?this._sharedState.qosAnalytics.getQoSAnalytics():null,u=o?Math.round(1e3*Math.max(this._played.calcDelta(o.timeSpentPlaying),0)):0,s=o?Math.round(1e3*Math.max(this._buffered.calcDelta(o.timeSpentRebuffering),0)):0,l={live:n.isLive(),timespan:this._getTimespanSinceLastPayload(),cdn:r,p2p:a,upload:i,played:u>0?u:void 0,buffered:s>0?s:void 0,siteId:this._sharedState.peerAgentConfig.siteId||void 0};return this._updateLastPayloadTimestamp(),l}},{key:"_getTimespanSinceLastPayload",value:function(){return Date.now()-this._lastPayloadTimestamp}},{key:"_updateLastPayloadTimestamp",value:function(){this._lastPayloadTimestamp=Date.now()}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=l(n(1)),a=l(n(2)),i=l(n(703)),o=l(n(704)),u=n(38),s=n(56);function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,r.default)(this,e),this._lastPayloadTimestamps={},this._sharedState=t,this._optionsObserver=new i.default(t),this._peerPoolObserver=new o.default(t),this._sessionStartTime=Date.now(),this._lastPayloadTimestamp=Date.now(),this._p2pUseful=new u.Delta,this._cdnDownloaded=new u.Delta,this._p2pConsumed=new u.Delta,this._cdnConsumed=new u.Delta,this._p2pMediaDownloaded=new u.Delta,this._p2pMessagesDownloaded=new u.Delta,this._p2pHeadersDownloaded=new u.Delta,this._p2pMessagesCount=new u.Delta,this._p2pUploaded=new u.Delta,this._cdnRequestCount=new u.Delta,this._cdnErrorCount=new u.Delta,this._cdnTooSmallCount=new u.Delta,this._PP=new u.Delta,this._PC=new u.Delta,this._CP=new u.Delta,this._CC=new u.Delta,this._HP=new u.Delta,this._HD=new u.Delta,this._M=new u.Delta,this._total=new u.Delta,this._concurrentP2pDownloaded=new u.Delta,this._concurrentP2pDownloadCount=new u.Delta,this._cdnEstimationCount=new u.Delta,this._receivedChunkRequest=new u.Delta,this._missedDequeuedChunkRequest=new u.Delta,this._dequeuedReceivedChunkRequest=new u.Delta,this._sentSafeChunkRequest=new u.Delta,this._sentUnsafeChunkRequest=new u.Delta,this._timeoutSentSafeChunkRequest=new u.Delta,this._timeoutSentUnsafeChunkRequest=new u.Delta,this._gracedChunk=new u.Delta,this._expiredGraceChunk=new u.Delta,this._chunkSchedulingCount=new u.Delta,this._chunkSchedulingSkipped=new u.Delta,this._openedMatch=new u.Delta,this._openedOffer=new u.Delta,this._match=new u.Delta,this._excessMatch=new u.Delta,this._unansweredOffer=new u.Delta,this._offer=new u.Delta,this._active=new u.Delta,this._transfer=new u.Delta,this._denied=new u.Delta,this._droppedSameTrack=new u.Delta,this._droppedOtherTrack=new u.Delta,this._offerTimeout=new u.Delta,this._answerTimeout=new u.Delta,this._timeoutNewConnection=new u.Delta,this._timeoutCheckingConnection=new u.Delta,this._timeoutFailedConnection=new u.Delta,this._timeoutNewIce=new u.Delta,this._timeoutGatheringIce=new u.Delta,this._timeoutCompleteIce=new u.Delta,this._disconnected=new u.Delta,this._lateMessage=new u.Delta,this._timeoutLocalSdp=new u.Delta,this._timeoutRemoteSdp=new u.Delta,this._timeoutLocalSdpWithStun=new u.Delta,this._timeoutRemoteSdpWithStun=new u.Delta,this._timeSpentOnEdge=new u.Delta,this._timeSpentStatic=new u.Delta,this._timeSpentLow=new u.Delta,this._timeSpentHigh=new u.Delta,this._bufferedAmount=new u.Delta,this._bufferRefill=new u.Delta,this._abortFragmentCount=new u.Delta,this._playbackErrorCount=new u.Delta,this._emergencyTrackSwitchCount=new u.Delta,this._videoUpTrackSwitchCount=new u.Delta,this._videoDownTrackSwitchCount=new u.Delta,this._feebackCount=new u.Delta,this._lastPayloadTimestamps={},this._peerPoolHighEventCount=new u.Delta,this._peerCountPerPeerPoolHighEvent=new u.Delta,this._peerLimitPerPeerPoolHighEvent=new u.Delta,this._trackerConnectionAttempts=new u.Delta,this._trackerErrors=new u.Delta,this._signalingConnectionAttempts=new u.Delta,this._signalingDisconnections=new u.Delta,this._signalingErrors=new u.Delta}return(0,a.default)(e,[{key:"dispose",value:function(){this._peerPoolObserver.dispose()}},{key:"calculatePayload",value:function(){var e=this._sharedState,t=e.conf,n=e.mediaStats,r=e.moduleState,a=e.status,i=this._sharedState.peerAgentConfig.versions,o=this._playbackErrorCount.calcDelta(n.playbackErrorCount),u=this._abortFragmentCount.calcDelta(n.abortFragmentCount),s={transfers:this._calculateTransferStats(),efficiency:this._calculateEfficiencyStats(),peers:this._calculatePeerStats(),buffer:this._calculateBufferStats(),abr:this._calculateAbrStats(),resource:this._calculateResourceStats(),qos:this._calculateQoSStats(),backend:this._calculateBackendStats(),options:{p2pDownloadAlwaysOn:this._optionsObserver.p2pDownloadAlwaysOn,p2pUploadAlwaysOn:this._optionsObserver.p2pUploadAlwaysOn},live:r.isLive(),sessionDuration:this._getSessionDuration(),timespan:this._getTimespanSinceLastPayload(),confLabel:t.CONF_LABEL,rampUpActivated:!0,qosTester:!1,mediaEngine:i.mediaEngineTag,integrationTag:"w"+i.wrapperVersion+"-s"+i.streamrooterVersion,siteId:this._sharedState.peerAgentConfig.siteId||void 0,signalingServerConnected:a.getConnectedToSignalingServer(),trackerConnected:a.getConnected(),trackerVersion:a.getTrackerVersion(),trackerId:a.getTrackerId(),isAlwaysDvr:r.isAlwaysDvr&&r.isLive(),videoTrackCount:n.videoTrackCount,minBitrate:n.minBitrate,maxBitrate:n.maxBitrate,aggPlaybackErrorCount:n.playbackErrorCount,mediaElementSet:n.mediaElementSet,mediaElementChanged:n.mediaElementChanged,mediaDuration:Math.round(n.duration),playbackErrorCount:o,abortFragmentCount:u};return this._sharedState.lastStatPayloadTimestamp=Date.now(),this._updateLastPayloadTimestamp(),this._optionsObserver.reset(),r.resetIsAlwaysDvr(),s}},{key:"_calculateTransferStats",value:function(){var e=this._sharedState.transferStats,t={PP:e.multipleDlPP,PC:e.multipleDlPC,CP:e.multipleDlCP,CC:e.multipleDlCC,HP:e.multipleDlHP,HD:e.multipleDlHD,M:e.multipleDlM},n=t.PP+t.PC+t.CP+t.CC+t.HP+t.HD+t.M,r=this._cdnDownloaded.calcDelta(e.cdnDownloaded),a=r,i=this._p2pUseful.calcDelta(e.p2pUseful),o=this._p2pConsumed.calcDelta(e.p2pConsumed),u=this._cdnConsumed.calcDelta(e.cdnConsumed),s=this._p2pMediaDownloaded.calcDelta(e.p2pMediaDownloaded),l=this._p2pHeadersDownloaded.calcDelta(e.p2pHeadersDownloaded),c=this._p2pMessagesDownloaded.calcDelta(e.p2pMessagesDownloaded),f=this._p2pMessagesCount.calcDelta(e.p2pMessagesCount),d=this._p2pUploaded.calcDelta(e.p2pUploaded),h=this._cdnRequestCount.calcDelta(e.cdnRequestCount),_=this._cdnErrorCount.calcDelta(e.cdnErrorCount);return{p2pMediaDownloaded:s,p2pHeadersDownloaded:l,p2pMessagesDownloaded:c,p2pMessagesCount:f,cdnDownloaded:r,p2pUseful:i,cdnUseful:a,p2pConsumed:o,cdnConsumed:u,p2pUploaded:d,cdnRequestCount:h,cdnTooSmallCount:this._cdnTooSmallCount.calcDelta(e.cdnTooSmallCount),cdnErrorCount:_,multipleDl:{PP:this._PP.calcDelta(t.PP),PC:this._PC.calcDelta(t.PC),CP:this._CP.calcDelta(t.CP),CC:this._CC.calcDelta(t.CC),HP:this._HP.calcDelta(t.HP),HD:this._HD.calcDelta(t.HD),M:this._M.calcDelta(t.M),total:this._total.calcDelta(n)}}}},{key:"_calculateEfficiencyStats",value:function(){var e=this._sharedState,t=e.conf,n=e.efficiencyStats,r=this._getTimespanSinceLastPayload(),a=t.CHUNK_SIZE,i=this._receivedChunkRequest.calcDelta(n.receivedChunkRequestCount),o=this._dequeuedReceivedChunkRequest.calcDelta(n.dequeuedReceivedChunkRequestCount),u=this._missedDequeuedChunkRequest.calcDelta(n.missedDequeuedChunkRequestCount),l=this._sentSafeChunkRequest.calcDelta(n.safeChunkRequestCount),c=this._sentUnsafeChunkRequest.calcDelta(n.unsafeChunkRequestCount),f=this._timeoutSentSafeChunkRequest.calcDelta(n.safeChunkRequestTimeoutCount),d=this._timeoutSentUnsafeChunkRequest.calcDelta(n.unsafeChunkRequestTimeoutCount),h=r>0?Math.round(i*a*8/r):0,_=r>0?Math.round((l+c)*a*8/r):0,p=this._gracedChunk.calcDelta(n.gracedChunksCount),v=this._expiredGraceChunk.calcDelta(n.expiredGraceChunksCount),E=this._chunkSchedulingCount.calcDelta(n.chunkSchedulingCount),g=this._chunkSchedulingSkipped.calcDelta(n.chunkSchedulingSkipped);return{receivedChunkRequests:i,receivedChunkRequestBitrate:h,sentChunkRequestBitrate:_,receivedChunkRequestsMissedRatio:o>0?(0,s.toDecimal)(u/o,2):0,sentSafeChunkRequests:l,sentUnsafeChunkRequests:c,sentSafeChunkRequestsTimeout:f,sentUnsafeChunkRequestsTimeout:d,dequeuedChunkRequests:o,uploadQueueExpirationRatio:i>0?(0,s.toDecimal)(1-o/i,2):0,gracedChunks:p,expiredGraceChunks:v,chunkSchedulingCount:E,chunkSchedulingSkipped:g}}},{key:"_calculatePeerStats",value:function(){var e=this._sharedState.peerStats,t=this._peerPoolObserver.getAveragePeerCount(),n=this._peerPoolObserver.getAveragePeerPoolLimit(),r=this._peerPoolObserver.getSameTrackPeerCount(),a=this._match.calcDelta(e.match),i=this._excessMatch.calcDelta(e.excessMatch),o=this._openedMatch.calcDelta(e.openedMatch),u=this._openedOffer.calcDelta(e.openedOffer),s=this._unansweredOffer.calcDelta(e.unansweredOffer),l=this._offer.calcDelta(e.offer),c=e.locked.getAverage(),f=e.loosers.getAverage(),d=this._active.calcDelta(e.active),h=this._transfer.calcDelta(e.transfer),_=this._denied.calcDelta(e.denied),p=this._droppedSameTrack.calcDelta(e.droppedSameTrack),v=this._droppedOtherTrack.calcDelta(e.droppedOtherTrack),E=this._offerTimeout.calcDelta(e.offerTimeout),g=this._answerTimeout.calcDelta(e.answerTimeout),m=this._timeoutNewConnection.calcDelta(e.timeoutNewConnection),S=this._timeoutCheckingConnection.calcDelta(e.timeoutCheckingConnection),y=this._timeoutFailedConnection.calcDelta(e.timeoutFailedConnection),T=this._timeoutNewIce.calcDelta(e.timeoutNewIce),A=this._timeoutGatheringIce.calcDelta(e.timeoutGatheringIce),C=this._timeoutCompleteIce.calcDelta(e.timeoutCompleteIce),D=this._disconnected.calcDelta(e.disconnected),P=this._lateMessage.calcDelta(e.lateMessage),R=e.sampledPUC,w=e.peerPoolUploadCapacity.getAverage(),O=e.exclusionSize,I=Math.round(e.totalConnectionDuration),k=this._timeoutLocalSdp.calcDelta(e.timeoutLocalSdp),N=this._timeoutRemoteSdp.calcDelta(e.timeoutRemoteSdp),M=this._timeoutLocalSdpWithStun.calcDelta(e.timeoutLocalSdpWithStun),b=this._timeoutRemoteSdpWithStun.calcDelta(e.timeoutRemoteSdpWithStun),L=e.sampledP2pMeanRtt,U=e.sampledResponseTime,x=e.sampledResponseDurationPerChunk,F=e.sampledLastChunkDelayFromTimeout,B=e.sampledPeerStats,H=B?Math.round(B.connectionDuration):0,G=B?Math.round(B.sameTrackTime):0,j=e.sampledDataChannelBufferEmptyingStats;return{count:t,limit:n,sameTrackCount:r,match:a,excessMatch:i,openedMatch:o,openedOffer:u,unansweredOffer:s,offer:l,locked:c,loosers:f,active:d,transfer:h,denied:_,droppedSameTrack:p,droppedOtherTrack:v,offerTimeout:E,answerTimeout:g,timeoutNewConnection:m,timeoutCheckingConnection:S,timeoutFailedConnection:y,timeoutNewIce:T,timeoutGatheringIce:A,timeoutCompleteIce:C,disconnected:D,lateMessage:P,sampledPUC:R,peerPoolUploadCapacity:w,exclusionSize:O,sampledConnectionDuration:H,sampledTimeSpentOnSameTrack:G,totalConnectionDuration:I,dataChannelBufferEmptyingTime:j?j.time:0,dataChannelBufferEmptyingAmount:j?j.amount:0,timeoutLocalSdp:k,timeoutRemoteSdp:N,timeoutLocalSdpWithStun:M,timeoutRemoteSdpWithStun:b,sampledP2pMeanRtt:L,sampledResponseTime:U,sampledResponseDurationPerChunk:x,sampledLastChunkDelayFromTimeout:F}}},{key:"_calculateBufferStats",value:function(){var e=this._sharedState,t=e.bufferStats,n=e.moduleState,r=t.bufferState,a=t.alwaysDynamicBuffer,i=n.currentBufferTarget,o=this._sharedState.superSeederMode,u=(0,s.toDecimal)(t.timeSpentOnEdgeRatio,2),l=(0,s.toDecimal)(t.timeSpentTopSeederRatio,2),c=t.timeSpentDynamicIntegral,f=c.intervalLength?(0,s.toDecimal)(c.value/c.intervalLength,2):(0,s.toDecimal)(c.value,2),d=(0,s.toDecimal)(1e3*this._bufferRefill.calcDelta(t.bufferRefill)/(c.value+t.bufferedAmount),2)||0,h=(0,s.toDecimal)(t.lowerBufferTargetNetChangePerRebound,2),_=t.sampledHighLowBufferTargetGap;return{bufferState:r,currentBufferTarget:i,superSeederMode:o,alwaysDynamicBuffer:a,timeSpentOnEdgeRatio:u,timeSpentDynamicRatio:f,timeSpentTopSeederRatio:l,bufferRefillRatio:d,lowerBufferTargetNetChangePerRebound:h,timeLowerTargetAboveLiveEdgeRatio:(0,s.toDecimal)(t.timeLowerTargetAboveLiveEdge,2),sampledHighLowBufferTargetGap:_}}},{key:"_calculateAbrStats",value:function(){var e=this._sharedState.abrStats,t=e.p2pUsefulEstimate,n=this._concurrentP2pDownloaded.calcDelta(e.concurrentP2pDownloaded),r=this._concurrentP2pDownloadCount.calcDelta(e.concurrentP2pDownloadCount),a=this._cdnEstimationCount.calcDelta(e.cdnEstimationCount),i=e.bandwidthEstimateCV,o=this._feebackCount.calcDelta(e.feebackCount);return e.flushBandwidthEstimates(),{p2pUsefulEstimate:t,concurrentP2pDownloaded:n,concurrentP2pDownloadCount:r,cdnEstimationCount:a,bandwidthEstimateCV:i,feebackCount:o}}},{key:"_calculateResourceStats",value:function(){var e=this._sharedState.resourceStats;return{sampledPeerPoolHighEventInterval:e.sampledPeerPoolHighEventInterval,peerPoolHighEventCount:this._peerPoolHighEventCount.calcDelta(e.peerPoolHighEventCount),peerCountPerPeerPoolHighEvent:this._peerCountPerPeerPoolHighEvent.calcDelta(e.peerCountPerPeerPoolHighEvent),peerLimitPerPeerPoolHighEvent:this._peerLimitPerPeerPoolHighEvent.calcDelta(e.peerLimitPerPeerPoolHighEvent)}}},{key:"_calculateBackendStats",value:function(){var e=this._sharedState.backendStats;return{trackerConnectionAttempts:this._trackerConnectionAttempts.calcDelta(e.trackerConnectionAttempts),trackerErrors:this._trackerErrors.calcDelta(e.trackerErrors),signalingConnectionAttempts:this._signalingConnectionAttempts.calcDelta(e.signalingConnectionAttempts),signalingDisconnections:this._signalingDisconnections.calcDelta(e.signalingDisconnections),signalingErrors:this._signalingErrors.calcDelta(e.signalingErrors)}}},{key:"_calculateQoSStats",value:function(){var e=this._sharedState.mediaStats,t=this._getTimespanSinceLastPayload();return{emergencyTrackSwitchCPM:this._emergencyTrackSwitchCount.calcDelta(e.emergencyTrackSwitchCount)/(t/6e4),videoUpTrackSwitchCPM:this._videoUpTrackSwitchCount.calcDelta(e.videoUpTrackSwitchCount)/(t/6e4),videoDownTrackSwitchCPM:this._videoDownTrackSwitchCount.calcDelta(e.videoDownTrackSwitchCount)/(t/6e4)}}},{key:"_getSessionDuration",value:function(){return Date.now()-this._sessionStartTime}},{key:"_getTimespanSinceLastPayload",value:function(){return Date.now()-this._lastPayloadTimestamp}},{key:"_updateLastPayloadTimestamp",value:function(){this._lastPayloadTimestamp=Date.now()}}]),e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(3));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,r.default)(this,e),this._sharedState=t,this._init()}return(0,a.default)(e,[{key:"_init",value:function(){var e=this;this.reset(),this._sharedState.eventBus.on(i.default.DnaTransferStatus.P2P_UPLOAD_TOGGLED,function(t){t||(e._p2pUploadAlwaysOn=!1)}),this._sharedState.eventBus.on(i.default.DnaTransferStatus.P2P_DOWNLOAD_TOGGLED,function(t){t||(e._p2pDownloadAlwaysOn=!1)})}},{key:"reset",value:function(){this._p2pDownloadAlwaysOn=this._sharedState.dnaTransferStatus.effectiveDownloadAllowed,this._p2pUploadAlwaysOn=this._sharedState.dnaTransferStatus.effectiveUploadAllowed}},{key:"p2pDownloadAlwaysOn",get:function(){return this._p2pDownloadAlwaysOn}},{key:"p2pUploadAlwaysOn",get:function(){return this._p2pUploadAlwaysOn}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(131)),o=n(56),u=s(n(3));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){var n=this;(0,r.default)(this,e),this._peerCountStaircaseFunctionIntegral=new i.default,this._peerPoolLimitStaircaseFunctionIntegral=new i.default,this._sameTrackPeerCountStaircaseFunctionIntegral=new i.default,this._onProcessPeerPoolStats=function(e){var t=e.peerCount,r=e.sameTrackPeerCount;n._peerCountStaircaseFunctionIntegral.updateMetric(t),n._sameTrackPeerCountStaircaseFunctionIntegral.updateMetric(r)},this._onTrackPeerPoolLimit=function(){n._peerPoolLimitStaircaseFunctionIntegral.updateMetric(n._sharedState.conf.PEER_POOL_LIMIT)},this._sharedState=t,this._sharedState.eventBus.on(u.default.PeerPool.PEER_STATS_UPDATE,this._onProcessPeerPoolStats),this._sharedState.eventBus.on(u.default.PeerPool.PEER_LIMIT_UPDATE,this._onTrackPeerPoolLimit),this._onTrackPeerPoolLimit()}return(0,a.default)(e,[{key:"dispose",value:function(){this._sharedState.eventBus.removeListener(u.default.PeerPool.PEER_STATS_UPDATE,this._onProcessPeerPoolStats),this._sharedState.eventBus.removeListener(u.default.PeerPool.PEER_LIMIT_UPDATE,this._onTrackPeerPoolLimit)}},{key:"getAveragePeerCount",value:function(){return(0,o.toDecimal)(this._peerCountStaircaseFunctionIntegral.getAverage(),2)}},{key:"getAveragePeerPoolLimit",value:function(){return(0,o.toDecimal)(this._peerPoolLimitStaircaseFunctionIntegral.getAverage(),2)}},{key:"getSameTrackPeerCount",value:function(){return(0,o.toDecimal)(this._sameTrackPeerCountStaircaseFunctionIntegral.getAverage(),2)}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=n(38);function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,r.default)(this,e),this._sharedState=t,this._sessionStartTime=Date.now(),this._lastPayloadTimestamp=Date.now(),this._iceCandidates=new i.Delta,this._iceCandidatesIpv6=new i.Delta,this._p2pSgtCheckSuccess=new i.Delta,this._p2pSgtCheckFail=new i.Delta,this._hybridSgtCheckSuccess=new i.Delta,this._hybridSgtCheckFail=new i.Delta,this._checkHeartbeatFailed=new i.Delta,this._getSegmentSuccess=new i.Delta,this._getSegmentFallback=new i.Delta,this._mismatchedSegmentPCCount=new i.Delta,this._totalSegmentPCCount=new i.Delta,this._addSegmentInfoCount=new i.Delta,this._mismatchedSegmentInfoCount=new i.Delta,this._signalingRequestsCount=new i.Delta,this._signalingRequestsVolume=new i.Delta,this._trackerRequestsCount=new i.Delta,this._trackerRequestsVolume=new i.Delta,this._trackerResponsesVolume=new i.Delta,this._usagePayloadsCount=new i.Delta,this._usagePayloadsVolume=new i.Delta,this._researchPayloadsVolume=new i.Delta}return(0,a.default)(e,[{key:"dispose",value:function(){}},{key:"calculatePayload",value:function(){var e=this._sharedState,t=e.conf,n=e.controlStats,r=e.moduleState,a=this._sharedState.peerAgentConfig.versions,i=n.sampledIceGatheringDuration,o=this._iceCandidates.calcDelta(n.iceCandidates),u=this._iceCandidatesIpv6.calcDelta(n.iceCandidatesIpv6),s=this._p2pSgtCheckSuccess.calcDelta(n.nbRightHashP2P),l=this._p2pSgtCheckFail.calcDelta(n.nbWrongHashP2P),c=this._hybridSgtCheckSuccess.calcDelta(n.nbRightHashDLM),f=this._hybridSgtCheckFail.calcDelta(n.nbWrongHashDLM),d=this._checkHeartbeatFailed.calcDelta(n.checkHeartbeatFailed),h=this._getSegmentSuccess.calcDelta(n.getSegmentSuccess),_=this._getSegmentFallback.calcDelta(n.getSegmentFallback),p=this._mismatchedSegmentPCCount.calcDelta(n.mismatchedSegmentPCCount),v=this._totalSegmentPCCount.calcDelta(n.totalSegmentPCCount),E=this._addSegmentInfoCount.calcDelta(n.addSegmentInfoCount),g=this._mismatchedSegmentInfoCount.calcDelta(n.mismatchedSegmentInfoCount),m={cost:this._calculateCostStats(),live:r.isLive(),sessionDuration:this._getSessionDuration(),timespan:this._getTimespanSinceLastPayload(),confLabel:t.CONF_LABEL,qosTester:!1,mediaEngine:a.mediaEngineTag,integrationTag:"w"+a.wrapperVersion+"-s"+a.streamrooterVersion,rangeRequestStatus:r.rangeRequestStatus.status,sampledIceGatheringDuration:i,iceCandidates:o,iceCandidatesIpv6:u,p2pSgtCheckSuccess:s,p2pSgtCheckFail:l,hybridSgtCheckSuccess:c,hybridSgtCheckFail:f,checkHeartbeatFailed:d,getSegmentSuccess:h,getSegmentFallback:_,mismatchedSegmentPCCount:p,totalSegmentPCCount:v,addSegmentInfoCount:E,mismatchedSegmentInfoCount:g};return this._updateLastPayloadTimestamp(),m}},{key:"_calculateCostStats",value:function(){var e=this._sharedState.costStats;return{signalingRequestsCount:this._signalingRequestsCount.calcDelta(e.signalingRequestsCount),signalingRequestsVolume:this._signalingRequestsVolume.calcDelta(e.signalingRequestsVolume),trackerRequestsCount:this._trackerRequestsCount.calcDelta(e.trackerRequestsCount),trackerRequestsVolume:this._trackerRequestsVolume.calcDelta(e.trackerRequestsVolume),trackerResponsesVolume:this._trackerResponsesVolume.calcDelta(e.trackerResponsesVolume)}}},{key:"_getSessionDuration",value:function(){return Date.now()-this._sessionStartTime}},{key:"_getTimespanSinceLastPayload",value:function(){return Date.now()-this._lastPayloadTimestamp}},{key:"_updateLastPayloadTimestamp",value:function(){this._lastPayloadTimestamp=Date.now()}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(1)),a=i(n(2));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(t){(0,r.default)(this,e),this._sharedState=t}return(0,a.default)(e,[{key:"dispose",value:function(){}},{key:"calculatePayload",value:function(){var e=this._sharedState.conf,t=this._sharedState.peerAgentConfig.propertyParameters.localNetworkOnly,n=t?"":e.STUNSERVERS.join(",");return{p2pProtocolVersion:e.P2P_PROTOCOL_VERSION,localNetworkOnly:t,stunUrls:n}}}]),e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(708));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,r.default)(this,e),this._sharedState=t,this._peerPool=null,this._connectionSampler=null}return(0,a.default)(e,[{key:"attachPeerPool",value:function(e){this._peerPool=e,this._connectionSampler=new i.default(this._sharedState,e)}},{key:"detachPeerPool",value:function(){this._peerPool=null,this._connectionSampler=null}},{key:"calculatePayload",value:function(){var e=this._sharedState,t=e.conf,n=e.moduleState,r=e.status,a=e.uaHelper;return{live:n.isLive(),siteId:this._sharedState.peerAgentConfig.siteId||void 0,trackerId:r.getTrackerId(),confLabel:t.CONF_LABEL,property:t.PROPERTY,localUaName:a.getJavaScriptEngine().name,localUaOs:a.getOperatingSystem().name,peerCount:this._peerPool?this._peerPool.getPeerCount():0,connections:this._connectionSampler?this._connectionSampler.calculatePayloads():[]}}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(48)),a=c(n(20)),i=c(n(1)),o=c(n(2)),u=c(n(3)),s=c(n(709)),l=c(n(187));function c(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t,n){(0,i.default)(this,e),this._firstCall=!0,this._sharedState=t,this._peerPool=n,this._elected=new a.default,this._lastPayloads=[]}return(0,o.default)(e,[{key:"calculatePayloads",value:function(){this._firstCall&&(this._updateElected(),this._firstCall=!1);var e=(0,r.default)(this._elected.values()).map(function(e){return e.calculatePayload()});return e=e.concat(this._lastPayloads),this._lastPayloads=[],this._updateElected(),e}},{key:"_updateElected",value:function(){for(var e=this,t=this._peerPool.getPeerArray();this._elected.size<this._sharedState.conf.PEER_CONNECTIONS_MAX_SAMPLE_SIZE&&this._elected.size<t.length;){var n=t.map(function(e){return e.getConnection()}).filter(function(t){return!e._elected.has(t)});if(0===n.length)break;var r=n[Math.floor(Math.random()*n.length)];this._elect(r)}}},{key:"_elect",value:function(e){var t=this,n=e.stats,r=new s.default(n);e.once(u.default.PeerConnection.DISCONNECTED,function(){n.state!==l.default.CLOSED&&(n.state=l.default.SHUT);var a=r.calculatePayload();t._lastPayloads.push(a),t._elected.delete(e)}),this._elected.set(e,r)}}]),e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(1)),a=s(n(2)),i=s(n(130)),o=n(38),u=n(56);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,r.default)(this,e),this._firstPayload=!0,this._dataUploaded=new o.Delta,this._dataDownloaded=new o.Delta,this._sentChunkRequestCount=new o.Delta,this._receivedChunkRequestCount=new o.Delta,this._sentChunkRequestAnsweredCount=new o.Delta,this._receivedChunkRequestAnsweredCount=new o.Delta,this._timeSpentOnSameTrack=new o.Delta,this._stats=t,this._lastPayloadTimestamp=t.establishmentTimestamp,this._tokenId=i.default.v4()}return(0,a.default)(e,[{key:"calculatePayload",value:function(){var e=this._tokenId,t=this._stats,n=t.state,r=t.caller,a=t.remoteInfo,i=t.details,o=a.platform,s=a.property,l=a.uaName,c=a.uaOs,f=i.localCandidateType,d=i.remoteCandidateType,h=i.localAddress?i.localAddress.substring(0,i.localAddress.lastIndexOf(":")):void 0,_=i.remoteAddress?i.remoteAddress.substring(0,i.remoteAddress.lastIndexOf(":")):void 0,p=this._getTimespanSinceLastPayload(),v=this._firstPayload?this._stats.establishmentDuration:void 0,E=this._dataUploaded.calcDelta(t.dataUploaded),g=this._dataDownloaded.calcDelta(t.dataDownloaded),m=this._sentChunkRequestCount.calcDelta(t.sentChunkRequestCount),S=this._receivedChunkRequestCount.calcDelta(t.receivedChunkRequestCount),y=this._sentChunkRequestAnsweredCount.calcDelta(t.sentChunkRequestAnsweredCount),T=this._receivedChunkRequestAnsweredCount.calcDelta(t.receivedChunkRequestAnsweredCount),A=this._timeSpentOnSameTrack.calcDelta(t.timeSpentOnSameTrack),C={id:e,localAddress:h,localCandidateType:f,remoteAddress:_,remoteCandidateType:d,platform:o,property:s,uaName:l,uaOs:c,state:n,caller:r,connectionTimespan:p,establishmentDuration:v,dataUploaded:E,dataDownloaded:g,sentChunkRequestCount:m,receivedChunkRequestCount:S,sentChunkRequestAnsweredCount:y,receivedChunkRequestAnsweredCount:T,rtt:(0,u.toDecimal)(t.getAverageRtt(),2),uploadCapacity:(0,u.toDecimal)(t.getAverageUploadCapacity(),2),timeSpentOnSameTrack:A};return this._updateLastPayloadTimestamp(),this._firstPayload=!1,C}},{key:"_getTimespanSinceLastPayload",value:function(){return Date.now()-this._lastPayloadTimestamp}},{key:"_updateLastPayloadTimestamp",value:function(){this._lastPayloadTimestamp=Date.now()}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(1)),a=o(n(2)),i=o(n(103));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){var n=this;(0,r.default)(this,e),this._onTrackerAttempt=function(){n._sharedState.backendStats.trackerConnectionAttempts++},this._onTrackerRequest=function(e){var t=e.size;n._sharedState.costStats.trackerRequestsCount++,n._sharedState.costStats.trackerRequestsVolume+=t},this._onTrackerSuccess=function(e){var t=e.size;n._sharedState.costStats.trackerResponsesVolume+=t},this._onTrackerError=function(){n._sharedState.backendStats.trackerErrors++},this._sharedState=t;var a=this._sharedState.analyticsEventBus;a.on(i.default.TRACKER_ATTEMPT,this._onTrackerAttempt),a.on(i.default.TRACKER_REQUEST,this._onTrackerRequest),a.on(i.default.TRACKER_SUCCESS,this._onTrackerSuccess),a.on(i.default.TRACKER_ERROR,this._onTrackerError)}return(0,a.default)(e,[{key:"dispose",value:function(){var e=this._sharedState.analyticsEventBus;e.removeListener(i.default.TRACKER_ATTEMPT,this._onTrackerAttempt),e.removeListener(i.default.TRACKER_REQUEST,this._onTrackerRequest),e.removeListener(i.default.TRACKER_SUCCESS,this._onTrackerSuccess),e.removeListener(i.default.TRACKER_ERROR,this._onTrackerError)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.platform=e,this.javaScriptEngineType={name:"native",version:"3.8.0"}}return e.prototype.getOperatingSystem=function(){return this.platform},e.prototype.getPlatform=function(){return this.platform},e.prototype.getJavaScriptEngine=function(){return this.javaScriptEngineType},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.notify=function(e,t,n){ErrorInteractor.error(e+" - "+t)},e.prototype.notifyError=function(e){e instanceof Error?ErrorInteractor.error(e.name+" - "+e.message):ErrorInteractor.error(e)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getQoSAnalytics=function(){return null},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.endsWith=function(e,t){var n=t&&e?e.length-t.length:-1;return n>=0&&e.lastIndexOf(t,n)===n},t.isEmpty=function(e){return!e||0===e.length}},function(e,t,n){"use strict";var r,a=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.getBufferTarget=function(){return 30},t.prototype.setBufferTarget=function(e){},t.prototype.getPlayerInfo=function(){return null},t}(n(232).EventEmitter);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(717),a=function(){function e(){}return e.prototype.create=function(e,t){this.onCreatedCallback=t;var n=JSON.stringify({buffer_level_max:e.bufferTarget,content:e.contentId,customer_id:e.customerId,is_live:e.isLive,p2p_protocol:e.p2pProtocolVersion,site_id:e.siteId,super_seeder_ratio:e.superSeederRatio,tracker_id:e.trackerId});TrackerInteractor.createConnection(n)},e.prototype.connectionCreated=function(e,t){this.onCreatedCallback?(this.trackerConnection=new r.default(e,t),this.onCreatedCallback(this.trackerConnection)):ErrorInteractor.error("Tracker ConnectionCreated has been trigger by native integration but no callback was register in Panama")},e.prototype.askPeersSuccess=function(e){this.trackerConnection?this.trackerConnection.askPeersSuccess(e):ErrorInteractor.error("Tracker AskPeersSuccess has been trigger by native integration but no TrackerConnection was register in Panama")},e.prototype.askPeerFailure=function(){this.trackerConnection?(this.trackerConnection.askPeerFailure(),this.trackerConnection=null):ErrorInteractor.error("Tracker AskPeerFailure has been trigger by native integration but no TrackerConnection was register in Panama")},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.peerId=e,this.trackerId=t}return e.prototype.askPeers=function(e,t,n){this.onPeersFailureCallback=n,this.onPeersSuccessCallback=t;var r=JSON.stringify({current_position:e.currentPosition,exclusions:e.exclusions,id:this.peerId,near_edge:e.nearEdge,peer_number:e.number,super_seeder_ratio:e.superSeederRatio,tracks:e.tracks});TrackerInteractor.askPeer(r)},e.prototype.getPeerId=function(){return this.peerId},e.prototype.getTrackerId=function(){return this.trackerId},e.prototype.close=function(){TrackerInteractor.closeConnection('{id="'+this.peerId+'"}')},e.prototype.askPeersSuccess=function(e){this.onPeersSuccessCallback?this.onPeersSuccessCallback({becomeSuperSeeder:e.become_super_seeder,peers:e.peers}):ErrorInteractor.error("AskPeersSuccess has been trigger by native integration on TrackerConnection but no callback was register in Panama")},e.prototype.askPeerFailure=function(){this.onPeersFailureCallback?this.onPeersFailureCallback():ErrorInteractor.error("AskPeersFailure has been trigger by native integration on TrackerConnection but no callback was register in Panama")},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(133),a=n(132);t.onHashCheck=function(e,t,n){var i=a.default.get("hash_worker_callback",e);i&&(i(new r.default(t,e),n),a.default.remove("hash_worker_callback",e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(271);t.onBinaryResponse=function(e,t,n,a){r.default.dataResponse(e,t,n,a)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(721),a=n(77),i=n(252),o=n(180);t.create=function(e){var t=JSON.parse(e);i.default.newBuilder(t.platform,t.platformVersion,t.streamrootKey,r.parse(t.manifestUrl)).setContentId(t.contentId).setStreamType(o.StreamType[t.streamType]).setBackendUrls(t.backendUrls).setPropertyParameters(t.propertyParameters).setPaConfig(t.paConfig).setSiteId(t.siteId).setNetworkType(parseInt(t.networkType,10)).setPeerAgentCounter(t.peerAgentCounter?t.peerAgentCounter:1).build()},t.updateNetworkType=function(e){a.default.getInstance().networkType=e},t.enableDnaUpload=function(){a.default.getInstance().dnaUploadAllowed=!0},t.disableDnaUpload=function(){a.default.getInstance().dnaUploadAllowed=!1},t.enableDnaDownload=function(){a.default.getInstance().dnaDownloadAllowed=!0},t.disableDnaDownload=function(){a.default.getInstance().dnaDownloadAllowed=!1},t.resetDnaDownloadOnWifiEthernet=function(){a.default.getInstance().resetDnaDownloadOnWifiEthernetAllowed()},t.enableDnaDownloadOnWifiEthernet=function(){a.default.getInstance().dnaDownloadOnWifiEthernetAllowed=!0},t.disableDnaDownloadOnWifiEthernet=function(){a.default.getInstance().dnaDownloadOnWifiEthernetAllowed=!1},t.resetDnaUploadOnWifiEthernet=function(){a.default.getInstance().resetDnaUploadOnWifiEthernetAllowed()},t.enableDnaUploadOnWifiEthernet=function(){a.default.getInstance().dnaUploadOnWifiEthernetAllowed=!0},t.disableDnaUploadOnWifiEthernet=function(){a.default.getInstance().dnaUploadOnWifiEthernetAllowed=!1},t.resetDnaDownloadOnCellular=function(){a.default.getInstance().resetDnaUploadOnCellularAllowed()},t.enableDnaDownloadOnCellular=function(){a.default.getInstance().dnaDownloadOnCellularAllowed=!0},t.disableDnaDownloadOnCellular=function(){a.default.getInstance().dnaDownloadOnCellularAllowed=!1},t.resetDnaUploadOnCellular=function(){a.default.getInstance().resetDnaUploadOnCellularAllowed()},t.enableDnaUploadOnCellular=function(){a.default.getInstance().dnaUploadOnCellularAllowed=!0},t.disableDnaUploadOnCellular=function(){a.default.getInstance().dnaUploadOnCellularAllowed=!1},t.peerPoolHigh=function(){a.default.getInstance().peerPoolHigh()}},function(e,t,n){"use strict";var r=n(722),a=n(723);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=m,t.resolve=function(e,t){return m(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?m(e,!1,!0).resolveObject(t):t},t.format=function(e){a.isString(e)&&(e=m(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var o=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(l),f=["%","/","?",";","#"].concat(c),d=["/","?","#"],h=/^[+a-z0-9A-Z_-]{0,63}$/,_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},E={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=n(724);function m(e,t,n){if(e&&a.isObject(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,n),r}i.prototype.parse=function(e,t,n){if(!a.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),u=-1!==i&&i<e.indexOf("#")?"?":"#",l=e.split(u);l[0]=l[0].replace(/\\/g,"/");var m=e=l.join(u);if(m=m.trim(),!n&&1===e.split("#").length){var S=s.exec(m);if(S)return this.path=m,this.href=m,this.pathname=S[1],S[2]?(this.search=S[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var y=o.exec(m);if(y){var T=(y=y[0]).toLowerCase();this.protocol=T,m=m.substr(y.length)}if(n||y||m.match(/^\/\/[^@\/]+@[^@\/]+/)){var A="//"===m.substr(0,2);!A||y&&v[y]||(m=m.substr(2),this.slashes=!0)}if(!v[y]&&(A||y&&!E[y])){for(var C,D,P=-1,R=0;R<d.length;R++){-1!==(w=m.indexOf(d[R]))&&(-1===P||w<P)&&(P=w)}-1!==(D=-1===P?m.lastIndexOf("@"):m.lastIndexOf("@",P))&&(C=m.slice(0,D),m=m.slice(D+1),this.auth=decodeURIComponent(C)),P=-1;for(R=0;R<f.length;R++){var w;-1!==(w=m.indexOf(f[R]))&&(-1===P||w<P)&&(P=w)}-1===P&&(P=m.length),this.host=m.slice(0,P),m=m.slice(P),this.parseHost(),this.hostname=this.hostname||"";var O="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!O)for(var I=this.hostname.split(/\./),k=(R=0,I.length);R<k;R++){var N=I[R];if(N&&!N.match(h)){for(var M="",b=0,L=N.length;b<L;b++)N.charCodeAt(b)>127?M+="x":M+=N[b];if(!M.match(h)){var U=I.slice(0,R),x=I.slice(R+1),F=N.match(_);F&&(U.push(F[1]),x.unshift(F[2])),x.length&&(m="/"+x.join(".")+m),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),O||(this.hostname=r.toASCII(this.hostname));var B=this.port?":"+this.port:"",H=this.hostname||"";this.host=H+B,this.href+=this.host,O&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==m[0]&&(m="/"+m))}if(!p[T])for(R=0,k=c.length;R<k;R++){var G=c[R];if(-1!==m.indexOf(G)){var j=encodeURIComponent(G);j===G&&(j=escape(G)),m=m.split(G).join(j)}}var V=m.indexOf("#");-1!==V&&(this.hash=m.substr(V),m=m.slice(0,V));var q=m.indexOf("?");if(-1!==q?(this.search=m.substr(q),this.query=m.substr(q+1),t&&(this.query=g.parse(this.query)),m=m.slice(0,q)):t&&(this.search="",this.query={}),m&&(this.pathname=m),E[T]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var W=this.search||"";this.path=B+W}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&a.isObject(this.query)&&Object.keys(this.query).length&&(o=g.stringify(this.query));var u=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||E[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),u&&"?"!==u.charAt(0)&&(u="?"+u),t+i+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(u=u.replace("#","%23"))+r},i.prototype.resolve=function(e){return this.resolveObject(m(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(a.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var n=new i,r=Object.keys(this),o=0;o<r.length;o++){var u=r[o];n[u]=this[u]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),l=0;l<s.length;l++){var c=s[l];"protocol"!==c&&(n[c]=e[c])}return E[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!E[e.protocol]){for(var f=Object.keys(e),d=0;d<f.length;d++){var h=f[d];n[h]=e[h]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||v[e.protocol])n.pathname=e.pathname;else{for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==_[0]&&_.unshift(""),_.length<2&&_.unshift(""),n.pathname=_.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",g=n.search||"";n.path=p+g}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var m=n.pathname&&"/"===n.pathname.charAt(0),S=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=S||m||n.host&&e.pathname,T=y,A=n.pathname&&n.pathname.split("/")||[],C=(_=e.pathname&&e.pathname.split("/")||[],n.protocol&&!E[n.protocol]);if(C&&(n.hostname="",n.port=null,n.host&&(""===A[0]?A[0]=n.host:A.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),y=y&&(""===_[0]||""===A[0])),S)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,A=_;else if(_.length)A||(A=[]),A.pop(),A=A.concat(_),n.search=e.search,n.query=e.query;else if(!a.isNullOrUndefined(e.search)){if(C)n.hostname=n.host=A.shift(),(O=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=O.shift(),n.host=n.hostname=O.shift());return n.search=e.search,n.query=e.query,a.isNull(n.pathname)&&a.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!A.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var D=A.slice(-1)[0],P=(n.host||e.host||A.length>1)&&("."===D||".."===D)||""===D,R=0,w=A.length;w>=0;w--)"."===(D=A[w])?A.splice(w,1):".."===D?(A.splice(w,1),R++):R&&(A.splice(w,1),R--);if(!y&&!T)for(;R--;R)A.unshift("..");!y||""===A[0]||A[0]&&"/"===A[0].charAt(0)||A.unshift(""),P&&"/"!==A.join("/").substr(-1)&&A.push("");var O,I=""===A[0]||A[0]&&"/"===A[0].charAt(0);C&&(n.hostname=n.host=I?"":A.length?A.shift():"",(O=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=O.shift(),n.host=n.hostname=O.shift()));return(y=y||n.host&&A.length)&&!I&&A.unshift(""),A.length?n.pathname=A.join("/"):(n.pathname=null,n.path=null),a.isNull(n.pathname)&&a.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var e=this.host,t=u.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,r){var a;!function(i){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r&&r;o.global!==o&&o.window!==o&&o.self;var u,s=2147483647,l=36,c=1,f=26,d=38,h=700,_=72,p=128,v="-",E=/^xn--/,g=/[^\x20-\x7E]/,m=/[\x2E\u3002\uFF0E\uFF61]/g,S={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=l-c,T=Math.floor,A=String.fromCharCode;function C(e){throw new RangeError(S[e])}function D(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function P(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+D((e=e.replace(m,".")).split("."),t).join(".")}function R(e){for(var t,n,r=[],a=0,i=e.length;a<i;)(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<i?56320==(64512&(n=e.charCodeAt(a++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),a--):r.push(t);return r}function w(e){return D(e,function(e){var t="";return e>65535&&(t+=A((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=A(e)}).join("")}function O(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function I(e,t,n){var r=0;for(e=n?T(e/h):e>>1,e+=T(e/t);e>y*f>>1;r+=l)e=T(e/y);return T(r+(y+1)*e/(e+d))}function k(e){var t,n,r,a,i,o,u,d,h,E,g,m=[],S=e.length,y=0,A=p,D=_;for((n=e.lastIndexOf(v))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&C("not-basic"),m.push(e.charCodeAt(r));for(a=n>0?n+1:0;a<S;){for(i=y,o=1,u=l;a>=S&&C("invalid-input"),((d=(g=e.charCodeAt(a++))-48<10?g-22:g-65<26?g-65:g-97<26?g-97:l)>=l||d>T((s-y)/o))&&C("overflow"),y+=d*o,!(d<(h=u<=D?c:u>=D+f?f:u-D));u+=l)o>T(s/(E=l-h))&&C("overflow"),o*=E;D=I(y-i,t=m.length+1,0==i),T(y/t)>s-A&&C("overflow"),A+=T(y/t),y%=t,m.splice(y++,0,A)}return w(m)}function N(e){var t,n,r,a,i,o,u,d,h,E,g,m,S,y,D,P=[];for(m=(e=R(e)).length,t=p,n=0,i=_,o=0;o<m;++o)(g=e[o])<128&&P.push(A(g));for(r=a=P.length,a&&P.push(v);r<m;){for(u=s,o=0;o<m;++o)(g=e[o])>=t&&g<u&&(u=g);for(u-t>T((s-n)/(S=r+1))&&C("overflow"),n+=(u-t)*S,t=u,o=0;o<m;++o)if((g=e[o])<t&&++n>s&&C("overflow"),g==t){for(d=n,h=l;!(d<(E=h<=i?c:h>=i+f?f:h-i));h+=l)D=d-E,y=l-E,P.push(A(O(E+D%y,0))),d=T(D/y);P.push(A(O(d,0))),i=I(n,S,r==a),n=0,++r}++n,++t}return P.join("")}u={version:"1.4.1",ucs2:{decode:R,encode:w},decode:k,encode:N,toASCII:function(e){return P(e,function(e){return g.test(e)?"xn--"+N(e):e})},toUnicode:function(e){return P(e,function(e){return E.test(e)?k(e.slice(4).toLowerCase()):e})}},void 0===(a=function(){return u}.call(t,n,t,e))||(e.exports=a)}()}).call(this,n(164)(e),n(104))},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(725),t.encode=t.stringify=n(726)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var u=/\+/g;e=e.split(t);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var l=e.length;s>0&&l>s&&(l=s);for(var c=0;c<l;++c){var f,d,h,_,p=e[c].replace(u,"%20"),v=p.indexOf(n);v>=0?(f=p.substr(0,v),d=p.substr(v+1)):(f=p,d=""),h=decodeURIComponent(f),_=decodeURIComponent(d),r(o,h)?a(o[h])?o[h].push(_):o[h]=[o[h],_]:o[h]=_}return o};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,u){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(o(e),function(o){var u=encodeURIComponent(r(o))+n;return a(e[o])?i(e[o],function(e){return u+encodeURIComponent(r(e))}).join(t):u+encodeURIComponent(r(e[o]))}).join(t):u?encodeURIComponent(r(u))+n+encodeURIComponent(r(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(262),a=n(188);t.onBufferAmountLow=function(e){r.default.onBufferedAmountLow(e)},t.onReceiveMessage=function(e,t){r.default.receivedMessage(e,t)},t.onReceiveBinary=function(e,t,n,a,i,o){r.default.receivedData(e,t,n,a,i,o)},t.onDisconnect=function(e){r.default.onDisconnect(e)},t.onOffer=function(e){return a.default.peerConnectionOffered(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77);t.get=function(e,t,n){r.default.getInstance().getSegment(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(188);t.onConnect=function(){r.default.connectedToSignalingServer()},t.onDisconnect=function(){r.default.disconnectedFromSignalingServer()},t.onComplete=function(e,t,n){r.default.peerConnectionCallback(e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(77);t.updateMediaElement=function(e,t){r.default.getInstance().updateMediaElement(e,t)},t.updatePlaylistManifest=function(e,t){r.default.getInstance().updatePlaylistManifest(e,t)},t.updateMainManifest=function(e,t){r.default.getInstance().updateMainManifest(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(103),a=n(77);t.trackerConnectionCreated=function(e){var t=JSON.parse(e);a.default.getInstance().trackerConnectionCreated(t.peer_id,t.tracker_id),a.default.getInstance().sendAnalytics(r.default.TRACKER_SUCCESS,{size:e.length})},t.trackerAskPeerResponse=function(e){a.default.getInstance().trackerAskPeersSuccess(JSON.parse(e)),a.default.getInstance().sendAnalytics(r.default.TRACKER_SUCCESS,{size:e.length})},t.trackerAskPeerFailure=function(){a.default.getInstance().trackerAskPeerFailure()},t.trackerConnectionAttempt=function(e){a.default.getInstance().sendAnalytics(r.default.TRACKER_ATTEMPT,{}),a.default.getInstance().sendAnalytics(r.default.TRACKER_REQUEST,{size:e})},t.trackerRequestAttempt=function(e){a.default.getInstance().sendAnalytics(r.default.TRACKER_REQUEST,{size:e})},t.trackerRequestFailure=function(){a.default.getInstance().sendAnalytics(r.default.TRACKER_ERROR,{})}},function(e,t,n){"use strict";var r,a,i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.RECOVERABLE=0]="RECOVERABLE",e[e.CRITICAL=1]="CRITICAL"}(r||(r={})),function(e){e[e.FORMAT=0]="FORMAT",e[e.MANIFEST_HANDLER=1]="MANIFEST_HANDLER",e[e.MEDIA=2]="MEDIA"}(a||(a={})),function(e){e[e.UNKNOWN_MANIFEST_FORMAT=0]="UNKNOWN_MANIFEST_FORMAT",e[e.SEGMENT_TIME_UNDEFINED=1]="SEGMENT_TIME_UNDEFINED",e[e.UPDATE_PLAYLIST_BEFORE_MAIN_MANIFEST=2]="UPDATE_PLAYLIST_BEFORE_MAIN_MANIFEST",e[e.PLAYLIST_NOT_IN_MANIFEST=3]="PLAYLIST_NOT_IN_MANIFEST"}(i||(i={}));var o=function(){function e(e,t,n){this.severity=e,this.category=t,this.code=n}return e.toSDK=function(e){ErrorInteractor.error(e.toString())},e.prototype.toString=function(){return"PanamaError\n\tSeverity:\t"+r[this.severity]+"\n\tCategory:\t"+a[this.category]+"\n\tCode:\t\t"+i[this.code]+"\n"},e.Severity=r,e.Category=a,e.Code=i,e}();t.default=o}]);